WITH cte_0 AS (SELECT t4.c3 AS c0, t4.c0 AS c1, t4.c2 AS c2 FROM t4 WHERE (t4.c1 != t4.c3) ORDER BY t4.id LIMIT 2), cte_1 AS (SELECT t0.c1 AS c0, t0.c0 AS c1, t0.id AS c2 FROM t0 WHERE ((t0.c0 <= t0.c1) AND (t0.c1 < t0.c0)) ORDER BY t0.id LIMIT 7), cte_2 AS (SELECT t3.c2 AS c0, t3.c4 AS c1, t3.c3 AS c2 FROM t3 WHERE NOT (t3.c5 IN (0, 0)) ORDER BY t3.id LIMIT 2) SELECT AVG(cte_1.c2) OVER (PARTITION BY t3.c5, t3.c6 ORDER BY cte_2.c2 DESC) AS c0, RANK() OVER (PARTITION BY cte_1.c0, cte_2.c0 ORDER BY t3.c1) AS c1 FROM cte_0 JOIN t4 ON (1 = 0) LEFT JOIN t3 ON (1 = 0) LEFT JOIN t5 ON (1 = 0) RIGHT JOIN t0 ON (1 = 0) JOIN cte_1 ON (1 = 0) JOIN cte_2 ON (1 = 0) WHERE (t4.id < cte_1.c2);
