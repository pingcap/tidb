CREATE TABLE `t0` (
  `id` bigint NOT NULL,
  `c0` date NOT NULL,
  `c1` datetime NOT NULL,
  PRIMARY KEY (`id`) /*T![clustered_index] CLUSTERED */,
  KEY `idx_c0_1` (`c0`),
  KEY `idx_id_10` (`id`),
  KEY `idx_c1_11` (`c1`),
  KEY `idx_c1_c0_12` (`c1`,`c0`),
  KEY `idx_c0_c1_32` (`c0`,`c1`),
  CONSTRAINT `fk_329` FOREIGN KEY (`id`) REFERENCES `t5` (`id`),
  CONSTRAINT `fk_334` FOREIGN KEY (`id`) REFERENCES `t3` (`id`),
  CONSTRAINT `fk_342` FOREIGN KEY (`id`) REFERENCES `t2` (`id`),
  CONSTRAINT `fk_375` FOREIGN KEY (`id`) REFERENCES `t4` (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_bin;
CREATE TABLE `t3` (
  `id` bigint NOT NULL,
  `c0` int NOT NULL,
  `c1` tinyint(1) NOT NULL,
  `c2` date DEFAULT NULL,
  `c3` timestamp NOT NULL,
  `c4` int NOT NULL,
  PRIMARY KEY (`id`) /*T![clustered_index] CLUSTERED */,
  KEY `idx_c4` (`c4`),
  KEY `idx_id_2` (`id`),
  KEY `idx_c0_4` (`c0`),
  KEY `idx_c2_5` (`c2`),
  KEY `idx_c3_9` (`c3`),
  KEY `idx_c1_12` (`c1`),
  KEY `idx_c0_c4_29` (`c0`,`c4`),
  KEY `idx_c1_c2_c4_34` (`c1`,`c2`,`c4`),
  KEY `idx_c4_c3_c1_35` (`c4`,`c3`,`c1`),
  KEY `idx_c4_c1_36` (`c4`,`c1`),
  KEY `idx_c2_c3_36` (`c2`,`c3`),
  KEY `idx_c1_c0_38` (`c1`,`c0`),
  KEY `idx_c2_c0_c1_38` (`c2`,`c0`,`c1`),
  CONSTRAINT `fk_3` FOREIGN KEY (`id`) REFERENCES `t0` (`id`),
  CONSTRAINT `fk_173` FOREIGN KEY (`id`) REFERENCES `t2` (`id`),
  CONSTRAINT `fk_192` FOREIGN KEY (`id`) REFERENCES `t4` (`id`),
  CONSTRAINT `fk_254` FOREIGN KEY (`id`) REFERENCES `t5` (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_bin;
CREATE TABLE `t4` (
  `id` bigint NOT NULL,
  `c0` timestamp NOT NULL,
  `c1` double DEFAULT NULL,
  `c2` double NOT NULL,
  `c3` tinyint(1) NOT NULL,
  `c4` varchar(64) NOT NULL,
  `c5` float NOT NULL,
  `c6` datetime NOT NULL,
  PRIMARY KEY (`id`) /*T![clustered_index] CLUSTERED */,
  KEY `idx_c3` (`c3`),
  KEY `idx_c5` (`c5`),
  KEY `idx_c6` (`c6`),
  KEY `idx_c4_c3_4` (`c4`,`c3`),
  KEY `idx_id_16` (`id`),
  KEY `idx_c1_25` (`c1`),
  KEY `idx_c2_26` (`c2`),
  KEY `idx_c4_27` (`c4`),
  KEY `idx_c0_28` (`c0`),
  KEY `idx_c2_c0_31` (`c2`,`c0`),
  KEY `idx_c1_c6_35` (`c1`,`c6`),
  KEY `idx_c2_c5_38` (`c2`,`c5`),
  KEY `idx_c3_c1_c0_39` (`c3`,`c1`,`c0`),
  KEY `idx_c6_c2_39` (`c6`,`c2`),
  CONSTRAINT `fk_118` FOREIGN KEY (`id`) REFERENCES `t2` (`id`),
  CONSTRAINT `fk_133` FOREIGN KEY (`id`) REFERENCES `t0` (`id`),
  CONSTRAINT `fk_137` FOREIGN KEY (`id`) REFERENCES `t5` (`id`),
  CONSTRAINT `fk_162` FOREIGN KEY (`id`) REFERENCES `t3` (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_bin;
CREATE TABLE `t5` (
  `id` bigint NOT NULL,
  `c0` bigint NOT NULL,
  `c1` decimal(12,2) NOT NULL,
  `c2` varchar(64) NOT NULL,
  `c3` double NOT NULL,
  PRIMARY KEY (`id`) /*T![clustered_index] CLUSTERED */,
  KEY `idx_c2` (`c2`),
  KEY `idx_id_3` (`id`),
  KEY `idx_c3_14` (`c3`),
  KEY `idx_c3_c2_23` (`c3`,`c2`),
  KEY `idx_c1_23` (`c1`),
  KEY `idx_c0_24` (`c0`),
  KEY `idx_c3_c1_31` (`c3`,`c1`),
  KEY `idx_c0_c3_c1_32` (`c0`,`c3`,`c1`),
  KEY `idx_c2_c0_c3_35` (`c2`,`c0`,`c3`),
  KEY `idx_c3_c0_38` (`c3`,`c0`),
  KEY `idx_c0_c1_38` (`c0`,`c1`),
  KEY `idx_c1_c3_38` (`c1`,`c3`),
  KEY `idx_c0_c2_c3_39` (`c0`,`c2`,`c3`),
  KEY `idx_c2_c1_c3_39` (`c2`,`c1`,`c3`),
  KEY `idx_c3_c0_c1_39` (`c3`,`c0`,`c1`),
  CONSTRAINT `fk_7` FOREIGN KEY (`id`) REFERENCES `t4` (`id`),
  CONSTRAINT `fk_23` FOREIGN KEY (`id`) REFERENCES `t2` (`id`),
  CONSTRAINT `fk_144` FOREIGN KEY (`id`) REFERENCES `t3` (`id`),
  CONSTRAINT `fk_163` FOREIGN KEY (`id`) REFERENCES `t0` (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_bin;
INSERT INTO t0 (id, c0, c1) VALUES (258, '2025-01-11', '2026-05-28 08:06:12'), (259, '2025-10-05', '2026-06-18 11:47:49'), (260, '2026-09-28', '2026-02-08 18:21:52'), (261, '2023-05-31', '2024-01-15 21:43:25'), (262, '2026-12-17', '2024-07-27 10:24:22'), (263, '2025-10-27', '2023-05-10 01:15:09'), (264, '2023-07-07', '2024-03-23 19:45:12'), (265, '2023-12-04', '2026-07-11 22:53:56'), (266, '2024-05-01', '2024-01-14 08:57:18'), (267, '2024-08-18', '2024-01-29 07:52:07'), (268, '2023-12-05', '2026-09-16 11:33:51'), (269, '2025-03-18', '2025-04-04 14:08:20'), (270, '2023-03-01', '2026-07-12 20:53:51'), (271, '2024-10-28', '2025-03-11 16:08:39'), (272, '2026-07-01', '2026-02-25 01:56:35'), (273, '2026-12-20', '2026-11-27 19:07:33'), (274, '2023-07-18', '2023-10-23 05:43:11'), (275, '2026-12-15', '2025-08-25 01:08:16'), (276, '2024-07-30', '2026-07-19 01:00:04'), (277, '2026-02-07', '2024-01-22 01:15:22'), (278, '2026-06-13', '2024-08-04 14:27:59'), (279, '2023-01-26', '2024-02-22 08:00:33'), (280, '2023-08-27', '2023-04-04 17:41:41'), (281, '2024-08-12', '2023-06-13 00:57:01'), (282, '2026-02-16', '2023-08-09 00:33:05'), (283, '2023-07-10', '2026-04-27 23:20:06'), (284, '2025-10-31', '2023-05-02 13:17:56'), (285, '2026-08-14', '2024-02-15 17:04:43'), (286, '2023-03-30', '2026-08-31 04:02:31'), (287, '2025-12-25', '2026-09-20 08:10:56'), (288, '2025-04-28', '2025-10-07 16:39:53'), (289, '2025-11-25', '2025-02-05 20:25:04'), (290, '2026-09-10', '2024-02-10 00:40:56'), (291, '2023-09-04', '2025-05-28 08:42:36'), (292, '2026-07-29', '2025-07-13 15:04:52'), (293, '2024-01-15', '2026-01-09 09:48:28'), (294, '2023-02-21', '2025-03-23 15:01:01'), (295, '2025-05-12', '2024-04-16 05:09:56'), (296, '2026-03-11', '2024-09-26 22:45:14'), (297, '2025-12-03', '2024-06-25 11:31:23'), (298, '2025-12-16', '2024-09-06 07:47:53'), (299, '2023-09-04', '2023-07-07 09:00:40'), (300, '2025-12-22', '2024-12-28 23:17:07'), (301, '2024-02-18', '2025-12-07 20:55:06'), (302, '2024-11-16', '2023-12-27 14:46:15'), (303, '2025-09-18', '2024-05-07 00:17:08'), (304, '2025-12-21', '2023-03-06 14:54:55'), (305, '2023-07-12', '2026-04-02 04:28:02'), (306, '2026-07-24', '2024-09-05 01:19:19'), (307, '2025-09-02', '2023-09-05 18:32:39'), (308, '2026-01-14', '2024-12-02 20:59:57'), (309, '2025-03-16', '2026-01-29 14:04:54'), (310, '2023-04-27', '2024-11-21 00:03:48'), (311, '2023-02-12', '2024-02-07 01:07:20'), (312, '2024-06-28', '2026-09-02 02:37:12'), (313, '2024-07-30', '2026-03-12 04:19:06'), (314, '2024-07-05', '2025-08-22 11:14:43'), (315, '2026-03-06', '2023-09-28 01:16:09'), (316, '2023-04-13', '2023-06-15 19:35:50'), (317, '2024-01-20', '2025-11-05 13:17:32'), (318, '2024-10-20', '2023-05-23 12:32:18'), (319, '2026-10-19', '2026-07-10 23:26:21'), (320, '2025-11-28', '2024-06-22 07:08:42'), (321, '2024-12-06', '2026-04-20 10:30:17'), (322, '2025-10-24', '2024-07-15 23:46:58'), (323, '2026-02-02', '2023-02-17 01:51:08'), (324, '2026-11-05', '2024-09-16 00:33:19'), (325, '2024-03-11', '2023-01-07 06:01:09'), (326, '2023-04-07', '2023-07-30 12:14:40'), (327, '2025-10-24', '2023-04-07 05:21:48'), (328, '2025-02-20', '2024-10-12 11:58:29'), (329, '2026-05-16', '2024-08-14 08:29:23'), (330, '2025-07-11', '2023-04-09 06:48:02');
WITH cte_0 AS (SELECT t4.c0 AS c0, t4.c6 AS c1, t4.c4 AS c2 FROM t4 WHERE (t4.c6 = t4.c0) ORDER BY t4.id LIMIT 10), cte_1 AS (SELECT t5.c3 AS c0, t5.c2 AS c1, t5.id AS c2 FROM t5 WHERE (t5.id > t5.c0) ORDER BY t5.id LIMIT 3) SELECT DISTINCT 22.98 AS c0, AVG(t5.c1) OVER (PARTITION BY cte_0.c0 ORDER BY cte_0.c2) AS c1 FROM cte_0 RIGHT JOIN t3 ON (1 = 0) RIGHT JOIN t4 ON (1 = 0) JOIN t5 ON (1 = 0) RIGHT JOIN t0 ON (1 = 0) JOIN cte_1 ON (1 = 0) WHERE ((t5.c2 IN ('s87', 's63', 's74')) AND EXISTS (SELECT COUNT(1) AS cnt FROM v0 WHERE ((v0.cnt != v0.sum1) OR (v0.cnt = v0.sum1)) ORDER BY COUNT(1) DESC LIMIT 5));
