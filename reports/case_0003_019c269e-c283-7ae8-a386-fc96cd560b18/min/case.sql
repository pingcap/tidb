WITH cte_0 AS (SELECT v1.c0 AS c0, v1.c2 AS c1, v1.c1 AS c2 FROM v1 WHERE ((v1.c0 <= v1.c2) AND (v1.c2 > v1.c1)) ORDER BY v1.c0 LIMIT 9) SELECT (SELECT COUNT(1) AS cnt FROM v2 WHERE (v2.c0 = v1.c0)) AS c0, ROUND(t2.d1) AS c1, SUM(t2.d0) OVER (ORDER BY t4.d0, v4.g0 DESC) AS c2 FROM t2 RIGHT JOIN t1 ON (t2.k0 = t1.k0) JOIN t0 ON (t2.k0 = t0.k0) RIGHT JOIN t4 ON (t0.k0 = t4.k0) RIGHT JOIN v1 ON (1 = 0) LEFT JOIN v4 ON (1 = 0) RIGHT JOIN cte_0 ON (1 = 0) WHERE NOT EXISTS (SELECT COUNT(1) AS cnt FROM v4 WHERE ((v4.g0 <=> v4.sum1) OR (v4.sum1 > v4.g0)) ORDER BY COUNT(1) DESC LIMIT 2) ORDER BY SUM(t2.d0) OVER (ORDER BY t4.d0, v4.g0 DESC), ROUND(t2.d1) LIMIT 16;
