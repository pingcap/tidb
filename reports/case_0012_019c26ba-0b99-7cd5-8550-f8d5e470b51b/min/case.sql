WITH cte_0 AS (SELECT t0.c0 AS c0, t0.id AS c1, t0.c1 AS c2 FROM t0 WHERE (((t0.c1 <= t0.c0) AND (t0.c0 = t0.c1)) OR ((t0.c1 < t0.c0) AND (t0.c1 = t0.id))) ORDER BY t0.id LIMIT 3), cte_1 AS (SELECT cte_0.c0 AS c0, cte_0.c1 AS c1, cte_0.c2 AS c2 FROM cte_0 WHERE (((cte_0.c0 <=> cte_0.c1) AND (cte_0.c1 != cte_0.c2)) OR ((cte_0.c1 <=> cte_0.c0) AND (cte_0.c2 >= cte_0.c1))) ORDER BY cte_0.c0 LIMIT 5) SELECT AVG(cte_0.c2) OVER (ORDER BY cte_1.c1 DESC, v4.c0) AS c0, (v4.c0 + t1.id) AS c1, (SELECT COUNT(1) AS cnt FROM v0 WHERE (v0.sum1 = t0.c0)) AS c2 FROM cte_1 RIGHT JOIN v4 ON (1 = 0) LEFT JOIN v0 ON (1 = 0) RIGHT JOIN t0 ON (1 = 0) RIGHT JOIN t1 ON (1 = 0) LEFT JOIN cte_0 ON (1 = 0) RIGHT JOIN t2 ON (1 = 0) WHERE (v4.c2 <=> v4.c1);
