SELECT AVG(v4.c0) OVER (PARTITION BY t1.id ORDER BY v2.c2, t4.id) AS c0, (SELECT COUNT(1) AS cnt FROM t4 WHERE ((t4.k0 = t4.k0) AND (t4.k0 >= t4.k0)) ORDER BY COUNT(1) DESC LIMIT 4) AS c1 FROM t4 LEFT JOIN v0 ON (1 = 0) LEFT JOIN v1 ON (1 = 0) JOIN v4 ON (1 = 0) RIGHT JOIN v2 ON (1 = 0) RIGHT JOIN t1 ON ((t4.k0 = t1.k0) AND ((v1.g1 != t1.id) AND (t4.d0 < t1.k0))) WHERE EXISTS (SELECT COUNT(1) AS cnt FROM t3 WHERE (t3.k0 = t4.k0)) ORDER BY 1, 2 DESC LIMIT 10;
