drop table if exists t;
set tidb_enable_clustered_index = 'INT_ONLY';
create table t(a char(10) primary key, b int);
explain select * from t where a > "t";
id	estRows	task	access object	operator info
TableReader_7	3333.33	root		data:Selection_6
└─Selection_6	3333.33	cop[tikv]		gt(planner__cardinality__selectivity.t.a, "t")
  └─TableFullScan_5	10000.00	cop[tikv]	table:t	keep order:false, stats:pseudo
drop table t;
create table t(a int primary key, b int);
explain select * from t where a > 1;
id	estRows	task	access object	operator info
TableReader_6	3333.33	root		data:TableRangeScan_5
└─TableRangeScan_5	3333.33	cop[tikv]	table:t	range:(1,+inf], keep order:false, stats:pseudo
set tidb_enable_clustered_index = DEFAULT;
drop table t;
set tidb_cost_model_version=2;
set tidb_analyze_version=2;
drop table if exists tint;
create table tint(a int, b int, c int, index singular(a), index multi(b, c));
insert into tint values (1, 1, 1), (2, 2, 2), (3, 3, 3), (4, 4, 4), (5, 5, 5), (6, 6, 6), (7, 7, 7), (8, 8, 8);
analyze table tint with 2 topn, 3 buckets;
drop table if exists tdouble;
create table tdouble(a double, b double, c double, index singular(a), index multi(b, c));
insert into tdouble values (1, 1, 1), (2, 2, 2), (3, 3, 3), (4, 4, 4), (5, 5, 5), (6, 6, 6), (7, 7, 7), (8, 8, 8);
analyze table tdouble with 2 topn, 3 buckets;
drop table if exists tdecimal;
create table tdecimal(a decimal(40, 20), b decimal(40, 20), c decimal(40, 20), index singular(a), index multi(b, c));
insert into tdecimal values (1, 1, 1), (2, 2, 2), (3, 3, 3), (4, 4, 4), (5, 5, 5), (6, 6, 6), (7, 7, 7), (8, 8, 8);
analyze table tdecimal with 2 topn, 3 buckets;
drop table if exists tstring;
create table tstring(a varchar(64), b varchar(64), c varchar(64), index singular(a), index multi(b, c));
insert into tstring values ('1', '1', '1'), ('2', '2', '2'), ('3', '3', '3'), ('4', '4', '4'), ('5', '5', '5'), ('6', '6', '6'), ('7', '7', '7'), ('8', '8', '8');
analyze table tstring with 2 topn, 3 buckets;
drop table if exists tdatetime;
create table tdatetime(a datetime, b datetime, c datetime, index singular(a), index multi(b, c));
insert into tdatetime values ('2001-01-01', '2001-01-01', '2001-01-01'), ('2001-01-02', '2001-01-02', '2001-01-02'), ('2001-01-03', '2001-01-03', '2001-01-03'), ('2001-01-04', '2001-01-04', '2001-01-04');
analyze table tdatetime with 2 topn, 3 buckets;
drop table if exists tprefix;
create table tprefix(a varchar(64), b varchar(64), index prefixa(a(2)));
insert into tprefix values ('111', '111'), ('222', '222'), ('333', '333'), ('444', '444'), ('555', '555'), ('666', '666');
analyze table tprefix with 2 topn, 3 buckets;
drop table if exists ct1;
create table ct1 (a int, pk varchar(10), primary key(pk) clustered);
insert into ct1 values (1, '1'), (2, '2'), (3, '3'), (4, '4'), (5, '5'), (6, '6'), (7, '7'), (8, '8');
analyze table ct1 with 2 topn, 3 buckets;
drop table if exists ct2;
create table ct2 (a int, b int, c int, primary key(a, b) clustered);
insert into ct2 values (1, 1, 1), (2, 2, 2), (3, 3, 3), (4, 4, 4), (5, 5, 5), (6, 6, 6), (7, 7, 7), (8, 8, 8);
analyze table ct2 with 2 topn, 3 buckets;
select stats_ver from mysql.stats_histograms where table_id in (select TIDB_TABLE_ID from information_schema.tables where TABLE_SCHEMA = 'planner__cardinality__selectivity');
stats_ver
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
show stats_topn where db_name = 'planner__cardinality__selectivity';
Db_name	Table_name	Partition_name	Column_name	Is_index	Value	Count
planner__cardinality__selectivity	ct1		PRIMARY	1	1	1
planner__cardinality__selectivity	ct1		PRIMARY	1	2	1
planner__cardinality__selectivity	ct1		a	0	1	1
planner__cardinality__selectivity	ct1		a	0	2	1
planner__cardinality__selectivity	ct1		pk	0	1	1
planner__cardinality__selectivity	ct1		pk	0	2	1
planner__cardinality__selectivity	ct2		PRIMARY	1	(1, 1)	1
planner__cardinality__selectivity	ct2		PRIMARY	1	(2, 2)	1
planner__cardinality__selectivity	ct2		a	0	1	1
planner__cardinality__selectivity	ct2		a	0	2	1
planner__cardinality__selectivity	ct2		b	0	1	1
planner__cardinality__selectivity	ct2		b	0	2	1
planner__cardinality__selectivity	ct2		c	0	1	1
planner__cardinality__selectivity	ct2		c	0	2	1
planner__cardinality__selectivity	tdatetime		a	0	2001-01-01 00:00:00	1
planner__cardinality__selectivity	tdatetime		a	0	2001-01-02 00:00:00	1
planner__cardinality__selectivity	tdatetime		b	0	2001-01-01 00:00:00	1
planner__cardinality__selectivity	tdatetime		b	0	2001-01-02 00:00:00	1
planner__cardinality__selectivity	tdatetime		c	0	2001-01-01 00:00:00	1
planner__cardinality__selectivity	tdatetime		c	0	2001-01-02 00:00:00	1
planner__cardinality__selectivity	tdatetime		multi	1	(2001-01-01 00:00:00, 2001-01-01 00:00:00)	1
planner__cardinality__selectivity	tdatetime		multi	1	(2001-01-02 00:00:00, 2001-01-02 00:00:00)	1
planner__cardinality__selectivity	tdatetime		singular	1	2001-01-01 00:00:00	1
planner__cardinality__selectivity	tdatetime		singular	1	2001-01-02 00:00:00	1
planner__cardinality__selectivity	tdecimal		a	0	1.00000000000000000000	1
planner__cardinality__selectivity	tdecimal		a	0	2.00000000000000000000	1
planner__cardinality__selectivity	tdecimal		b	0	1.00000000000000000000	1
planner__cardinality__selectivity	tdecimal		b	0	2.00000000000000000000	1
planner__cardinality__selectivity	tdecimal		c	0	1.00000000000000000000	1
planner__cardinality__selectivity	tdecimal		c	0	2.00000000000000000000	1
planner__cardinality__selectivity	tdecimal		multi	1	(1.00000000000000000000, 1.00000000000000000000)	1
planner__cardinality__selectivity	tdecimal		multi	1	(2.00000000000000000000, 2.00000000000000000000)	1
planner__cardinality__selectivity	tdecimal		singular	1	1.00000000000000000000	1
planner__cardinality__selectivity	tdecimal		singular	1	2.00000000000000000000	1
planner__cardinality__selectivity	tdouble		a	0	1	1
planner__cardinality__selectivity	tdouble		a	0	2	1
planner__cardinality__selectivity	tdouble		b	0	1	1
planner__cardinality__selectivity	tdouble		b	0	2	1
planner__cardinality__selectivity	tdouble		c	0	1	1
planner__cardinality__selectivity	tdouble		c	0	2	1
planner__cardinality__selectivity	tdouble		multi	1	(1, 1)	1
planner__cardinality__selectivity	tdouble		multi	1	(2, 2)	1
planner__cardinality__selectivity	tdouble		singular	1	1	1
planner__cardinality__selectivity	tdouble		singular	1	2	1
planner__cardinality__selectivity	tint		a	0	1	1
planner__cardinality__selectivity	tint		a	0	2	1
planner__cardinality__selectivity	tint		b	0	1	1
planner__cardinality__selectivity	tint		b	0	2	1
planner__cardinality__selectivity	tint		c	0	1	1
planner__cardinality__selectivity	tint		c	0	2	1
planner__cardinality__selectivity	tint		multi	1	(1, 1)	1
planner__cardinality__selectivity	tint		multi	1	(2, 2)	1
planner__cardinality__selectivity	tint		singular	1	1	1
planner__cardinality__selectivity	tint		singular	1	2	1
planner__cardinality__selectivity	tprefix		a	0	111	1
planner__cardinality__selectivity	tprefix		a	0	222	1
planner__cardinality__selectivity	tprefix		b	0	111	1
planner__cardinality__selectivity	tprefix		b	0	222	1
planner__cardinality__selectivity	tprefix		prefixa	1	11	1
planner__cardinality__selectivity	tprefix		prefixa	1	22	1
planner__cardinality__selectivity	tstring		a	0	1	1
planner__cardinality__selectivity	tstring		a	0	2	1
planner__cardinality__selectivity	tstring		b	0	1	1
planner__cardinality__selectivity	tstring		b	0	2	1
planner__cardinality__selectivity	tstring		c	0	1	1
planner__cardinality__selectivity	tstring		c	0	2	1
planner__cardinality__selectivity	tstring		multi	1	(1, 1)	1
planner__cardinality__selectivity	tstring		multi	1	(2, 2)	1
planner__cardinality__selectivity	tstring		singular	1	1	1
planner__cardinality__selectivity	tstring		singular	1	2	1
show stats_buckets where db_name = 'planner__cardinality__selectivity';
Db_name	Table_name	Partition_name	Column_name	Is_index	Bucket_id	Count	Repeats	Lower_Bound	Upper_Bound	Ndv
planner__cardinality__selectivity	ct1		PRIMARY	1	0	3	1	3	5	0
planner__cardinality__selectivity	ct1		PRIMARY	1	1	6	1	6	8	0
planner__cardinality__selectivity	ct1		a	0	0	3	1	3	5	0
planner__cardinality__selectivity	ct1		a	0	1	6	1	6	8	0
planner__cardinality__selectivity	ct1		pk	0	0	3	1	3	5	0
planner__cardinality__selectivity	ct1		pk	0	1	6	1	6	8	0
planner__cardinality__selectivity	ct2		PRIMARY	1	0	3	1	(3, 3)	(5, 5)	0
planner__cardinality__selectivity	ct2		PRIMARY	1	1	6	1	(6, 6)	(8, 8)	0
planner__cardinality__selectivity	ct2		a	0	0	3	1	3	5	0
planner__cardinality__selectivity	ct2		a	0	1	6	1	6	8	0
planner__cardinality__selectivity	ct2		b	0	0	3	1	3	5	0
planner__cardinality__selectivity	ct2		b	0	1	6	1	6	8	0
planner__cardinality__selectivity	ct2		c	0	0	3	1	3	5	0
planner__cardinality__selectivity	ct2		c	0	1	6	1	6	8	0
planner__cardinality__selectivity	tdatetime		a	0	0	1	1	2001-01-03 00:00:00	2001-01-03 00:00:00	0
planner__cardinality__selectivity	tdatetime		a	0	1	2	1	2001-01-04 00:00:00	2001-01-04 00:00:00	0
planner__cardinality__selectivity	tdatetime		b	0	0	1	1	2001-01-03 00:00:00	2001-01-03 00:00:00	0
planner__cardinality__selectivity	tdatetime		b	0	1	2	1	2001-01-04 00:00:00	2001-01-04 00:00:00	0
planner__cardinality__selectivity	tdatetime		c	0	0	1	1	2001-01-03 00:00:00	2001-01-03 00:00:00	0
planner__cardinality__selectivity	tdatetime		c	0	1	2	1	2001-01-04 00:00:00	2001-01-04 00:00:00	0
planner__cardinality__selectivity	tdatetime		multi	1	0	1	1	(2001-01-03 00:00:00, 2001-01-03 00:00:00)	(2001-01-03 00:00:00, 2001-01-03 00:00:00)	0
planner__cardinality__selectivity	tdatetime		multi	1	1	2	1	(2001-01-04 00:00:00, 2001-01-04 00:00:00)	(2001-01-04 00:00:00, 2001-01-04 00:00:00)	0
planner__cardinality__selectivity	tdatetime		singular	1	0	1	1	2001-01-03 00:00:00	2001-01-03 00:00:00	0
planner__cardinality__selectivity	tdatetime		singular	1	1	2	1	2001-01-04 00:00:00	2001-01-04 00:00:00	0
planner__cardinality__selectivity	tdecimal		a	0	0	3	1	3.00000000000000000000	5.00000000000000000000	0
planner__cardinality__selectivity	tdecimal		a	0	1	6	1	6.00000000000000000000	8.00000000000000000000	0
planner__cardinality__selectivity	tdecimal		b	0	0	3	1	3.00000000000000000000	5.00000000000000000000	0
planner__cardinality__selectivity	tdecimal		b	0	1	6	1	6.00000000000000000000	8.00000000000000000000	0
planner__cardinality__selectivity	tdecimal		c	0	0	3	1	3.00000000000000000000	5.00000000000000000000	0
planner__cardinality__selectivity	tdecimal		c	0	1	6	1	6.00000000000000000000	8.00000000000000000000	0
planner__cardinality__selectivity	tdecimal		multi	1	0	3	1	(3.00000000000000000000, 3.00000000000000000000)	(5.00000000000000000000, 5.00000000000000000000)	0
planner__cardinality__selectivity	tdecimal		multi	1	1	6	1	(6.00000000000000000000, 6.00000000000000000000)	(8.00000000000000000000, 8.00000000000000000000)	0
planner__cardinality__selectivity	tdecimal		singular	1	0	3	1	3.00000000000000000000	5.00000000000000000000	0
planner__cardinality__selectivity	tdecimal		singular	1	1	6	1	6.00000000000000000000	8.00000000000000000000	0
planner__cardinality__selectivity	tdouble		a	0	0	3	1	3	5	0
planner__cardinality__selectivity	tdouble		a	0	1	6	1	6	8	0
planner__cardinality__selectivity	tdouble		b	0	0	3	1	3	5	0
planner__cardinality__selectivity	tdouble		b	0	1	6	1	6	8	0
planner__cardinality__selectivity	tdouble		c	0	0	3	1	3	5	0
planner__cardinality__selectivity	tdouble		c	0	1	6	1	6	8	0
planner__cardinality__selectivity	tdouble		multi	1	0	3	1	(3, 3)	(5, 5)	0
planner__cardinality__selectivity	tdouble		multi	1	1	6	1	(6, 6)	(8, 8)	0
planner__cardinality__selectivity	tdouble		singular	1	0	3	1	3	5	0
planner__cardinality__selectivity	tdouble		singular	1	1	6	1	6	8	0
planner__cardinality__selectivity	tint		a	0	0	3	1	3	5	0
planner__cardinality__selectivity	tint		a	0	1	6	1	6	8	0
planner__cardinality__selectivity	tint		b	0	0	3	1	3	5	0
planner__cardinality__selectivity	tint		b	0	1	6	1	6	8	0
planner__cardinality__selectivity	tint		c	0	0	3	1	3	5	0
planner__cardinality__selectivity	tint		c	0	1	6	1	6	8	0
planner__cardinality__selectivity	tint		multi	1	0	3	1	(3, 3)	(5, 5)	0
planner__cardinality__selectivity	tint		multi	1	1	6	1	(6, 6)	(8, 8)	0
planner__cardinality__selectivity	tint		singular	1	0	3	1	3	5	0
planner__cardinality__selectivity	tint		singular	1	1	6	1	6	8	0
planner__cardinality__selectivity	tprefix		a	0	0	2	1	333	444	0
planner__cardinality__selectivity	tprefix		a	0	1	4	1	555	666	0
planner__cardinality__selectivity	tprefix		b	0	0	2	1	333	444	0
planner__cardinality__selectivity	tprefix		b	0	1	4	1	555	666	0
planner__cardinality__selectivity	tprefix		prefixa	1	0	2	1	33	44	0
planner__cardinality__selectivity	tprefix		prefixa	1	1	4	1	55	66	0
planner__cardinality__selectivity	tstring		a	0	0	3	1	3	5	0
planner__cardinality__selectivity	tstring		a	0	1	6	1	6	8	0
planner__cardinality__selectivity	tstring		b	0	0	3	1	3	5	0
planner__cardinality__selectivity	tstring		b	0	1	6	1	6	8	0
planner__cardinality__selectivity	tstring		c	0	0	3	1	3	5	0
planner__cardinality__selectivity	tstring		c	0	1	6	1	6	8	0
planner__cardinality__selectivity	tstring		multi	1	0	3	1	(3, 3)	(5, 5)	0
planner__cardinality__selectivity	tstring		multi	1	1	6	1	(6, 6)	(8, 8)	0
planner__cardinality__selectivity	tstring		singular	1	0	3	1	3	5	0
planner__cardinality__selectivity	tstring		singular	1	1	6	1	6	8	0
explain select * from tint where a=1;
id	estRows	task	access object	operator info
TableReader_7	1.00	root		data:Selection_6
└─Selection_6	1.00	cop[tikv]		eq(planner__cardinality__selectivity.tint.a, 1)
  └─TableFullScan_5	8.00	cop[tikv]	table:tint	keep order:false
explain select * from tint where a=4;
id	estRows	task	access object	operator info
TableReader_7	1.00	root		data:Selection_6
└─Selection_6	1.00	cop[tikv]		eq(planner__cardinality__selectivity.tint.a, 4)
  └─TableFullScan_5	8.00	cop[tikv]	table:tint	keep order:false
explain select * from tint where a=8;
id	estRows	task	access object	operator info
TableReader_7	1.00	root		data:Selection_6
└─Selection_6	1.00	cop[tikv]		eq(planner__cardinality__selectivity.tint.a, 8)
  └─TableFullScan_5	8.00	cop[tikv]	table:tint	keep order:false
explain select * from tdouble where a=1;
id	estRows	task	access object	operator info
TableReader_7	1.00	root		data:Selection_6
└─Selection_6	1.00	cop[tikv]		eq(planner__cardinality__selectivity.tdouble.a, 1)
  └─TableFullScan_5	8.00	cop[tikv]	table:tdouble	keep order:false
explain select * from tdouble where a=4;
id	estRows	task	access object	operator info
TableReader_7	1.00	root		data:Selection_6
└─Selection_6	1.00	cop[tikv]		eq(planner__cardinality__selectivity.tdouble.a, 4)
  └─TableFullScan_5	8.00	cop[tikv]	table:tdouble	keep order:false
explain select * from tdouble where a=8;
id	estRows	task	access object	operator info
TableReader_7	1.00	root		data:Selection_6
└─Selection_6	1.00	cop[tikv]		eq(planner__cardinality__selectivity.tdouble.a, 8)
  └─TableFullScan_5	8.00	cop[tikv]	table:tdouble	keep order:false
explain select * from tdecimal where a=1;
id	estRows	task	access object	operator info
TableReader_7	1.00	root		data:Selection_6
└─Selection_6	1.00	cop[tikv]		eq(planner__cardinality__selectivity.tdecimal.a, 1)
  └─TableFullScan_5	8.00	cop[tikv]	table:tdecimal	keep order:false
explain select * from tdecimal where a=4;
id	estRows	task	access object	operator info
TableReader_7	1.00	root		data:Selection_6
└─Selection_6	1.00	cop[tikv]		eq(planner__cardinality__selectivity.tdecimal.a, 4)
  └─TableFullScan_5	8.00	cop[tikv]	table:tdecimal	keep order:false
explain select * from tdecimal where a=8;
id	estRows	task	access object	operator info
TableReader_7	1.00	root		data:Selection_6
└─Selection_6	1.00	cop[tikv]		eq(planner__cardinality__selectivity.tdecimal.a, 8)
  └─TableFullScan_5	8.00	cop[tikv]	table:tdecimal	keep order:false
explain select * from tstring where a='1';
id	estRows	task	access object	operator info
TableReader_7	1.00	root		data:Selection_6
└─Selection_6	1.00	cop[tikv]		eq(planner__cardinality__selectivity.tstring.a, "1")
  └─TableFullScan_5	8.00	cop[tikv]	table:tstring	keep order:false
explain select * from tstring where a='4';
id	estRows	task	access object	operator info
TableReader_7	1.00	root		data:Selection_6
└─Selection_6	1.00	cop[tikv]		eq(planner__cardinality__selectivity.tstring.a, "4")
  └─TableFullScan_5	8.00	cop[tikv]	table:tstring	keep order:false
explain select * from tstring where a='8';
id	estRows	task	access object	operator info
TableReader_7	1.00	root		data:Selection_6
└─Selection_6	1.00	cop[tikv]		eq(planner__cardinality__selectivity.tstring.a, "8")
  └─TableFullScan_5	8.00	cop[tikv]	table:tstring	keep order:false
explain select * from tdatetime where a='2001-01-01';
id	estRows	task	access object	operator info
TableReader_7	1.00	root		data:Selection_6
└─Selection_6	1.00	cop[tikv]		eq(planner__cardinality__selectivity.tdatetime.a, 2001-01-01 00:00:00.000000)
  └─TableFullScan_5	4.00	cop[tikv]	table:tdatetime	keep order:false
explain select * from tdatetime where a='2001-01-02';
id	estRows	task	access object	operator info
TableReader_7	1.00	root		data:Selection_6
└─Selection_6	1.00	cop[tikv]		eq(planner__cardinality__selectivity.tdatetime.a, 2001-01-02 00:00:00.000000)
  └─TableFullScan_5	4.00	cop[tikv]	table:tdatetime	keep order:false
explain select * from tdatetime where a='2001-01-04';
id	estRows	task	access object	operator info
TableReader_7	1.00	root		data:Selection_6
└─Selection_6	1.00	cop[tikv]		eq(planner__cardinality__selectivity.tdatetime.a, 2001-01-04 00:00:00.000000)
  └─TableFullScan_5	4.00	cop[tikv]	table:tdatetime	keep order:false
explain select * from tprefix where a='111';
id	estRows	task	access object	operator info
TableReader_7	1.00	root		data:Selection_6
└─Selection_6	1.00	cop[tikv]		eq(planner__cardinality__selectivity.tprefix.a, "111")
  └─TableFullScan_5	6.00	cop[tikv]	table:tprefix	keep order:false
explain select * from tprefix where a='444';
id	estRows	task	access object	operator info
TableReader_7	1.00	root		data:Selection_6
└─Selection_6	1.00	cop[tikv]		eq(planner__cardinality__selectivity.tprefix.a, "444")
  └─TableFullScan_5	6.00	cop[tikv]	table:tprefix	keep order:false
explain select * from tprefix where a='888';
id	estRows	task	access object	operator info
TableReader_7	1.00	root		data:Selection_6
└─Selection_6	1.00	cop[tikv]		eq(planner__cardinality__selectivity.tprefix.a, "888")
  └─TableFullScan_5	6.00	cop[tikv]	table:tprefix	keep order:false
explain select * from tint where b=1 and c=1;
id	estRows	task	access object	operator info
TableReader_7	1.00	root		data:Selection_6
└─Selection_6	1.00	cop[tikv]		eq(planner__cardinality__selectivity.tint.b, 1), eq(planner__cardinality__selectivity.tint.c, 1)
  └─TableFullScan_5	8.00	cop[tikv]	table:tint	keep order:false
explain select * from tint where b=4 and c=4;
id	estRows	task	access object	operator info
TableReader_7	1.00	root		data:Selection_6
└─Selection_6	1.00	cop[tikv]		eq(planner__cardinality__selectivity.tint.b, 4), eq(planner__cardinality__selectivity.tint.c, 4)
  └─TableFullScan_5	8.00	cop[tikv]	table:tint	keep order:false
explain select * from tint where b=8 and c=8;
id	estRows	task	access object	operator info
TableReader_7	1.00	root		data:Selection_6
└─Selection_6	1.00	cop[tikv]		eq(planner__cardinality__selectivity.tint.b, 8), eq(planner__cardinality__selectivity.tint.c, 8)
  └─TableFullScan_5	8.00	cop[tikv]	table:tint	keep order:false
explain select * from tdouble where b=1 and c=1;
id	estRows	task	access object	operator info
TableReader_7	1.00	root		data:Selection_6
└─Selection_6	1.00	cop[tikv]		eq(planner__cardinality__selectivity.tdouble.b, 1), eq(planner__cardinality__selectivity.tdouble.c, 1)
  └─TableFullScan_5	8.00	cop[tikv]	table:tdouble	keep order:false
explain select * from tdouble where b=4 and c=4;
id	estRows	task	access object	operator info
TableReader_7	1.00	root		data:Selection_6
└─Selection_6	1.00	cop[tikv]		eq(planner__cardinality__selectivity.tdouble.b, 4), eq(planner__cardinality__selectivity.tdouble.c, 4)
  └─TableFullScan_5	8.00	cop[tikv]	table:tdouble	keep order:false
explain select * from tdouble where b=8 and c=8;
id	estRows	task	access object	operator info
TableReader_7	1.00	root		data:Selection_6
└─Selection_6	1.00	cop[tikv]		eq(planner__cardinality__selectivity.tdouble.b, 8), eq(planner__cardinality__selectivity.tdouble.c, 8)
  └─TableFullScan_5	8.00	cop[tikv]	table:tdouble	keep order:false
explain select * from tdecimal where b=1 and c=1;
id	estRows	task	access object	operator info
TableReader_7	1.00	root		data:Selection_6
└─Selection_6	1.00	cop[tikv]		eq(planner__cardinality__selectivity.tdecimal.b, 1), eq(planner__cardinality__selectivity.tdecimal.c, 1)
  └─TableFullScan_5	8.00	cop[tikv]	table:tdecimal	keep order:false
explain select * from tdecimal where b=4 and c=4;
id	estRows	task	access object	operator info
TableReader_7	1.00	root		data:Selection_6
└─Selection_6	1.00	cop[tikv]		eq(planner__cardinality__selectivity.tdecimal.b, 4), eq(planner__cardinality__selectivity.tdecimal.c, 4)
  └─TableFullScan_5	8.00	cop[tikv]	table:tdecimal	keep order:false
explain select * from tdecimal where b=8 and c=8;
id	estRows	task	access object	operator info
TableReader_7	1.00	root		data:Selection_6
└─Selection_6	1.00	cop[tikv]		eq(planner__cardinality__selectivity.tdecimal.b, 8), eq(planner__cardinality__selectivity.tdecimal.c, 8)
  └─TableFullScan_5	8.00	cop[tikv]	table:tdecimal	keep order:false
explain select * from tstring where b='1' and c='1';
id	estRows	task	access object	operator info
TableReader_7	1.00	root		data:Selection_6
└─Selection_6	1.00	cop[tikv]		eq(planner__cardinality__selectivity.tstring.b, "1"), eq(planner__cardinality__selectivity.tstring.c, "1")
  └─TableFullScan_5	8.00	cop[tikv]	table:tstring	keep order:false
explain select * from tstring where b='4' and c='4';
id	estRows	task	access object	operator info
TableReader_7	1.00	root		data:Selection_6
└─Selection_6	1.00	cop[tikv]		eq(planner__cardinality__selectivity.tstring.b, "4"), eq(planner__cardinality__selectivity.tstring.c, "4")
  └─TableFullScan_5	8.00	cop[tikv]	table:tstring	keep order:false
explain select * from tstring where b='8' and c='8';
id	estRows	task	access object	operator info
TableReader_7	1.00	root		data:Selection_6
└─Selection_6	1.00	cop[tikv]		eq(planner__cardinality__selectivity.tstring.b, "8"), eq(planner__cardinality__selectivity.tstring.c, "8")
  └─TableFullScan_5	8.00	cop[tikv]	table:tstring	keep order:false
explain select * from tdatetime where b='2001-01-01' and c='2001-01-01';
id	estRows	task	access object	operator info
TableReader_7	1.00	root		data:Selection_6
└─Selection_6	1.00	cop[tikv]		eq(planner__cardinality__selectivity.tdatetime.b, 2001-01-01 00:00:00.000000), eq(planner__cardinality__selectivity.tdatetime.c, 2001-01-01 00:00:00.000000)
  └─TableFullScan_5	4.00	cop[tikv]	table:tdatetime	keep order:false
explain select * from tdatetime where b='2001-01-02' and c='2001-01-02';
id	estRows	task	access object	operator info
TableReader_7	1.00	root		data:Selection_6
└─Selection_6	1.00	cop[tikv]		eq(planner__cardinality__selectivity.tdatetime.b, 2001-01-02 00:00:00.000000), eq(planner__cardinality__selectivity.tdatetime.c, 2001-01-02 00:00:00.000000)
  └─TableFullScan_5	4.00	cop[tikv]	table:tdatetime	keep order:false
explain select * from tdatetime where b='2001-01-04' and c='2001-01-04';
id	estRows	task	access object	operator info
TableReader_7	1.00	root		data:Selection_6
└─Selection_6	1.00	cop[tikv]		eq(planner__cardinality__selectivity.tdatetime.b, 2001-01-04 00:00:00.000000), eq(planner__cardinality__selectivity.tdatetime.c, 2001-01-04 00:00:00.000000)
  └─TableFullScan_5	4.00	cop[tikv]	table:tdatetime	keep order:false
explain select * from tint where b=1;
id	estRows	task	access object	operator info
TableReader_7	1.00	root		data:Selection_6
└─Selection_6	1.00	cop[tikv]		eq(planner__cardinality__selectivity.tint.b, 1)
  └─TableFullScan_5	8.00	cop[tikv]	table:tint	keep order:false
explain select * from tint where b=4;
id	estRows	task	access object	operator info
TableReader_7	1.00	root		data:Selection_6
└─Selection_6	1.00	cop[tikv]		eq(planner__cardinality__selectivity.tint.b, 4)
  └─TableFullScan_5	8.00	cop[tikv]	table:tint	keep order:false
explain select * from tint where b=8;
id	estRows	task	access object	operator info
TableReader_7	1.00	root		data:Selection_6
└─Selection_6	1.00	cop[tikv]		eq(planner__cardinality__selectivity.tint.b, 8)
  └─TableFullScan_5	8.00	cop[tikv]	table:tint	keep order:false
explain select * from tdouble where b=1;
id	estRows	task	access object	operator info
TableReader_7	1.00	root		data:Selection_6
└─Selection_6	1.00	cop[tikv]		eq(planner__cardinality__selectivity.tdouble.b, 1)
  └─TableFullScan_5	8.00	cop[tikv]	table:tdouble	keep order:false
explain select * from tdouble where b=4;
id	estRows	task	access object	operator info
TableReader_7	1.00	root		data:Selection_6
└─Selection_6	1.00	cop[tikv]		eq(planner__cardinality__selectivity.tdouble.b, 4)
  └─TableFullScan_5	8.00	cop[tikv]	table:tdouble	keep order:false
explain select * from tdouble where b=8;
id	estRows	task	access object	operator info
TableReader_7	1.00	root		data:Selection_6
└─Selection_6	1.00	cop[tikv]		eq(planner__cardinality__selectivity.tdouble.b, 8)
  └─TableFullScan_5	8.00	cop[tikv]	table:tdouble	keep order:false
explain select * from tdecimal where b=1;
id	estRows	task	access object	operator info
TableReader_7	1.00	root		data:Selection_6
└─Selection_6	1.00	cop[tikv]		eq(planner__cardinality__selectivity.tdecimal.b, 1)
  └─TableFullScan_5	8.00	cop[tikv]	table:tdecimal	keep order:false
explain select * from tdecimal where b=4;
id	estRows	task	access object	operator info
TableReader_7	1.00	root		data:Selection_6
└─Selection_6	1.00	cop[tikv]		eq(planner__cardinality__selectivity.tdecimal.b, 4)
  └─TableFullScan_5	8.00	cop[tikv]	table:tdecimal	keep order:false
explain select * from tdecimal where b=8;
id	estRows	task	access object	operator info
TableReader_7	1.00	root		data:Selection_6
└─Selection_6	1.00	cop[tikv]		eq(planner__cardinality__selectivity.tdecimal.b, 8)
  └─TableFullScan_5	8.00	cop[tikv]	table:tdecimal	keep order:false
explain select * from tstring where b='1';
id	estRows	task	access object	operator info
TableReader_7	1.00	root		data:Selection_6
└─Selection_6	1.00	cop[tikv]		eq(planner__cardinality__selectivity.tstring.b, "1")
  └─TableFullScan_5	8.00	cop[tikv]	table:tstring	keep order:false
explain select * from tstring where b='4';
id	estRows	task	access object	operator info
TableReader_7	1.00	root		data:Selection_6
└─Selection_6	1.00	cop[tikv]		eq(planner__cardinality__selectivity.tstring.b, "4")
  └─TableFullScan_5	8.00	cop[tikv]	table:tstring	keep order:false
explain select * from tstring where b='8';
id	estRows	task	access object	operator info
TableReader_7	1.00	root		data:Selection_6
└─Selection_6	1.00	cop[tikv]		eq(planner__cardinality__selectivity.tstring.b, "8")
  └─TableFullScan_5	8.00	cop[tikv]	table:tstring	keep order:false
explain select * from tdatetime where b='2001-01-01';
id	estRows	task	access object	operator info
TableReader_7	1.00	root		data:Selection_6
└─Selection_6	1.00	cop[tikv]		eq(planner__cardinality__selectivity.tdatetime.b, 2001-01-01 00:00:00.000000)
  └─TableFullScan_5	4.00	cop[tikv]	table:tdatetime	keep order:false
explain select * from tdatetime where b='2001-01-02';
id	estRows	task	access object	operator info
TableReader_7	1.00	root		data:Selection_6
└─Selection_6	1.00	cop[tikv]		eq(planner__cardinality__selectivity.tdatetime.b, 2001-01-02 00:00:00.000000)
  └─TableFullScan_5	4.00	cop[tikv]	table:tdatetime	keep order:false
explain select * from tdatetime where b='2001-01-04';
id	estRows	task	access object	operator info
TableReader_7	1.00	root		data:Selection_6
└─Selection_6	1.00	cop[tikv]		eq(planner__cardinality__selectivity.tdatetime.b, 2001-01-04 00:00:00.000000)
  └─TableFullScan_5	4.00	cop[tikv]	table:tdatetime	keep order:false
explain select * from ct1 where pk>='1' and pk <='4';
id	estRows	task	access object	operator info
TableReader_6	5.00	root		data:TableRangeScan_5
└─TableRangeScan_5	5.00	cop[tikv]	table:ct1	range:["1","4"], keep order:false
explain select * from ct1 where pk>='4' and pk <='6';
id	estRows	task	access object	operator info
TableReader_6	3.75	root		data:TableRangeScan_5
└─TableRangeScan_5	3.75	cop[tikv]	table:ct1	range:["4","6"], keep order:false
explain select * from ct1 where pk>='6' and pk <='8';
id	estRows	task	access object	operator info
TableReader_6	3.00	root		data:TableRangeScan_5
└─TableRangeScan_5	3.00	cop[tikv]	table:ct1	range:["6","8"], keep order:false
explain select * from ct2 where a=1 and b>=1 and b<=8;
id	estRows	task	access object	operator info
TableReader_6	1.00	root		data:TableRangeScan_5
└─TableRangeScan_5	1.00	cop[tikv]	table:ct2	range:[1 1,1 8], keep order:false
explain select * from ct2 where a=4 and b>=1 and b<=8;
id	estRows	task	access object	operator info
TableReader_6	1.00	root		data:TableRangeScan_5
└─TableRangeScan_5	1.00	cop[tikv]	table:ct2	range:[4 1,4 8], keep order:false
explain select * from ct2 where a=8 and b>=1 and b<=8;
id	estRows	task	access object	operator info
TableReader_6	1.00	root		data:TableRangeScan_5
└─TableRangeScan_5	1.00	cop[tikv]	table:ct2	range:[8 1,8 8], keep order:false
set tidb_analyze_version=2;
drop table if exists topn_before_hist;
create table topn_before_hist(a int, index idx(a));
insert into topn_before_hist values(1), (1), (1), (1), (3), (3), (4), (5), (6);
analyze table topn_before_hist with 2 topn, 3 buckets;
create table topn_after_hist(a int, index idx(a));
insert into topn_after_hist values(2), (2), (3), (4), (5), (7), (7), (7), (7);
analyze table topn_after_hist with 2 topn, 3 buckets;
create table topn_before_hist_no_index(a int);
insert into topn_before_hist_no_index values(1), (1), (1), (1), (3), (3), (4), (5), (6);
analyze table topn_before_hist_no_index with 2 topn, 3 buckets;
create table topn_after_hist_no_index(a int);
insert into topn_after_hist_no_index values(2), (2), (3), (4), (5), (7), (7), (7), (7);
analyze table topn_after_hist_no_index with 2 topn, 3 buckets;
show stats_topn where db_name = 'planner__cardinality__selectivity';
Db_name	Table_name	Partition_name	Column_name	Is_index	Value	Count
planner__cardinality__selectivity	ct1		PRIMARY	1	1	1
planner__cardinality__selectivity	ct1		PRIMARY	1	2	1
planner__cardinality__selectivity	ct1		a	0	1	1
planner__cardinality__selectivity	ct1		a	0	2	1
planner__cardinality__selectivity	ct1		pk	0	1	1
planner__cardinality__selectivity	ct1		pk	0	2	1
planner__cardinality__selectivity	ct2		PRIMARY	1	(1, 1)	1
planner__cardinality__selectivity	ct2		PRIMARY	1	(2, 2)	1
planner__cardinality__selectivity	ct2		a	0	1	1
planner__cardinality__selectivity	ct2		a	0	2	1
planner__cardinality__selectivity	ct2		b	0	1	1
planner__cardinality__selectivity	ct2		b	0	2	1
planner__cardinality__selectivity	ct2		c	0	1	1
planner__cardinality__selectivity	ct2		c	0	2	1
planner__cardinality__selectivity	tdatetime		a	0	2001-01-01 00:00:00	1
planner__cardinality__selectivity	tdatetime		a	0	2001-01-02 00:00:00	1
planner__cardinality__selectivity	tdatetime		b	0	2001-01-01 00:00:00	1
planner__cardinality__selectivity	tdatetime		b	0	2001-01-02 00:00:00	1
planner__cardinality__selectivity	tdatetime		c	0	2001-01-01 00:00:00	1
planner__cardinality__selectivity	tdatetime		c	0	2001-01-02 00:00:00	1
planner__cardinality__selectivity	tdatetime		multi	1	(2001-01-01 00:00:00, 2001-01-01 00:00:00)	1
planner__cardinality__selectivity	tdatetime		multi	1	(2001-01-02 00:00:00, 2001-01-02 00:00:00)	1
planner__cardinality__selectivity	tdatetime		singular	1	2001-01-01 00:00:00	1
planner__cardinality__selectivity	tdatetime		singular	1	2001-01-02 00:00:00	1
planner__cardinality__selectivity	tdecimal		a	0	1.00000000000000000000	1
planner__cardinality__selectivity	tdecimal		a	0	2.00000000000000000000	1
planner__cardinality__selectivity	tdecimal		b	0	1.00000000000000000000	1
planner__cardinality__selectivity	tdecimal		b	0	2.00000000000000000000	1
planner__cardinality__selectivity	tdecimal		c	0	1.00000000000000000000	1
planner__cardinality__selectivity	tdecimal		c	0	2.00000000000000000000	1
planner__cardinality__selectivity	tdecimal		multi	1	(1.00000000000000000000, 1.00000000000000000000)	1
planner__cardinality__selectivity	tdecimal		multi	1	(2.00000000000000000000, 2.00000000000000000000)	1
planner__cardinality__selectivity	tdecimal		singular	1	1.00000000000000000000	1
planner__cardinality__selectivity	tdecimal		singular	1	2.00000000000000000000	1
planner__cardinality__selectivity	tdouble		a	0	1	1
planner__cardinality__selectivity	tdouble		a	0	2	1
planner__cardinality__selectivity	tdouble		b	0	1	1
planner__cardinality__selectivity	tdouble		b	0	2	1
planner__cardinality__selectivity	tdouble		c	0	1	1
planner__cardinality__selectivity	tdouble		c	0	2	1
planner__cardinality__selectivity	tdouble		multi	1	(1, 1)	1
planner__cardinality__selectivity	tdouble		multi	1	(2, 2)	1
planner__cardinality__selectivity	tdouble		singular	1	1	1
planner__cardinality__selectivity	tdouble		singular	1	2	1
planner__cardinality__selectivity	tint		a	0	1	1
planner__cardinality__selectivity	tint		a	0	2	1
planner__cardinality__selectivity	tint		b	0	1	1
planner__cardinality__selectivity	tint		b	0	2	1
planner__cardinality__selectivity	tint		c	0	1	1
planner__cardinality__selectivity	tint		c	0	2	1
planner__cardinality__selectivity	tint		multi	1	(1, 1)	1
planner__cardinality__selectivity	tint		multi	1	(2, 2)	1
planner__cardinality__selectivity	tint		singular	1	1	1
planner__cardinality__selectivity	tint		singular	1	2	1
planner__cardinality__selectivity	topn_after_hist		a	0	2	2
planner__cardinality__selectivity	topn_after_hist		a	0	7	4
planner__cardinality__selectivity	topn_after_hist		idx	1	2	2
planner__cardinality__selectivity	topn_after_hist		idx	1	7	4
planner__cardinality__selectivity	topn_after_hist_no_index		a	0	2	2
planner__cardinality__selectivity	topn_after_hist_no_index		a	0	7	4
planner__cardinality__selectivity	topn_before_hist		a	0	1	4
planner__cardinality__selectivity	topn_before_hist		a	0	3	2
planner__cardinality__selectivity	topn_before_hist		idx	1	1	4
planner__cardinality__selectivity	topn_before_hist		idx	1	3	2
planner__cardinality__selectivity	topn_before_hist_no_index		a	0	1	4
planner__cardinality__selectivity	topn_before_hist_no_index		a	0	3	2
planner__cardinality__selectivity	tprefix		a	0	111	1
planner__cardinality__selectivity	tprefix		a	0	222	1
planner__cardinality__selectivity	tprefix		b	0	111	1
planner__cardinality__selectivity	tprefix		b	0	222	1
planner__cardinality__selectivity	tprefix		prefixa	1	11	1
planner__cardinality__selectivity	tprefix		prefixa	1	22	1
planner__cardinality__selectivity	tstring		a	0	1	1
planner__cardinality__selectivity	tstring		a	0	2	1
planner__cardinality__selectivity	tstring		b	0	1	1
planner__cardinality__selectivity	tstring		b	0	2	1
planner__cardinality__selectivity	tstring		c	0	1	1
planner__cardinality__selectivity	tstring		c	0	2	1
planner__cardinality__selectivity	tstring		multi	1	(1, 1)	1
planner__cardinality__selectivity	tstring		multi	1	(2, 2)	1
planner__cardinality__selectivity	tstring		singular	1	1	1
planner__cardinality__selectivity	tstring		singular	1	2	1
show stats_buckets where db_name = 'planner__cardinality__selectivity';
Db_name	Table_name	Partition_name	Column_name	Is_index	Bucket_id	Count	Repeats	Lower_Bound	Upper_Bound	Ndv
planner__cardinality__selectivity	ct1		PRIMARY	1	0	3	1	3	5	0
planner__cardinality__selectivity	ct1		PRIMARY	1	1	6	1	6	8	0
planner__cardinality__selectivity	ct1		a	0	0	3	1	3	5	0
planner__cardinality__selectivity	ct1		a	0	1	6	1	6	8	0
planner__cardinality__selectivity	ct1		pk	0	0	3	1	3	5	0
planner__cardinality__selectivity	ct1		pk	0	1	6	1	6	8	0
planner__cardinality__selectivity	ct2		PRIMARY	1	0	3	1	(3, 3)	(5, 5)	0
planner__cardinality__selectivity	ct2		PRIMARY	1	1	6	1	(6, 6)	(8, 8)	0
planner__cardinality__selectivity	ct2		a	0	0	3	1	3	5	0
planner__cardinality__selectivity	ct2		a	0	1	6	1	6	8	0
planner__cardinality__selectivity	ct2		b	0	0	3	1	3	5	0
planner__cardinality__selectivity	ct2		b	0	1	6	1	6	8	0
planner__cardinality__selectivity	ct2		c	0	0	3	1	3	5	0
planner__cardinality__selectivity	ct2		c	0	1	6	1	6	8	0
planner__cardinality__selectivity	tdatetime		a	0	0	1	1	2001-01-03 00:00:00	2001-01-03 00:00:00	0
planner__cardinality__selectivity	tdatetime		a	0	1	2	1	2001-01-04 00:00:00	2001-01-04 00:00:00	0
planner__cardinality__selectivity	tdatetime		b	0	0	1	1	2001-01-03 00:00:00	2001-01-03 00:00:00	0
planner__cardinality__selectivity	tdatetime		b	0	1	2	1	2001-01-04 00:00:00	2001-01-04 00:00:00	0
planner__cardinality__selectivity	tdatetime		c	0	0	1	1	2001-01-03 00:00:00	2001-01-03 00:00:00	0
planner__cardinality__selectivity	tdatetime		c	0	1	2	1	2001-01-04 00:00:00	2001-01-04 00:00:00	0
planner__cardinality__selectivity	tdatetime		multi	1	0	1	1	(2001-01-03 00:00:00, 2001-01-03 00:00:00)	(2001-01-03 00:00:00, 2001-01-03 00:00:00)	0
planner__cardinality__selectivity	tdatetime		multi	1	1	2	1	(2001-01-04 00:00:00, 2001-01-04 00:00:00)	(2001-01-04 00:00:00, 2001-01-04 00:00:00)	0
planner__cardinality__selectivity	tdatetime		singular	1	0	1	1	2001-01-03 00:00:00	2001-01-03 00:00:00	0
planner__cardinality__selectivity	tdatetime		singular	1	1	2	1	2001-01-04 00:00:00	2001-01-04 00:00:00	0
planner__cardinality__selectivity	tdecimal		a	0	0	3	1	3.00000000000000000000	5.00000000000000000000	0
planner__cardinality__selectivity	tdecimal		a	0	1	6	1	6.00000000000000000000	8.00000000000000000000	0
planner__cardinality__selectivity	tdecimal		b	0	0	3	1	3.00000000000000000000	5.00000000000000000000	0
planner__cardinality__selectivity	tdecimal		b	0	1	6	1	6.00000000000000000000	8.00000000000000000000	0
planner__cardinality__selectivity	tdecimal		c	0	0	3	1	3.00000000000000000000	5.00000000000000000000	0
planner__cardinality__selectivity	tdecimal		c	0	1	6	1	6.00000000000000000000	8.00000000000000000000	0
planner__cardinality__selectivity	tdecimal		multi	1	0	3	1	(3.00000000000000000000, 3.00000000000000000000)	(5.00000000000000000000, 5.00000000000000000000)	0
planner__cardinality__selectivity	tdecimal		multi	1	1	6	1	(6.00000000000000000000, 6.00000000000000000000)	(8.00000000000000000000, 8.00000000000000000000)	0
planner__cardinality__selectivity	tdecimal		singular	1	0	3	1	3.00000000000000000000	5.00000000000000000000	0
planner__cardinality__selectivity	tdecimal		singular	1	1	6	1	6.00000000000000000000	8.00000000000000000000	0
planner__cardinality__selectivity	tdouble		a	0	0	3	1	3	5	0
planner__cardinality__selectivity	tdouble		a	0	1	6	1	6	8	0
planner__cardinality__selectivity	tdouble		b	0	0	3	1	3	5	0
planner__cardinality__selectivity	tdouble		b	0	1	6	1	6	8	0
planner__cardinality__selectivity	tdouble		c	0	0	3	1	3	5	0
planner__cardinality__selectivity	tdouble		c	0	1	6	1	6	8	0
planner__cardinality__selectivity	tdouble		multi	1	0	3	1	(3, 3)	(5, 5)	0
planner__cardinality__selectivity	tdouble		multi	1	1	6	1	(6, 6)	(8, 8)	0
planner__cardinality__selectivity	tdouble		singular	1	0	3	1	3	5	0
planner__cardinality__selectivity	tdouble		singular	1	1	6	1	6	8	0
planner__cardinality__selectivity	tint		a	0	0	3	1	3	5	0
planner__cardinality__selectivity	tint		a	0	1	6	1	6	8	0
planner__cardinality__selectivity	tint		b	0	0	3	1	3	5	0
planner__cardinality__selectivity	tint		b	0	1	6	1	6	8	0
planner__cardinality__selectivity	tint		c	0	0	3	1	3	5	0
planner__cardinality__selectivity	tint		c	0	1	6	1	6	8	0
planner__cardinality__selectivity	tint		multi	1	0	3	1	(3, 3)	(5, 5)	0
planner__cardinality__selectivity	tint		multi	1	1	6	1	(6, 6)	(8, 8)	0
planner__cardinality__selectivity	tint		singular	1	0	3	1	3	5	0
planner__cardinality__selectivity	tint		singular	1	1	6	1	6	8	0
planner__cardinality__selectivity	topn_after_hist		a	0	0	2	1	3	4	0
planner__cardinality__selectivity	topn_after_hist		a	0	1	3	1	5	5	0
planner__cardinality__selectivity	topn_after_hist		idx	1	0	2	1	3	4	0
planner__cardinality__selectivity	topn_after_hist		idx	1	1	3	1	5	5	0
planner__cardinality__selectivity	topn_after_hist_no_index		a	0	0	2	1	3	4	0
planner__cardinality__selectivity	topn_after_hist_no_index		a	0	1	3	1	5	5	0
planner__cardinality__selectivity	topn_before_hist		a	0	0	2	1	4	5	0
planner__cardinality__selectivity	topn_before_hist		a	0	1	3	1	6	6	0
planner__cardinality__selectivity	topn_before_hist		idx	1	0	2	1	4	5	0
planner__cardinality__selectivity	topn_before_hist		idx	1	1	3	1	6	6	0
planner__cardinality__selectivity	topn_before_hist_no_index		a	0	0	2	1	4	5	0
planner__cardinality__selectivity	topn_before_hist_no_index		a	0	1	3	1	6	6	0
planner__cardinality__selectivity	tprefix		a	0	0	2	1	333	444	0
planner__cardinality__selectivity	tprefix		a	0	1	4	1	555	666	0
planner__cardinality__selectivity	tprefix		b	0	0	2	1	333	444	0
planner__cardinality__selectivity	tprefix		b	0	1	4	1	555	666	0
planner__cardinality__selectivity	tprefix		prefixa	1	0	2	1	33	44	0
planner__cardinality__selectivity	tprefix		prefixa	1	1	4	1	55	66	0
planner__cardinality__selectivity	tstring		a	0	0	3	1	3	5	0
planner__cardinality__selectivity	tstring		a	0	1	6	1	6	8	0
planner__cardinality__selectivity	tstring		b	0	0	3	1	3	5	0
planner__cardinality__selectivity	tstring		b	0	1	6	1	6	8	0
planner__cardinality__selectivity	tstring		c	0	0	3	1	3	5	0
planner__cardinality__selectivity	tstring		c	0	1	6	1	6	8	0
planner__cardinality__selectivity	tstring		multi	1	0	3	1	(3, 3)	(5, 5)	0
planner__cardinality__selectivity	tstring		multi	1	1	6	1	(6, 6)	(8, 8)	0
planner__cardinality__selectivity	tstring		singular	1	0	3	1	3	5	0
planner__cardinality__selectivity	tstring		singular	1	1	6	1	6	8	0
explain select * from topn_before_hist where a = 1;
id	estRows	task	access object	operator info
IndexReader_6	4.00	root		index:IndexRangeScan_5
└─IndexRangeScan_5	4.00	cop[tikv]	table:topn_before_hist, index:idx(a)	range:[1,1], keep order:false
explain select * from topn_before_hist where a = 2;
id	estRows	task	access object	operator info
IndexReader_6	1.00	root		index:IndexRangeScan_5
└─IndexRangeScan_5	1.00	cop[tikv]	table:topn_before_hist, index:idx(a)	range:[2,2], keep order:false
explain select * from topn_after_hist where a = 7;
id	estRows	task	access object	operator info
IndexReader_6	4.00	root		index:IndexRangeScan_5
└─IndexRangeScan_5	4.00	cop[tikv]	table:topn_after_hist, index:idx(a)	range:[7,7], keep order:false
explain select * from topn_after_hist where a = 6;
id	estRows	task	access object	operator info
IndexReader_6	1.00	root		index:IndexRangeScan_5
└─IndexRangeScan_5	1.00	cop[tikv]	table:topn_after_hist, index:idx(a)	range:[6,6], keep order:false
explain select * from topn_after_hist_no_index where a = 7;
id	estRows	task	access object	operator info
TableReader_7	4.00	root		data:Selection_6
└─Selection_6	4.00	cop[tikv]		eq(planner__cardinality__selectivity.topn_after_hist_no_index.a, 7)
  └─TableFullScan_5	9.00	cop[tikv]	table:topn_after_hist_no_index	keep order:false
explain select * from topn_after_hist_no_index where a = 6;
id	estRows	task	access object	operator info
TableReader_7	1.00	root		data:Selection_6
└─Selection_6	1.00	cop[tikv]		eq(planner__cardinality__selectivity.topn_after_hist_no_index.a, 6)
  └─TableFullScan_5	9.00	cop[tikv]	table:topn_after_hist_no_index	keep order:false
explain select * from topn_before_hist_no_index where a = 1;
id	estRows	task	access object	operator info
TableReader_7	4.00	root		data:Selection_6
└─Selection_6	4.00	cop[tikv]		eq(planner__cardinality__selectivity.topn_before_hist_no_index.a, 1)
  └─TableFullScan_5	9.00	cop[tikv]	table:topn_before_hist_no_index	keep order:false
explain select * from topn_before_hist_no_index where a = 2;
id	estRows	task	access object	operator info
TableReader_7	1.00	root		data:Selection_6
└─Selection_6	1.00	cop[tikv]		eq(planner__cardinality__selectivity.topn_before_hist_no_index.a, 2)
  └─TableFullScan_5	9.00	cop[tikv]	table:topn_before_hist_no_index	keep order:false
drop table if exists t;
create table t(a char(10), b int, key idx(a, b));
insert into t values ('cn', 0);
insert into t values ('cn', 1);
insert into t values ('cn', 2);
insert into t values ('cn', 3);
insert into t values ('cn', 4);
insert into t values ('cn', 5);
insert into t values ('cn', 6);
insert into t values ('cn', 7);
insert into t values ('cn', 8);
insert into t values ('cn', 9);
insert into t values ('cn', 10);
insert into t values ('cn', 11);
insert into t values ('cn', 12);
insert into t values ('cn', 13);
insert into t values ('cn', 14);
insert into t values ('cn', 15);
insert into t values ('cn', 16);
insert into t values ('cn', 17);
insert into t values ('cn', 18);
insert into t values ('cn', 19);
insert into t values ('cn', 20);
insert into t values ('cn', 21);
insert into t values ('cn', 22);
insert into t values ('cn', 23);
insert into t values ('cn', 24);
insert into t values ('cn', 25);
insert into t values ('cn', 26);
insert into t values ('cn', 27);
insert into t values ('cn', 28);
insert into t values ('cn', 29);
insert into t values ('cn', 30);
insert into t values ('cn', 31);
insert into t values ('cn', 32);
insert into t values ('cn', 33);
insert into t values ('cn', 34);
insert into t values ('cn', 35);
insert into t values ('cn', 36);
insert into t values ('cn', 37);
insert into t values ('cn', 38);
insert into t values ('cn', 39);
insert into t values ('cn', 40);
insert into t values ('cn', 41);
insert into t values ('cn', 42);
insert into t values ('cn', 43);
insert into t values ('cn', 44);
insert into t values ('cn', 45);
insert into t values ('cn', 46);
insert into t values ('cn', 47);
insert into t values ('cn', 48);
insert into t values ('cn', 49);
insert into t values ('cn', 50);
insert into t values ('cn', 51);
insert into t values ('cn', 52);
insert into t values ('cn', 53);
insert into t values ('cn', 54);
insert into t values ('cn', 55);
insert into t values ('cn', 56);
insert into t values ('cn', 57);
insert into t values ('cn', 58);
insert into t values ('cn', 59);
insert into t values ('cn', 60);
insert into t values ('cn', 61);
insert into t values ('cn', 62);
insert into t values ('cn', 63);
insert into t values ('cn', 64);
insert into t values ('cn', 65);
insert into t values ('cn', 66);
insert into t values ('cn', 67);
insert into t values ('cn', 68);
insert into t values ('cn', 69);
insert into t values ('cn', 70);
insert into t values ('cn', 71);
insert into t values ('cn', 72);
insert into t values ('cn', 73);
insert into t values ('cn', 74);
insert into t values ('cn', 75);
insert into t values ('cn', 76);
insert into t values ('cn', 77);
insert into t values ('cn', 78);
insert into t values ('cn', 79);
insert into t values ('cn', 80);
insert into t values ('cn', 81);
insert into t values ('cn', 82);
insert into t values ('cn', 83);
insert into t values ('cn', 84);
insert into t values ('cn', 85);
insert into t values ('cn', 86);
insert into t values ('cn', 87);
insert into t values ('cn', 88);
insert into t values ('cn', 89);
insert into t values ('cn', 90);
insert into t values ('cn', 91);
insert into t values ('cn', 92);
insert into t values ('cn', 93);
insert into t values ('cn', 94);
insert into t values ('cn', 95);
insert into t values ('cn', 96);
insert into t values ('cn', 97);
insert into t values ('cn', 98);
insert into t values ('cn', 99);
insert into t values ('cn', 100);
insert into t values ('cn', 101);
insert into t values ('cn', 102);
insert into t values ('cn', 103);
insert into t values ('cn', 104);
insert into t values ('cn', 105);
insert into t values ('cn', 106);
insert into t values ('cn', 107);
insert into t values ('cn', 108);
insert into t values ('cn', 109);
insert into t values ('cn', 110);
insert into t values ('cn', 111);
insert into t values ('cn', 112);
insert into t values ('cn', 113);
insert into t values ('cn', 114);
insert into t values ('cn', 115);
insert into t values ('cn', 116);
insert into t values ('cn', 117);
insert into t values ('cn', 118);
insert into t values ('cn', 119);
insert into t values ('cn', 120);
insert into t values ('cn', 121);
insert into t values ('cn', 122);
insert into t values ('cn', 123);
insert into t values ('cn', 124);
insert into t values ('cn', 125);
insert into t values ('cn', 126);
insert into t values ('cn', 127);
insert into t values ('cn', 128);
insert into t values ('cn', 129);
insert into t values ('cn', 130);
insert into t values ('cn', 131);
insert into t values ('cn', 132);
insert into t values ('cn', 133);
insert into t values ('cn', 134);
insert into t values ('cn', 135);
insert into t values ('cn', 136);
insert into t values ('cn', 137);
insert into t values ('cn', 138);
insert into t values ('cn', 139);
insert into t values ('cn', 140);
insert into t values ('cn', 141);
insert into t values ('cn', 142);
insert into t values ('cn', 143);
insert into t values ('cn', 144);
insert into t values ('cn', 145);
insert into t values ('cn', 146);
insert into t values ('cn', 147);
insert into t values ('cn', 148);
insert into t values ('cn', 149);
insert into t values ('cn', 150);
insert into t values ('cn', 151);
insert into t values ('cn', 152);
insert into t values ('cn', 153);
insert into t values ('cn', 154);
insert into t values ('cn', 155);
insert into t values ('cn', 156);
insert into t values ('cn', 157);
insert into t values ('cn', 158);
insert into t values ('cn', 159);
insert into t values ('cn', 160);
insert into t values ('cn', 161);
insert into t values ('cn', 162);
insert into t values ('cn', 163);
insert into t values ('cn', 164);
insert into t values ('cn', 165);
insert into t values ('cn', 166);
insert into t values ('cn', 167);
insert into t values ('cn', 168);
insert into t values ('cn', 169);
insert into t values ('cn', 170);
insert into t values ('cn', 171);
insert into t values ('cn', 172);
insert into t values ('cn', 173);
insert into t values ('cn', 174);
insert into t values ('cn', 175);
insert into t values ('cn', 176);
insert into t values ('cn', 177);
insert into t values ('cn', 178);
insert into t values ('cn', 179);
insert into t values ('cn', 180);
insert into t values ('cn', 181);
insert into t values ('cn', 182);
insert into t values ('cn', 183);
insert into t values ('cn', 184);
insert into t values ('cn', 185);
insert into t values ('cn', 186);
insert into t values ('cn', 187);
insert into t values ('cn', 188);
insert into t values ('cn', 189);
insert into t values ('cn', 190);
insert into t values ('cn', 191);
insert into t values ('cn', 192);
insert into t values ('cn', 193);
insert into t values ('cn', 194);
insert into t values ('cn', 195);
insert into t values ('cn', 196);
insert into t values ('cn', 197);
insert into t values ('cn', 198);
insert into t values ('cn', 199);
insert into t values ('cn', 200);
insert into t values ('cn', 201);
insert into t values ('cn', 202);
insert into t values ('cn', 203);
insert into t values ('cn', 204);
insert into t values ('cn', 205);
insert into t values ('cn', 206);
insert into t values ('cn', 207);
insert into t values ('cn', 208);
insert into t values ('cn', 209);
insert into t values ('cn', 210);
insert into t values ('cn', 211);
insert into t values ('cn', 212);
insert into t values ('cn', 213);
insert into t values ('cn', 214);
insert into t values ('cn', 215);
insert into t values ('cn', 216);
insert into t values ('cn', 217);
insert into t values ('cn', 218);
insert into t values ('cn', 219);
insert into t values ('cn', 220);
insert into t values ('cn', 221);
insert into t values ('cn', 222);
insert into t values ('cn', 223);
insert into t values ('cn', 224);
insert into t values ('cn', 225);
insert into t values ('cn', 226);
insert into t values ('cn', 227);
insert into t values ('cn', 228);
insert into t values ('cn', 229);
insert into t values ('cn', 230);
insert into t values ('cn', 231);
insert into t values ('cn', 232);
insert into t values ('cn', 233);
insert into t values ('cn', 234);
insert into t values ('cn', 235);
insert into t values ('cn', 236);
insert into t values ('cn', 237);
insert into t values ('cn', 238);
insert into t values ('cn', 239);
insert into t values ('cn', 240);
insert into t values ('cn', 241);
insert into t values ('cn', 242);
insert into t values ('cn', 243);
insert into t values ('cn', 244);
insert into t values ('cn', 245);
insert into t values ('cn', 246);
insert into t values ('cn', 247);
insert into t values ('cn', 248);
insert into t values ('cn', 249);
insert into t values ('cn', 250);
insert into t values ('cn', 251);
insert into t values ('cn', 252);
insert into t values ('cn', 253);
insert into t values ('cn', 254);
insert into t values ('cn', 255);
insert into t values ('cn', 256);
insert into t values ('cn', 257);
insert into t values ('cn', 258);
insert into t values ('cn', 259);
insert into t values ('cn', 260);
insert into t values ('cn', 261);
insert into t values ('cn', 262);
insert into t values ('cn', 263);
insert into t values ('cn', 264);
insert into t values ('cn', 265);
insert into t values ('cn', 266);
insert into t values ('cn', 267);
insert into t values ('cn', 268);
insert into t values ('cn', 269);
insert into t values ('cn', 270);
insert into t values ('cn', 271);
insert into t values ('cn', 272);
insert into t values ('cn', 273);
insert into t values ('cn', 274);
insert into t values ('cn', 275);
insert into t values ('cn', 276);
insert into t values ('cn', 277);
insert into t values ('cn', 278);
insert into t values ('cn', 279);
insert into t values ('cn', 280);
insert into t values ('cn', 281);
insert into t values ('cn', 282);
insert into t values ('cn', 283);
insert into t values ('cn', 284);
insert into t values ('cn', 285);
insert into t values ('cn', 286);
insert into t values ('cn', 287);
insert into t values ('cn', 288);
insert into t values ('cn', 289);
insert into t values ('cn', 290);
insert into t values ('cn', 291);
insert into t values ('cn', 292);
insert into t values ('cn', 293);
insert into t values ('cn', 294);
insert into t values ('cn', 295);
insert into t values ('cn', 296);
insert into t values ('cn', 297);
insert into t values ('cn', 298);
insert into t values ('cn', 299);
insert into t values ('cn', 300);
insert into t values ('cn', 301);
insert into t values ('cn', 302);
insert into t values ('cn', 303);
insert into t values ('cn', 304);
insert into t values ('cn', 305);
insert into t values ('cn', 306);
insert into t values ('cn', 307);
insert into t values ('cn', 308);
insert into t values ('cn', 309);
insert into t values ('cn', 310);
insert into t values ('cn', 311);
insert into t values ('cn', 312);
insert into t values ('cn', 313);
insert into t values ('cn', 314);
insert into t values ('cn', 315);
insert into t values ('cn', 316);
insert into t values ('cn', 317);
insert into t values ('cn', 318);
insert into t values ('cn', 319);
insert into t values ('cn', 320);
insert into t values ('cn', 321);
insert into t values ('cn', 322);
insert into t values ('cn', 323);
insert into t values ('cn', 324);
insert into t values ('cn', 325);
insert into t values ('cn', 326);
insert into t values ('cn', 327);
insert into t values ('cn', 328);
insert into t values ('cn', 329);
insert into t values ('cn', 330);
insert into t values ('cn', 331);
insert into t values ('cn', 332);
insert into t values ('cn', 333);
insert into t values ('cn', 334);
insert into t values ('cn', 335);
insert into t values ('cn', 336);
insert into t values ('cn', 337);
insert into t values ('cn', 338);
insert into t values ('cn', 339);
insert into t values ('cn', 340);
insert into t values ('cn', 341);
insert into t values ('cn', 342);
insert into t values ('cn', 343);
insert into t values ('cn', 344);
insert into t values ('cn', 345);
insert into t values ('cn', 346);
insert into t values ('cn', 347);
insert into t values ('cn', 348);
insert into t values ('cn', 349);
insert into t values ('cn', 350);
insert into t values ('cn', 351);
insert into t values ('cn', 352);
insert into t values ('cn', 353);
insert into t values ('cn', 354);
insert into t values ('cn', 355);
insert into t values ('cn', 356);
insert into t values ('cn', 357);
insert into t values ('cn', 358);
insert into t values ('cn', 359);
insert into t values ('cn', 360);
insert into t values ('cn', 361);
insert into t values ('cn', 362);
insert into t values ('cn', 363);
insert into t values ('cn', 364);
insert into t values ('cn', 365);
insert into t values ('cn', 366);
insert into t values ('cn', 367);
insert into t values ('cn', 368);
insert into t values ('cn', 369);
insert into t values ('cn', 370);
insert into t values ('cn', 371);
insert into t values ('cn', 372);
insert into t values ('cn', 373);
insert into t values ('cn', 374);
insert into t values ('cn', 375);
insert into t values ('cn', 376);
insert into t values ('cn', 377);
insert into t values ('cn', 378);
insert into t values ('cn', 379);
insert into t values ('cn', 380);
insert into t values ('cn', 381);
insert into t values ('cn', 382);
insert into t values ('cn', 383);
insert into t values ('cn', 384);
insert into t values ('cn', 385);
insert into t values ('cn', 386);
insert into t values ('cn', 387);
insert into t values ('cn', 388);
insert into t values ('cn', 389);
insert into t values ('cn', 390);
insert into t values ('cn', 391);
insert into t values ('cn', 392);
insert into t values ('cn', 393);
insert into t values ('cn', 394);
insert into t values ('cn', 395);
insert into t values ('cn', 396);
insert into t values ('cn', 397);
insert into t values ('cn', 398);
insert into t values ('cn', 399);
insert into t values ('cn', 400);
insert into t values ('cn', 401);
insert into t values ('cn', 402);
insert into t values ('cn', 403);
insert into t values ('cn', 404);
insert into t values ('cn', 405);
insert into t values ('cn', 406);
insert into t values ('cn', 407);
insert into t values ('cn', 408);
insert into t values ('cn', 409);
insert into t values ('cn', 410);
insert into t values ('cn', 411);
insert into t values ('cn', 412);
insert into t values ('cn', 413);
insert into t values ('cn', 414);
insert into t values ('cn', 415);
insert into t values ('cn', 416);
insert into t values ('cn', 417);
insert into t values ('cn', 418);
insert into t values ('cn', 419);
insert into t values ('cn', 420);
insert into t values ('cn', 421);
insert into t values ('cn', 422);
insert into t values ('cn', 423);
insert into t values ('cn', 424);
insert into t values ('cn', 425);
insert into t values ('cn', 426);
insert into t values ('cn', 427);
insert into t values ('cn', 428);
insert into t values ('cn', 429);
insert into t values ('cn', 430);
insert into t values ('cn', 431);
insert into t values ('cn', 432);
insert into t values ('cn', 433);
insert into t values ('cn', 434);
insert into t values ('cn', 435);
insert into t values ('cn', 436);
insert into t values ('cn', 437);
insert into t values ('cn', 438);
insert into t values ('cn', 439);
insert into t values ('cn', 440);
insert into t values ('cn', 441);
insert into t values ('cn', 442);
insert into t values ('cn', 443);
insert into t values ('cn', 444);
insert into t values ('cn', 445);
insert into t values ('cn', 446);
insert into t values ('cn', 447);
insert into t values ('cn', 448);
insert into t values ('cn', 449);
insert into t values ('cn', 450);
insert into t values ('cn', 451);
insert into t values ('cn', 452);
insert into t values ('cn', 453);
insert into t values ('cn', 454);
insert into t values ('cn', 455);
insert into t values ('cn', 456);
insert into t values ('cn', 457);
insert into t values ('cn', 458);
insert into t values ('cn', 459);
insert into t values ('cn', 460);
insert into t values ('cn', 461);
insert into t values ('cn', 462);
insert into t values ('cn', 463);
insert into t values ('cn', 464);
insert into t values ('cn', 465);
insert into t values ('cn', 466);
insert into t values ('cn', 467);
insert into t values ('cn', 468);
insert into t values ('cn', 469);
insert into t values ('cn', 470);
insert into t values ('cn', 471);
insert into t values ('cn', 472);
insert into t values ('cn', 473);
insert into t values ('cn', 474);
insert into t values ('cn', 475);
insert into t values ('cn', 476);
insert into t values ('cn', 477);
insert into t values ('cn', 478);
insert into t values ('cn', 479);
insert into t values ('cn', 480);
insert into t values ('cn', 481);
insert into t values ('cn', 482);
insert into t values ('cn', 483);
insert into t values ('cn', 484);
insert into t values ('cn', 485);
insert into t values ('cn', 486);
insert into t values ('cn', 487);
insert into t values ('cn', 488);
insert into t values ('cn', 489);
insert into t values ('cn', 490);
insert into t values ('cn', 491);
insert into t values ('cn', 492);
insert into t values ('cn', 493);
insert into t values ('cn', 494);
insert into t values ('cn', 495);
insert into t values ('cn', 496);
insert into t values ('cn', 497);
insert into t values ('cn', 498);
insert into t values ('tw', 0);
insert into t values ('tw', 0);
insert into t values ('tw', 0);
insert into t values ('tw', 0);
insert into t values ('tw', 0);
insert into t values ('tw', 0);
insert into t values ('tw', 0);
insert into t values ('tw', 0);
insert into t values ('tw', 0);
insert into t values ('tw', 0);
analyze table t;
explain select * from t where a = 'tw' and b < 0;
id	estRows	task	access object	operator info
IndexReader_6	0.00	root		index:IndexRangeScan_5
└─IndexRangeScan_5	0.00	cop[tikv]	table:t, index:idx(a, b)	range:["tw" -inf,"tw" 0), keep order:false
drop table if exists t;
create table t(id int auto_increment, kid int, pid int, primary key(id), key(kid, pid));
insert into t (kid, pid) values (1,2), (1,3), (1,4),(1, 11), (1, 12), (1, 13), (1, 14), (2, 2), (2, 3), (2, 4);
analyze table t;
explain select * from t where kid = 1;
id	estRows	task	access object	operator info
IndexReader_6	7.00	root		index:IndexRangeScan_5
└─IndexRangeScan_5	7.00	cop[tikv]	table:t, index:kid(kid, pid)	range:[1,1], keep order:false
drop table if exists t;
create table t(a int, b varchar(100));
set @@tidb_default_string_match_selectivity = 0.8;
explain format = 'brief' select * from t where a + 10 > 100;
id	estRows	task	access object	operator info
TableReader	8000.00	root		data:Selection
└─Selection	8000.00	cop[tikv]		gt(plus(planner__cardinality__selectivity.t.a, 10), 100)
  └─TableFullScan	10000.00	cop[tikv]	table:t	keep order:false, stats:pseudo
explain format = 'brief' select * from t where b like '%test%';
id	estRows	task	access object	operator info
TableReader	8000.00	root		data:Selection
└─Selection	8000.00	cop[tikv]		like(planner__cardinality__selectivity.t.b, "%test%", 92)
  └─TableFullScan	10000.00	cop[tikv]	table:t	keep order:false, stats:pseudo
explain format = 'brief' select * from t where b not like '%test%';
id	estRows	task	access object	operator info
TableReader	8000.00	root		data:Selection
└─Selection	8000.00	cop[tikv]		not(like(planner__cardinality__selectivity.t.b, "%test%", 92))
  └─TableFullScan	10000.00	cop[tikv]	table:t	keep order:false, stats:pseudo
explain format = 'brief' select * from t where b regexp '.*test.*';
id	estRows	task	access object	operator info
TableReader	8000.00	root		data:Selection
└─Selection	8000.00	cop[tikv]		regexp(planner__cardinality__selectivity.t.b, ".*test.*")
  └─TableFullScan	10000.00	cop[tikv]	table:t	keep order:false, stats:pseudo
explain format = 'brief' select * from t where b not regexp '.*test.*';
id	estRows	task	access object	operator info
TableReader	8000.00	root		data:Selection
└─Selection	8000.00	cop[tikv]		not(istrue_with_null(regexp(planner__cardinality__selectivity.t.b, ".*test.*")))
  └─TableFullScan	10000.00	cop[tikv]	table:t	keep order:false, stats:pseudo
explain format = 'brief' select * from t where b like '%test%' and a + 10 > 100;
id	estRows	task	access object	operator info
TableReader	8000.00	root		data:Selection
└─Selection	8000.00	cop[tikv]		gt(plus(planner__cardinality__selectivity.t.a, 10), 100), like(planner__cardinality__selectivity.t.b, "%test%", 92)
  └─TableFullScan	10000.00	cop[tikv]	table:t	keep order:false, stats:pseudo
explain format = 'brief' select * from t where b not like '%test%' and a + 10 > 100;
id	estRows	task	access object	operator info
TableReader	8000.00	root		data:Selection
└─Selection	8000.00	cop[tikv]		gt(plus(planner__cardinality__selectivity.t.a, 10), 100), not(like(planner__cardinality__selectivity.t.b, "%test%", 92))
  └─TableFullScan	10000.00	cop[tikv]	table:t	keep order:false, stats:pseudo
explain format = 'brief' select * from t where b like '%test%' or a + 10 > 100;
id	estRows	task	access object	operator info
TableReader	9600.00	root		data:Selection
└─Selection	9600.00	cop[tikv]		or(like(planner__cardinality__selectivity.t.b, "%test%", 92), gt(plus(planner__cardinality__selectivity.t.a, 10), 100))
  └─TableFullScan	10000.00	cop[tikv]	table:t	keep order:false, stats:pseudo
set @@tidb_default_string_match_selectivity = 0.9;
explain format = 'brief' select * from t where a + 10 > 100;
id	estRows	task	access object	operator info
TableReader	8000.00	root		data:Selection
└─Selection	8000.00	cop[tikv]		gt(plus(planner__cardinality__selectivity.t.a, 10), 100)
  └─TableFullScan	10000.00	cop[tikv]	table:t	keep order:false, stats:pseudo
explain format = 'brief' select * from t where b like '%test%';
id	estRows	task	access object	operator info
TableReader	9000.00	root		data:Selection
└─Selection	9000.00	cop[tikv]		like(planner__cardinality__selectivity.t.b, "%test%", 92)
  └─TableFullScan	10000.00	cop[tikv]	table:t	keep order:false, stats:pseudo
explain format = 'brief' select * from t where b not like '%test%';
id	estRows	task	access object	operator info
TableReader	1000.00	root		data:Selection
└─Selection	1000.00	cop[tikv]		not(like(planner__cardinality__selectivity.t.b, "%test%", 92))
  └─TableFullScan	10000.00	cop[tikv]	table:t	keep order:false, stats:pseudo
explain format = 'brief' select * from t where b regexp '.*test.*';
id	estRows	task	access object	operator info
TableReader	9000.00	root		data:Selection
└─Selection	9000.00	cop[tikv]		regexp(planner__cardinality__selectivity.t.b, ".*test.*")
  └─TableFullScan	10000.00	cop[tikv]	table:t	keep order:false, stats:pseudo
explain format = 'brief' select * from t where b not regexp '.*test.*';
id	estRows	task	access object	operator info
TableReader	1000.00	root		data:Selection
└─Selection	1000.00	cop[tikv]		not(istrue_with_null(regexp(planner__cardinality__selectivity.t.b, ".*test.*")))
  └─TableFullScan	10000.00	cop[tikv]	table:t	keep order:false, stats:pseudo
explain format = 'brief' select * from t where b like '%test%' and a + 10 > 100;
id	estRows	task	access object	operator info
TableReader	8000.00	root		data:Selection
└─Selection	8000.00	cop[tikv]		gt(plus(planner__cardinality__selectivity.t.a, 10), 100), like(planner__cardinality__selectivity.t.b, "%test%", 92)
  └─TableFullScan	10000.00	cop[tikv]	table:t	keep order:false, stats:pseudo
explain format = 'brief' select * from t where b not like '%test%' and a + 10 > 100;
id	estRows	task	access object	operator info
TableReader	1000.00	root		data:Selection
└─Selection	1000.00	cop[tikv]		gt(plus(planner__cardinality__selectivity.t.a, 10), 100), not(like(planner__cardinality__selectivity.t.b, "%test%", 92))
  └─TableFullScan	10000.00	cop[tikv]	table:t	keep order:false, stats:pseudo
explain format = 'brief' select * from t where b like '%test%' or a + 10 > 100;
id	estRows	task	access object	operator info
TableReader	9800.00	root		data:Selection
└─Selection	9800.00	cop[tikv]		or(like(planner__cardinality__selectivity.t.b, "%test%", 92), gt(plus(planner__cardinality__selectivity.t.a, 10), 100))
  └─TableFullScan	10000.00	cop[tikv]	table:t	keep order:false, stats:pseudo
set @@tidb_default_string_match_selectivity = 0.1;
explain format = 'brief' select * from t where a + 10 > 100;
id	estRows	task	access object	operator info
TableReader	8000.00	root		data:Selection
└─Selection	8000.00	cop[tikv]		gt(plus(planner__cardinality__selectivity.t.a, 10), 100)
  └─TableFullScan	10000.00	cop[tikv]	table:t	keep order:false, stats:pseudo
explain format = 'brief' select * from t where b like '%test%';
id	estRows	task	access object	operator info
TableReader	1000.00	root		data:Selection
└─Selection	1000.00	cop[tikv]		like(planner__cardinality__selectivity.t.b, "%test%", 92)
  └─TableFullScan	10000.00	cop[tikv]	table:t	keep order:false, stats:pseudo
explain format = 'brief' select * from t where b like '%test%' is true;
id	estRows	task	access object	operator info
TableReader	8000.00	root		data:Selection
└─Selection	8000.00	cop[tikv]		istrue(like(planner__cardinality__selectivity.t.b, "%test%", 92))
  └─TableFullScan	10000.00	cop[tikv]	table:t	keep order:false, stats:pseudo
explain format = 'brief' select * from t where b not like '%test%';
id	estRows	task	access object	operator info
TableReader	9000.00	root		data:Selection
└─Selection	9000.00	cop[tikv]		not(like(planner__cardinality__selectivity.t.b, "%test%", 92))
  └─TableFullScan	10000.00	cop[tikv]	table:t	keep order:false, stats:pseudo
explain format = 'brief' select * from t where b regexp '.*test.*';
id	estRows	task	access object	operator info
TableReader	1000.00	root		data:Selection
└─Selection	1000.00	cop[tikv]		regexp(planner__cardinality__selectivity.t.b, ".*test.*")
  └─TableFullScan	10000.00	cop[tikv]	table:t	keep order:false, stats:pseudo
explain format = 'brief' select * from t where b rlike '.*test.*';
id	estRows	task	access object	operator info
TableReader	1000.00	root		data:Selection
└─Selection	1000.00	cop[tikv]		regexp(planner__cardinality__selectivity.t.b, ".*test.*")
  └─TableFullScan	10000.00	cop[tikv]	table:t	keep order:false, stats:pseudo
explain format = 'brief' select * from t where b not rlike '.*test.*';
id	estRows	task	access object	operator info
TableReader	9000.00	root		data:Selection
└─Selection	9000.00	cop[tikv]		not(istrue_with_null(regexp(planner__cardinality__selectivity.t.b, ".*test.*")))
  └─TableFullScan	10000.00	cop[tikv]	table:t	keep order:false, stats:pseudo
explain format = 'brief' select * from t where b not regexp '.*test.*';
id	estRows	task	access object	operator info
TableReader	9000.00	root		data:Selection
└─Selection	9000.00	cop[tikv]		not(istrue_with_null(regexp(planner__cardinality__selectivity.t.b, ".*test.*")))
  └─TableFullScan	10000.00	cop[tikv]	table:t	keep order:false, stats:pseudo
explain format = 'brief' select * from t where b like '%test%' and a + 10 > 100;
id	estRows	task	access object	operator info
TableReader	1000.00	root		data:Selection
└─Selection	1000.00	cop[tikv]		gt(plus(planner__cardinality__selectivity.t.a, 10), 100), like(planner__cardinality__selectivity.t.b, "%test%", 92)
  └─TableFullScan	10000.00	cop[tikv]	table:t	keep order:false, stats:pseudo
explain format = 'brief' select * from t where b not like '%test%' and a + 10 > 100;
id	estRows	task	access object	operator info
TableReader	8000.00	root		data:Selection
└─Selection	8000.00	cop[tikv]		gt(plus(planner__cardinality__selectivity.t.a, 10), 100), not(like(planner__cardinality__selectivity.t.b, "%test%", 92))
  └─TableFullScan	10000.00	cop[tikv]	table:t	keep order:false, stats:pseudo
explain format = 'brief' select * from t where b like '%test%' or a + 10 > 100;
id	estRows	task	access object	operator info
TableReader	8200.00	root		data:Selection
└─Selection	8200.00	cop[tikv]		or(like(planner__cardinality__selectivity.t.b, "%test%", 92), gt(plus(planner__cardinality__selectivity.t.a, 10), 100))
  └─TableFullScan	10000.00	cop[tikv]	table:t	keep order:false, stats:pseudo
set @@tidb_default_string_match_selectivity = 0;
explain format = 'brief' select * from t where a + 10 > 100;
id	estRows	task	access object	operator info
TableReader	8000.00	root		data:Selection
└─Selection	8000.00	cop[tikv]		gt(plus(planner__cardinality__selectivity.t.a, 10), 100)
  └─TableFullScan	10000.00	cop[tikv]	table:t	keep order:false, stats:pseudo
explain format = 'brief' select * from t where b like '%test%';
id	estRows	task	access object	operator info
TableReader	1000.00	root		data:Selection
└─Selection	1000.00	cop[tikv]		like(planner__cardinality__selectivity.t.b, "%test%", 92)
  └─TableFullScan	10000.00	cop[tikv]	table:t	keep order:false, stats:pseudo
explain format = 'brief' select * from t where b not like '%test%';
id	estRows	task	access object	operator info
TableReader	9000.00	root		data:Selection
└─Selection	9000.00	cop[tikv]		not(like(planner__cardinality__selectivity.t.b, "%test%", 92))
  └─TableFullScan	10000.00	cop[tikv]	table:t	keep order:false, stats:pseudo
explain format = 'brief' select * from t where b regexp '.*test.*';
id	estRows	task	access object	operator info
TableReader	1000.00	root		data:Selection
└─Selection	1000.00	cop[tikv]		regexp(planner__cardinality__selectivity.t.b, ".*test.*")
  └─TableFullScan	10000.00	cop[tikv]	table:t	keep order:false, stats:pseudo
explain format = 'brief' select * from t where b not regexp '.*test.*';
id	estRows	task	access object	operator info
TableReader	9000.00	root		data:Selection
└─Selection	9000.00	cop[tikv]		not(istrue_with_null(regexp(planner__cardinality__selectivity.t.b, ".*test.*")))
  └─TableFullScan	10000.00	cop[tikv]	table:t	keep order:false, stats:pseudo
explain format = 'brief' select * from t where b like '%test%' and a + 10 > 100;
id	estRows	task	access object	operator info
TableReader	1000.00	root		data:Selection
└─Selection	1000.00	cop[tikv]		gt(plus(planner__cardinality__selectivity.t.a, 10), 100), like(planner__cardinality__selectivity.t.b, "%test%", 92)
  └─TableFullScan	10000.00	cop[tikv]	table:t	keep order:false, stats:pseudo
explain format = 'brief' select * from t where b not like '%test%' and a + 10 > 100;
id	estRows	task	access object	operator info
TableReader	8000.00	root		data:Selection
└─Selection	8000.00	cop[tikv]		gt(plus(planner__cardinality__selectivity.t.a, 10), 100), not(like(planner__cardinality__selectivity.t.b, "%test%", 92))
  └─TableFullScan	10000.00	cop[tikv]	table:t	keep order:false, stats:pseudo
explain format = 'brief' select * from t where b like '%test%' or a + 10 > 100;
id	estRows	task	access object	operator info
TableReader	8200.00	root		data:Selection
└─Selection	8200.00	cop[tikv]		or(like(planner__cardinality__selectivity.t.b, "%test%", 92), gt(plus(planner__cardinality__selectivity.t.a, 10), 100))
  └─TableFullScan	10000.00	cop[tikv]	table:t	keep order:false, stats:pseudo
