drop table if exists t;
create table t (id int primary key, v int);
insert into t values (1, 1), (2, 2), (3, 3);
insert into t values (4, 4);
explain format = 'brief' select _tidb_commit_ts, id from t where id = 1;
id	estRows	task	access object	operator info
Projection	1.00	root		active_active__commit_ts.t._tidb_commit_ts, active_active__commit_ts.t.id
└─Point_Get	1.00	root	table:t	handle:1
select _tidb_commit_ts, id from t where id = 1;
_tidb_commit_ts	id
TSO	1
explain format = 'brief' select _tidb_commit_ts, id from t where id in (1, 2, 3);
id	estRows	task	access object	operator info
Projection	3.00	root		active_active__commit_ts.t._tidb_commit_ts, active_active__commit_ts.t.id
└─Batch_Point_Get	3.00	root	table:t	handle:[1 2 3], keep order:false, desc:false
select _tidb_commit_ts, id from t where id in (1, 2, 3);
_tidb_commit_ts	id
TSO	1
TSO	2
TSO	3
select _tidb_commit_ts, id from t where id in (3, 4) order by _tidb_commit_ts desc;
_tidb_commit_ts	id
TSO	4
TSO	3
begin;
select _tidb_commit_ts, id from t where id = 1;
_tidb_commit_ts	id
TSO	1
select _tidb_commit_ts, id from t where id in (1, 2, 3);
_tidb_commit_ts	id
TSO	1
TSO	2
TSO	3
insert into t values (5, 5);
insert into t values (6, 6);
select _tidb_commit_ts, id from t where id = 1;
_tidb_commit_ts	id
TSO	1
select _tidb_commit_ts, id from t where id = 5;
_tidb_commit_ts	id
NULL	5
select _tidb_commit_ts, id from t where id in (1, 2, 3);
_tidb_commit_ts	id
TSO	1
TSO	2
TSO	3
select _tidb_commit_ts, id from t where id in (1, 2, 3, 5, 6);
_tidb_commit_ts	id
TSO	1
TSO	2
TSO	3
NULL	5
NULL	6
rollback;
create temporary table tmp (id int primary key, v int);
insert into tmp values (1, 1), (2, 2), (3, 3), (4, 4);
select _tidb_commit_ts, id from t where id = 1;
_tidb_commit_ts	id
TSO	1
select _tidb_commit_ts, id from t where id in (1, 2, 3);
_tidb_commit_ts	id
TSO	1
TSO	2
TSO	3
# TODO
# coprocessor is not supported yet
drop table if exists t;
create table t (a bigint primary key, b int, c int) softdelete = 'on' active_active = 'on';
alter table t drop column _tidb_commit_ts;
insert into t value (1,1,1) on duplicate key update a = _tidb_commit_ts;
insert into t value (1,1,1) on duplicate key update a = _tidb_commit_ts;
select * from t;
a	b	c
TSO	1	1
