create table t (id int primary key, v int) softdelete retention 7 day;
set tidb_dml_type = "bulk";
insert into t values (1,1),(2,2),(3,3),(4,4);
select json_extract(@@tidb_last_txn_info, "$.pipelined");
json_extract(@@tidb_last_txn_info, "$.pipelined")
true
delete from t where id <= 3;
select json_extract(@@tidb_last_txn_info, "$.pipelined");
json_extract(@@tidb_last_txn_info, "$.pipelined")
true
insert into t values (2, 2), (3, 3), (4, 4);
Error 1062 (23000): Duplicate entry '4' for key 't.PRIMARY'
insert into t values (2, 2), (3, 3);
select json_extract(@@tidb_last_txn_info, "$.pipelined");
json_extract(@@tidb_last_txn_info, "$.pipelined")
true
set @@tidb_translate_softdelete_sql = 0;
select id, _tidb_softdelete_time is null from t;
id	_tidb_softdelete_time is null
1	0
2	1
3	1
4	1
set @@tidb_translate_softdelete_sql = 1;
update t set v = v + 1;
select json_extract(@@tidb_last_txn_info, "$.pipelined");
json_extract(@@tidb_last_txn_info, "$.pipelined")
true
select * from t;
id	v
2	3
3	4
4	5
replace into t values (1, 11), (3, 33), (5, 55);
select json_extract(@@tidb_last_txn_info, "$.pipelined");
json_extract(@@tidb_last_txn_info, "$.pipelined")
true
select * from t;
id	v
1	11
2	3
3	33
4	5
5	55
set @@tidb_translate_softdelete_sql = 0;
select id, _tidb_softdelete_time is null from t;
id	_tidb_softdelete_time is null
1	1
2	1
3	1
4	1
5	1
