set tidb_cost_model_version=1;
drop table if exists t;
create table t (a int primary key, b int, c int, d int, e int, f int);
create index tb on t (b);
create index tc on t (c);
create index td on t (d);
# generate a, b, c, d, e, f from 0 to 5000000 and a = b = c = d = e = f
load stats 's/explain_indexmerge_stats_t.json';
explain format = 'brief' select * from t where a < 50 or b < 50;
explain format = 'brief' select * from t where (a < 50 or b < 50) and f > 100;
explain format = 'brief' select * from t where b < 50 or c < 50;
set session tidb_enable_index_merge = on;
# choose the best plan based on cost
explain format = 'brief' select * from t where a < 50 or b < 50;
explain format = 'brief' select * from t where (a < 50 or b < 50) and f > 100;
explain format = 'brief' select * from t where a < 50 or b < 5000000;
explain format = 'brief' select * from t where b < 50 or c < 50;
explain format = 'brief' select * from t where b < 50 or c < 5000000;
explain format = 'brief' select * from t where a < 50 or b < 50 or c < 50;
explain format = 'brief' select * from t where (b < 10000 or c < 10000) and (a < 10 or d < 10) and f < 10;
explain format="dot" select * from t where (a < 50 or b < 50) and f > 100;
set session tidb_enable_index_merge = off;
# be forced to use IndexMerge
explain format = 'brief' select /*+ use_index_merge(t, primary, tb, tc) */ * from t where a <= 500000 or b <= 1000000 or c <= 3000000;
explain format = 'brief' select /*+ use_index_merge(t, tb, tc) */ * from t where b < 50 or c < 5000000;
explain format = 'brief' select /*+ use_index_merge(t, tb, tc) */ * from t where (b < 10000 or c < 10000) and (a < 10 or d < 10) and f < 10;
explain format = 'brief' select /*+ use_index_merge(t, tb) */ * from t where b < 50 or c < 5000000;
# no_index_merge hint
explain format = 'brief' select /*+ no_index_merge(), use_index_merge(t, tb, tc) */ * from t where b < 50 or c < 5000000;
# tableScan can be a partial path to fetch handle
explain format = 'brief' select /*+ use_index_merge(t, primary, tb) */ * from t where a < 50 or b < 5000000;
# composed index
set session tidb_enable_index_merge = on;
drop table if exists t;
CREATE TABLE t (
  `id` int(11) NOT NULL,
  `aid` bigint,
  `c1` varchar(255) DEFAULT NULL,
  `c2` varchar(255) DEFAULT NULL,
  PRIMARY KEY (`id`),
  KEY `aid_c1` (`aid`,`c1`),
  KEY `aid_c2` (`aid`,`c2`)
);
desc select /*+ USE_INDEX_MERGE(t, aid_c1, aid_c2) */ * from t where (aid = 1 and c1='aaa') or (aid = 2 and c2='bbb');
# test issue 61093
use test;
drop table if exists user_authorization_simple;
CREATE TABLE `user_authorization_simple` (
  `id` bigint NOT NULL AUTO_INCREMENT,
  `deleted_at` datetime(3) DEFAULT NULL,
  `auth_type` int NOT NULL DEFAULT '1',
  `auth_value` varchar(255) COLLATE utf8mb4_0900_ai_ci NOT NULL,
  `user_id` varchar(64) COLLATE utf8mb4_0900_ai_ci DEFAULT NULL,
  PRIMARY KEY (`id`) /*T![clustered_index] NONCLUSTERED */,
  KEY `idx_user_authorization_user_id` (`user_id`),
  KEY `idx_user_authorization_deleted_at` (`deleted_at`),
  KEY `idx_user_authorization_auth_type` (`auth_type`),
  KEY `idx_user_authorization_auth_value` (`auth_value`)
);
set @@tidb_opt_fix_control='52869:ON';
load stats 's/issue_61093.json';
explain format = 'brief'
SELECT
  *
FROM
  `user_authorization_simple`
WHERE
  `user_authorization_simple`.`deleted_at` IS NULL
  AND (
    `user_authorization_simple`.`auth_type` = 2
    AND `user_authorization_simple`.`auth_value` = "310419663029329176"
    OR (
      `user_authorization_simple`.`auth_type` = 1
      AND `user_authorization_simple`.`auth_value` = "just4test@gmail.com"
    )
    OR `user_authorization_simple`.`user_id` = "310419663029329176"
  )
  AND `user_authorization_simple`.`deleted_at` IS NULL
ORDER BY
  `user_authorization_simple`.`id`
LIMIT
  1;



| id                                    | estRows | estCost     | actRows | task         | access object                                                                   | execution info                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | operator info                                                                                                                                                                                                                                                                                                                                                                                                                     | memory   | disk     |
| Projection_20                         | 1.03    | 4938208.58  | 20000   | root         |                                                                                 | time:22.8s, loops:21, Concurrency:OFF                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | dh_app_172.dh_account_basic.username, dh_app_172.dh_account_ext_parentinfo.parent_name, dh_app_172.dh_account_basic.user_status, dh_app_172.dh_account_basic.useridx, dh_app_172.dh_account_basic.site_code                                                                                                                                                                                                                       | 332.9 KB | N/A      |
| â””â”€IndexJoin_223                       | 1.03    | 4938208.07  | 20000   | root         |                                                                                 | time:22.8s, loops:21, inner:{total:951.5ms, concurrency:5, task:21, construct:7.6ms, fetch:940.9ms, build:3.01ms}, probe:4.56ms                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | left outer join, inner:IndexLookUp_222, outer key:dh_app_172.dh_account_basic.useridx, dh_app_172.dh_account_basic.site_code, inner key:dh_app_172.dh_account_ext_parentinfo.useridx, dh_app_172.dh_account_ext_parentinfo.site_code, equal cond:eq(dh_app_172.dh_account_basic.site_code, dh_app_172.dh_account_ext_parentinfo.site_code), eq(dh_app_172.dh_account_basic.useridx, dh_app_172.dh_account_ext_parentinfo.useridx) | 2.88 MB  | N/A      |
|   â”œâ”€Sort_243(Build)                   | 1.00    | 4936133.07  | 20000   | root         |                                                                                 | time:22.6s, loops:23                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | dh_app_172.dh_account_basic.useridx                                                                                                                                                                                                                                                                                                                                                                                               | 1.71 MB  | 0 Bytes  |
|   â”‚ â””â”€IndexJoin_234                   | 1.00    | 4936099.47  | 20000   | root         |                                                                                 | time:22.6s, loops:21, inner:{total:831.7ms, concurrency:5, task:21, construct:9.43ms, fetch:816.9ms, build:5.29ms}, probe:6.63ms                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | left outer join, inner:IndexLookUp_233, outer key:dh_app_172.dh_account_basic.useridx, dh_app_172.dh_account_basic.site_code, inner key:dh_app_172.dh_account_basic.useridx, dh_app_172.dh_account_basic.site_code, equal cond:eq(dh_app_172.dh_account_basic.site_code, dh_app_172.dh_account_basic.site_code), eq(dh_app_172.dh_account_basic.useridx, dh_app_172.dh_account_basic.useridx)                                     | 2.56 MB  | N/A      |
|   â”‚   â”œâ”€TopN_49(Build)                | 1.00    | 4934025.89  | 20000   | root         |                                                                                 | time:22.4s, loops:23                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | dh_app_172.dh_account_basic.useridx, offset:0, count:20000                                                                                                                                                                                                                                                                                                                                                                        | 2.03 MB  | N/A      |
|   â”‚   â”‚ â””â”€HashAgg_56                  | 1.00    | 4934014.69  | 1161921 | root         |                                                                                 | time:22.3s, loops:1139, partial_worker:{wall_time:22.035019735s, concurrency:5, task_num:1138, tot_wait:1m49.065337096s, tot_exec:897.592696ms, tot_time:1m50.156570982s, max:22.034980927s, p95:22.034980927s}, final_worker:{wall_time:22.405338761s, concurrency:5, task_num:25, tot_wait:1m50.142996595s, tot_exec:1.876044461s, tot_time:1m52.019053607s, max:22.405279254s, p95:22.405279254s}                                                                                                                                                                                                                                                                                                                                                                        | group by:dh_app_172.dh_account_basic.site_code, dh_app_172.dh_account_basic.useridx, funcs:firstrow(dh_app_172.dh_account_basic.site_code)->dh_app_172.dh_account_basic.site_code, funcs:firstrow(dh_app_172.dh_account_basic.useridx)->dh_app_172.dh_account_basic.useridx                                                                                                                                                       | 590.0 MB | N/A      |
|   â”‚   â”‚   â””â”€IndexHashJoin_74          | 0.00    | 4932435.21  | 1161921 | root         |                                                                                 | time:22s, loops:1139, inner:{total:1m46.5s, concurrency:5, task:54, construct:597.9ms, fetch:1m45.5s, build:115.5ms, join:473.7ms}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | inner join, inner:IndexLookUp_71, outer key:dh_app_172.dh_account_ext_financeinfo.useridx, inner key:dh_app_172.dh_account_basic.useridx, equal cond:eq(dh_app_172.dh_account_ext_financeinfo.useridx, dh_app_172.dh_account_basic.useridx)                                                                                                                                                                                       | 183.1 MB | N/A      |
|   â”‚   â”‚     â”œâ”€TableReader_115(Build)  | 0.00    | 4930362.70  | 1165716 | root         |                                                                                 | time:28.1ms, loops:1161, cop_task: {num: 70, max: 0s, min: 0s, avg: 0s, p95: 0s, copr_cache_hit_ratio: 0.00}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | MppVersion: 2, data:ExchangeSender_114                                                                                                                                                                                                                                                                                                                                                                                            | 6.05 MB  | N/A      |
|   â”‚   â”‚     â”‚ â””â”€ExchangeSender_114    | 0.00    | 73955378.83 | 1165716 | mpp[tiflash] |                                                                                 | tiflash_task:{proc max:44.1ms, min:25.2ms, avg: 36.8ms, p80:41.5ms, p95:44.1ms, iters:70, tasks:6, threads:192}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | ExchangeType: PassThrough                                                                                                                                                                                                                                                                                                                                                                                                         | N/A      | N/A      |
|   â”‚   â”‚     â”‚   â””â”€Selection_113       | 0.00    | 73955378.83 | 1165716 | mpp[tiflash] |                                                                                 | tiflash_task:{proc max:42.1ms, min:24.2ms, avg: 35ms, p80:39.5ms, p95:42.1ms, iters:70, tasks:6, threads:192}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | eq("172", dh_app_172.dh_account_ext_financeinfo.site_code), eq(dh_app_172.dh_account_ext_financeinfo.currency, "VND")                                                                                                                                                                                                                                                                                                             | N/A      | N/A      |
|   â”‚   â”‚     â”‚     â””â”€TableFullScan_112 | 0.00    | 65562446.83 | 1165717 | mpp[tiflash] | table:f                                                                         | tiflash_task:{proc max:42.1ms, min:24.2ms, avg: 34.8ms, p80:39.5ms, p95:42.1ms, iters:70, tasks:6, threads:192}, tiflash_scan:{mvcc_input_rows:2356923, mvcc_input_bytes:40067691, mvcc_output_rows:1165717, lm_skip_rows:0, local_regions:12, remote_regions:0, tot_learner_read:35ms, region_balance:{instance_num: 6, max/min: 2/2=1.000000}, delta_rows:268, delta_bytes:85161, segments:7, stale_read_regions:0, tot_build_snapshot:0ms, tot_build_bitmap:99ms, tot_build_inputstream:101ms, min_local_stream:16ms, max_local_stream:40ms, dtfile:{data_scanned_rows:2405981, data_skipped_rows:4664551, mvcc_scanned_rows:2422362, mvcc_skipped_rows:5180623, lm_filter_scanned_rows:2405981, lm_filter_skipped_rows:4664551, tot_rs_index_check:0ms, tot_read:88ms}} | pushed down filter:gt(dh_app_172.dh_account_ext_financeinfo.useridx, 0), keep order:false, stats:partial[idx_userid_curreny:missing, udx_financeinfo_useridx_sitecode:missing]                                                                                                                                                                                                                                                    | N/A      | N/A      |
|   â”‚   â”‚     â””â”€IndexLookUp_71(Probe)   | 0.00    | 1962.54     | 1161921 | root         |                                                                                 | time:1m42.9s, loops:1206, index_task: {total_time: 1m37.2s, fetch_handle: 1m37.2s, build: 191.3Âµs, wait: 524.7Âµs}, table_task: {total_time: 16.2s, num: 243, concurrency: 5}, next: {wait_index: 1m26.9s, wait_table_lookup_build: 414.8ms, wait_table_lookup_resp: 15.5s}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |                                                                                                                                                                                                                                                                                                                                                                                                                                   | 54.0 KB  | N/A      |
|   â”‚   â”‚       â”œâ”€Selection_69(Build)   | 0.00    | 277.21      | 1161921 | cop[tikv]    |                                                                                 | time:1m37.2s, loops:1392, cop_task: {num: 804, max: 1.62s, min: 15.7ms, avg: 574.8ms, p95: 1.24s, max_proc_keys: 3040, p95_proc_keys: 3040, tot_proc: 4m49.4s, tot_wait: 173.1ms, copr_cache_hit_ratio: 0.00, build_task_duration: 112.1ms, max_distsql_concurrency: 6}, rpc_info:{Cop:{num_rpc:804, total_time:7m42.2s}}, tikv_task:{proc max:1.51s, min:4ms, avg: 547.2ms, p80:815ms, p95:1.22s, iters:4300, tasks:804}, scan_detail: {total_process_keys: 1161921, total_process_keys_size: 63905655, total_keys: 6991025, get_snapshot_time: 47ms, rocksdb: {key_skipped_count: 1161921, block: {cache_hit_count: 91981500, read_count: 2453, read_byte: 27.4 MB, read_time: 216.6ms}}}                                                                                 | gt(dh_app_172.dh_account_basic.useridx, 0)                                                                                                                                                                                                                                                                                                                                                                                        | N/A      | N/A      |
|   â”‚   â”‚       â”‚ â””â”€IndexRangeScan_67   | 0.00    | 227.31      | 1161921 | cop[tikv]    | table:a, index:idx_account_basic_useridx_accounttype(useridx, account_type)     | tikv_task:{proc max:1.51s, min:4ms, avg: 547.1ms, p80:815ms, p95:1.22s, iters:4300, tasks:804}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | range: decided by [eq(dh_app_172.dh_account_basic.useridx, dh_app_172.dh_account_ext_financeinfo.useridx) in(dh_app_172.dh_account_basic.account_type, 2, 5, 9, 10, 11)], keep order:false                                                                                                                                                                                                                                        | N/A      | N/A      |
|   â”‚   â”‚       â””â”€Selection_70(Probe)   | 0.00    | 468.92      | 1161921 | cop[tikv]    |                                                                                 | time:15.8s, loops:1533, cop_task: {num: 3708, max: 194.5ms, min: 0s, avg: 8.49ms, p95: 40.3ms, max_proc_keys: 9714, p95_proc_keys: 1350, tot_proc: 25.1s, tot_wait: 243.2ms, copr_cache_hit_ratio: 0.00, build_task_duration: 36ms, max_distsql_concurrency: 15, max_extra_concurrency: 6, store_batch_num: 124}, rpc_info:{Cop:{num_rpc:3584, total_time:31.4s}}, tikv_task:{proc max:178ms, min:0s, avg: 7.1ms, p80:6ms, p95:38ms, iters:9513, tasks:3708}, scan_detail: {total_process_keys: 1161921, total_process_keys_size: 892296832, total_keys: 1173324, get_snapshot_time: 161.7ms, rocksdb: {delete_skipped_count: 2762, key_skipped_count: 12518, block: {cache_hit_count: 16646559, read_count: 29485, read_byte: 473.3 MB, read_time: 4.38s}}}                | eq(dh_app_172.dh_account_basic.site_code, "172")                                                                                                                                                                                                                                                                                                                                                                                  | N/A      | N/A      |
|   â”‚   â”‚         â””â”€TableRowIDScan_68   | 0.00    | 419.02      | 1161921 | cop[tikv]    | table:a                                                                         | tikv_task:{proc max:177ms, min:0s, avg: 7.06ms, p80:6ms, p95:37.6ms, iters:9513, tasks:3708}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | keep order:false                                                                                                                                                                                                                                                                                                                                                                                                                  | N/A      | N/A      |
|   â”‚   â””â”€IndexLookUp_233(Probe)        | 1.00    | 1959.36     | 20000   | root         |                                                                                 | time:788.2ms, loops:42, index_task: {total_time: 669.8ms, fetch_handle: 669.8ms, build: 12Âµs, wait: 36.4Âµs}, table_task: {total_time: 114.5ms, num: 21, concurrency: 5}, next: {wait_index: 672ms, wait_table_lookup_build: 8.21ms, wait_table_lookup_resp: 106ms}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |                                                                                                                                                                                                                                                                                                                                                                                                                                   | 12.7 KB  | N/A      |
|   â”‚     â”œâ”€IndexRangeScan_231(Build)   | 1.00    | 219.47      | 20000   | cop[tikv]    | table:ma, index:udx_account_basic_useridx_sitecode(useridx, site_code)          | time:668.7ms, loops:44, cop_task: {num: 60, max: 16.7ms, min: 2.57ms, avg: 11.1ms, p95: 15.8ms, max_proc_keys: 480, p95_proc_keys: 480, tot_proc: 554.2ms, tot_wait: 1.4ms, copr_cache_hit_ratio: 0.00, build_task_duration: 636.8Âµs, max_distsql_concurrency: 1}, rpc_info:{Cop:{num_rpc:60, total_time:665.8ms}}, tikv_task:{proc max:15ms, min:2ms, avg: 9.42ms, p80:13ms, p95:14ms, iters:218, tasks:60}, scan_detail: {total_process_keys: 20000, total_process_keys_size: 1060000, total_keys: 40223, get_snapshot_time: 443Âµs, rocksdb: {key_skipped_count: 20068, block: {cache_hit_count: 320591, read_count: 37, read_byte: 349.8 KB, read_time: 241.4Âµs}}}                                                                                                       | range: decided by [eq(dh_app_172.dh_account_basic.useridx, dh_app_172.dh_account_basic.useridx) eq(dh_app_172.dh_account_basic.site_code, dh_app_172.dh_account_basic.site_code)], keep order:false                                                                                                                                                                                                                               | N/A      | N/A      |
|   â”‚     â””â”€TableRowIDScan_232(Probe)   | 1.00    | 419.02      | 20000   | cop[tikv]    | table:ma                                                                        | time:105ms, loops:42, cop_task: {num: 348, max: 11.8ms, min: 0s, avg: 2.27ms, p95: 3.19ms, max_proc_keys: 109, p95_proc_keys: 86, tot_proc: 439.4ms, tot_wait: 13.6ms, copr_cache_hit_ratio: 0.00, build_task_duration: 1.45ms, max_distsql_concurrency: 15, max_extra_concurrency: 6, store_batch_num: 4}, rpc_info:{Cop:{num_rpc:344, total_time:784ms}}, tikv_task:{proc max:9ms, min:0s, avg: 1.28ms, p80:2ms, p95:2ms, iters:658, tasks:348}, scan_detail: {total_process_keys: 20000, total_process_keys_size: 14579818, total_keys: 20121, get_snapshot_time: 7.4ms, rocksdb: {delete_skipped_count: 20, key_skipped_count: 120, block: {cache_hit_count: 293794}}}                                                                                                  | keep order:false                                                                                                                                                                                                                                                                                                                                                                                                                  | N/A      | N/A      |
|   â””â”€IndexLookUp_222(Probe)            | 1.00    | 1957.13     | 14468   | root         |                                                                                 | time:909.2ms, loops:42, index_task: {total_time: 623.5ms, fetch_handle: 623.4ms, build: 11.7Âµs, wait: 39.2Âµs}, table_task: {total_time: 281.6ms, num: 21, concurrency: 5}, next: {wait_index: 626.4ms, wait_table_lookup_build: 7.45ms, wait_table_lookup_resp: 274ms}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |                                                                                                                                                                                                                                                                                                                                                                                                                                   | 11.5 KB  | N/A      |
|     â”œâ”€IndexRangeScan_220(Build)       | 1.00    | 219.47      | 14468   | cop[tikv]    | table:mp, index:udx_account_ext_parentinfo_useridx_sitecode(useridx, site_code) | time:622.7ms, loops:63, cop_task: {num: 60, max: 23.8ms, min: 1.07ms, avg: 10.4ms, p95: 21.6ms, max_proc_keys: 480, p95_proc_keys: 480, tot_proc: 499ms, tot_wait: 2.46ms, copr_cache_hit_ratio: 0.00, build_task_duration: 1.55ms, max_distsql_concurrency: 1}, rpc_info:{Cop:{num_rpc:60, total_time:620.3ms}}, tikv_task:{proc max:21ms, min:0s, avg: 8.5ms, p80:16ms, p95:19ms, iters:172, tasks:60}, scan_detail: {total_process_keys: 14468, total_process_keys_size: 766804, total_keys: 34507, get_snapshot_time: 1.53ms, rocksdb: {key_skipped_count: 14468, block: {cache_hit_count: 280539, read_count: 7, read_byte: 55.2 KB, read_time: 292.7Âµs}}}                                                                                                             | range: decided by [eq(dh_app_172.dh_account_ext_parentinfo.useridx, dh_app_172.dh_account_basic.useridx) eq(dh_app_172.dh_account_ext_parentinfo.site_code, dh_app_172.dh_account_basic.site_code)], keep order:false                                                                                                                                                                                                             | N/A      | N/A      |
|     â””â”€TableRowIDScan_221(Probe)       | 1.00    | 288.15      | 14468   | cop[tikv]    | table:mp                                                                        | time:273.6ms, loops:42, cop_task: {num: 42, max: 27.1ms, min: 2.13ms, avg: 10.3ms, p95: 26.4ms, max_proc_keys: 420, p95_proc_keys: 406, tot_proc: 335.9ms, tot_wait: 1ms, copr_cache_hit_ratio: 0.00, build_task_duration: 2.88ms, max_distsql_concurrency: 2, max_extra_concurrency: 1}, rpc_info:{Cop:{num_rpc:42, total_time:433.6ms}}, tikv_task:{proc max:25ms, min:2ms, avg: 8.02ms, p80:12ms, p95:24ms, iters:160, tasks:42}, scan_detail: {total_process_keys: 14468, total_process_keys_size: 1288650, total_keys: 14508, get_snapshot_time: 342.5Âµs, rocksdb: {key_skipped_count: 80, block: {cache_hit_count: 154063, read_count: 1003, read_byte: 11.2 MB, read_time: 73.9ms}}}                                                                                 | keep order:false                                                                                                                                                                                                                                                                                                                                                                                                                  | N/A      | N/A      |



ðŸš€ TiDB Cascades Rule Evolution Project 
## Enhancement
since cascades projection has been on the way for almost 1 and a half year , we are almost to get across the line of




explain select
	c_name,
	c_custkey,
	o_orderkey,
	o_orderdate,
	o_totalprice,
	sum(l_quantity)
from
	customer,
	orders,
	lineitem
where
	o_orderkey in (
		select
			l_orderkey
		from
			lineitem
		group by
			l_orderkey having
				sum(l_quantity) > 314
	)
	and c_custkey = o_custkey
	and o_orderkey = l_orderkey
group by
	c_name,
	c_custkey,
	o_orderkey,
	o_orderdate,
	o_totalprice
order by
	o_totalprice desc,
	o_orderdate
limit 100;


+--------------------------------------------+------------+-----------+----------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| id                                         | estRows    | task      | access object  | operator info                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
+--------------------------------------------+------------+-----------+----------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Projection_24                              | 100.00     | root      |                | test.customer.c_name, test.customer.c_custkey, test.orders.o_orderkey, test.orders.o_orderdate, test.orders.o_totalprice, Column#52                                                                                                                                                                                                                                                                                                                                                                                   |
| â””â”€TopN_27                                  | 100.00     | root      |                | test.orders.o_totalprice:desc, test.orders.o_orderdate, offset:0, count:100                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|   â””â”€HashAgg_32                             | 187500.00  | root      |                | group by:test.customer.c_custkey, test.customer.c_name, test.orders.o_orderdate, test.orders.o_orderkey, test.orders.o_totalprice, funcs:sum(test.lineitem.l_quantity)->Column#52, funcs:firstrow(test.customer.c_custkey)->test.customer.c_custkey, funcs:firstrow(test.customer.c_name)->test.customer.c_name, funcs:firstrow(test.orders.o_orderkey)->test.orders.o_orderkey, funcs:firstrow(test.orders.o_totalprice)->test.orders.o_totalprice, funcs:firstrow(test.orders.o_orderdate)->test.orders.o_orderdate |
|     â””â”€IndexJoin_34                         | 746504.95  | root      |                | inner join, inner:Selection_112, outer key:test.orders.o_orderkey, inner key:test.lineitem.l_orderkey, equal cond:eq(test.orders.o_orderkey, test.lineitem.l_orderkey)                                                                                                                                                                                                                                                                                                                                                |
|       â”œâ”€IndexJoin_78(Build)                | 746504.95  | root      |                | inner join, inner:TableReader_68, outer key:test.orders.o_orderkey, inner key:test.lineitem.l_orderkey, equal cond:eq(test.orders.o_orderkey, test.lineitem.l_orderkey)                                                                                                                                                                                                                                                                                                                                               |
|       â”‚ â”œâ”€HashJoin_105(Build)              | 187500.00  | root      |                | inner join, equal:[eq(test.customer.c_custkey, test.orders.o_custkey)]                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|       â”‚ â”‚ â”œâ”€TableReader_107(Build)         | 150000.00  | root      |                | data:TableFullScan_106                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|       â”‚ â”‚ â”‚ â””â”€TableFullScan_106            | 150000.00  | cop[tikv] | table:customer | keep order:false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|       â”‚ â”‚ â””â”€TableReader_109(Probe)         | 1500000.00 | root      |                | data:TableFullScan_108                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|       â”‚ â”‚   â””â”€TableFullScan_108            | 1500000.00 | cop[tikv] | table:orders   | keep order:false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|       â”‚ â””â”€TableReader_68(Probe)            | 187500.00  | root      |                | data:TableRangeScan_67                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|       â”‚   â””â”€TableRangeScan_67              | 187500.00  | cop[tikv] | table:lineitem | range: decided by [eq(test.lineitem.l_orderkey, test.orders.o_orderkey)], keep order:false                                                                                                                                                                                                                                                                                                                                                                                                                            |
|       â””â”€Selection_112(Probe)               | 746504.95  | root      |                | gt(Column#50, 314)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|         â””â”€StreamAgg_117                    | 746504.95  | root      |                | group by:test.lineitem.l_orderkey, funcs:sum(test.lineitem.l_quantity)->Column#50, funcs:firstrow(test.lineitem.l_orderkey)->test.lineitem.l_orderkey                                                                                                                                                                                                                                                                                                                                                                 |
|           â””â”€TableReader_130                | 746504.95  | root      |                | data:TableRangeScan_129                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|             â””â”€TableRangeScan_129           | 746504.95  | cop[tikv] | table:lineitem | range: decided by [eq(test.lineitem.l_orderkey, test.orders.o_orderkey)], keep order:true                                                                                                                                                                                                                                                                                                                                                                                                                             |
+--------------------------------------------+------------+-----------+----------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
16 rows in set (0.005 sec)


explain select
	l_orderkey,
	sum(l_extendedprice * (1 - l_discount)) as revenue,
	o_orderdate,
	o_shippriority
from
	customer,
	orders,
	lineitem
where
	c_mktsegment = 'AUTOMOBILE'
	and c_custkey = o_custkey
	and l_orderkey = o_orderkey
	and o_orderdate < '1995-03-13'
	and l_shipdate > '1995-03-13'
group by
	l_orderkey,
	o_orderdate,
	o_shippriority
order by
	revenue desc,
	o_orderdate
limit 10;



>>  *core.PhysicalProjection Column: [test.etf_fndta_sale_bsn_mdl_tbl.row_id,test.etf_fndta_sale_bsn_mdl_tbl.temp_id,test.etf_fndta_sale_bsn_mdl_tbl.dtsr_id,test.etf_fndta_sale_bsn_mdl_tbl.vchr_tpcd,test.etf_fndta_sale_bsn_mdl_tbl.ts_ldgr_bsn_tpcd,test.etf_fndta_sale_bsn_mdl_tbl.ts_ldgr_bsn_tp_nm,test.etf_fndta_sale_bsn_mdl_tbl.ldgrdatabsntp_sdvn_cd,test.etf_fndta_sale_bsn_mdl_tbl.grpg_sn,test.etf_fndta_sale_bsn_mdl_tbl.astprtfl_id,test.etf_fndta_sale_bsn_mdl_tbl.astprtfl_cd,test.etf_fndta_sale_bsn_mdl_tbl.astprtfl_nm,test.etf_fndta_sale_bsn_mdl_tbl.scr_id,test.etf_fndta_sale_bsn_mdl_tbl.scr_nm,test.etf_fndta_sale_bsn_mdl_tbl.scr_cd,test.etf_fndta_sale_bsn_mdl_tbl.mkt_cd,test.etf_fndta_sale_bsn_mdl_tbl.scr_acc_id,test.etf_fndta_sale_bsn_mdl_tbl.scrtacno,test.etf_fndta_sale_bsn_mdl_tbl.mkdam,test.etf_fndta_sale_bsn_mdl_tbl.mdl_num,test.etf_fndta_sale_bsn_mdl_tbl.acg_dt,test.etf_fndta_sale_bsn_mdl_tbl.mdl_dt,test.etf_fndta_sale_bsn_mdl_tbl.cfm_dt,test.etf_fndta_sale_bsn_mdl_tbl.scl_cd,test.etf_fndta_sale_bsn_mdl_tbl.cash_rplc_amt,test.etf_fndta_sale_bsn_mdl_tbl.crsmkt_cash_rplc_amt,test.etf_fndta_sale_bsn_mdl_tbl.can_ret_cash_rplc_amt,test.etf_fndta_sale_bsn_mdl_tbl.bal_dt,test.etf_fndta_sale_bsn_mdl_tbl.arcptl_sbj_bal,test.etf_fndta_sale_bsn_mdl_tbl.arcptl_adj_sbj_bal,test.etf_fndta_sale_bsn_mdl_tbl.rlzpl_elpy_amt,test.etf_fndta_sale_bsn_mdl_tbl.urlz_plepy_amt,test.etf_fndta_sale_bsn_mdl_tbl.cfm_dys,test.etf_fndta_sale_bsn_mdl_tbl.fod_unit_netval,test.etf_fndta_sale_bsn_mdl_tbl.unit_cash_difamt,test.etf_fndta_sale_bsn_mdl_tbl.fanv,test.etf_fndta_sale_bsn_mdl_tbl.prchrdmp_ind,test.etf_fndta_sale_bsn_mdl_tbl.pcsg_btno_id,test.etf_fndta_sale_bsn_mdl_tbl.crsmktcanrcasrplc_amt,test.etf_fndta_sale_bsn_mdl_tbl.lot_adjin,test.etf_fndta_sale_bsn_mdl_tbl.valt_dt,test.etf_fndta_sale_bsn_mdl_tbl.vlttb_tpcd,test.etf_fndta_sale_bsn_mdl_tbl.rdmptncrroscvavi_mdcd,test.etf_fndta_sale_bsn_mdl_tbl.etf_sbrb_cost_cfrmmod_cd,test.etf_fndta_sale_bsn_mdl_tbl.hk_stk_cash_rplc_amt,test.etf_fndta_sale_bsn_mdl_tbl.hkmktcanrtcashrplcamt,Column#92,test.etf_flr_prchrdmp_txn_dtl_tbl.astprtfl_id] PKOrUK: [] NullableUK: []  | err  Can't find column Column#92 in schema Column: [Column#91,test.etf_flr_prchrdmp_txn_dtl_tbl.astprtfl_id,test.etf_flr_prchrdmp_txn_dtl_tbl.ldgrdatabsntp_sdvn_cd] PKOrUK: [[test.etf_flr_prchrdmp_txn_dtl_tbl.ldgrdatabsntp_sdvn_cd,test.etf_flr_prchrdmp_txn_dtl_tbl.astprtfl_id]] NullableUK: []
>>>>  *core.PhysicalIndexJoin Column: [test.etf_fndta_sale_bsn_mdl_tbl.row_id,test.etf_fndta_sale_bsn_mdl_tbl.temp_id,test.etf_fndta_sale_bsn_mdl_tbl.dtsr_id,test.etf_fndta_sale_bsn_mdl_tbl.vchr_tpcd,test.etf_fndta_sale_bsn_mdl_tbl.ts_ldgr_bsn_tpcd,test.etf_fndta_sale_bsn_mdl_tbl.ts_ldgr_bsn_tp_nm,test.etf_fndta_sale_bsn_mdl_tbl.ldgrdatabsntp_sdvn_cd,test.etf_fndta_sale_bsn_mdl_tbl.grpg_sn,test.etf_fndta_sale_bsn_mdl_tbl.astprtfl_id,test.etf_fndta_sale_bsn_mdl_tbl.astprtfl_cd,test.etf_fndta_sale_bsn_mdl_tbl.astprtfl_nm,test.etf_fndta_sale_bsn_mdl_tbl.scr_id,test.etf_fndta_sale_bsn_mdl_tbl.scr_nm,test.etf_fndta_sale_bsn_mdl_tbl.scr_cd,test.etf_fndta_sale_bsn_mdl_tbl.mkt_cd,test.etf_fndta_sale_bsn_mdl_tbl.scr_acc_id,test.etf_fndta_sale_bsn_mdl_tbl.scrtacno,test.etf_fndta_sale_bsn_mdl_tbl.mkdam,test.etf_fndta_sale_bsn_mdl_tbl.mdl_num,test.etf_fndta_sale_bsn_mdl_tbl.acg_dt,test.etf_fndta_sale_bsn_mdl_tbl.mdl_dt,test.etf_fndta_sale_bsn_mdl_tbl.cfm_dt,test.etf_fndta_sale_bsn_mdl_tbl.scl_cd,test.etf_fndta_sale_bsn_mdl_tbl.cash_rplc_amt,test.etf_fndta_sale_bsn_mdl_tbl.crsmkt_cash_rplc_amt,test.etf_fndta_sale_bsn_mdl_tbl.can_ret_cash_rplc_amt,test.etf_fndta_sale_bsn_mdl_tbl.bal_dt,test.etf_fndta_sale_bsn_mdl_tbl.arcptl_sbj_bal,test.etf_fndta_sale_bsn_mdl_tbl.arcptl_adj_sbj_bal,test.etf_fndta_sale_bsn_mdl_tbl.rlzpl_elpy_amt,test.etf_fndta_sale_bsn_mdl_tbl.urlz_plepy_amt,test.etf_fndta_sale_bsn_mdl_tbl.cfm_dys,test.etf_fndta_sale_bsn_mdl_tbl.fod_unit_netval,test.etf_fndta_sale_bsn_mdl_tbl.unit_cash_difamt,test.etf_fndta_sale_bsn_mdl_tbl.fanv,test.etf_fndta_sale_bsn_mdl_tbl.prchrdmp_ind,test.etf_fndta_sale_bsn_mdl_tbl.pcsg_btno_id,test.etf_fndta_sale_bsn_mdl_tbl.crsmktcanrcasrplc_amt,test.etf_fndta_sale_bsn_mdl_tbl.lot_adjin,test.etf_fndta_sale_bsn_mdl_tbl.valt_dt,test.etf_fndta_sale_bsn_mdl_tbl.vlttb_tpcd,test.etf_fndta_sale_bsn_mdl_tbl.rdmptncrroscvavi_mdcd,test.etf_fndta_sale_bsn_mdl_tbl.etf_sbrb_cost_cfrmmod_cd,test.etf_fndta_sale_bsn_mdl_tbl.hk_stk_cash_rplc_amt,test.etf_fndta_sale_bsn_mdl_tbl.hkmktcanrtcashrplcamt,Column#92,test.etf_flr_prchrdmp_txn_dtl_tbl.astprtfl_id] PKOrUK: [] NullableUK: []  | err  Can't find column Column#92 in schema Column: [Column#91,test.etf_flr_prchrdmp_txn_dtl_tbl.astprtfl_id,test.etf_flr_prchrdmp_txn_dtl_tbl.ldgrdatabsntp_sdvn_cd] PKOrUK: [[test.etf_flr_prchrdmp_txn_dtl_tbl.ldgrdatabsntp_sdvn_cd,test.etf_flr_prchrdmp_txn_dtl_tbl.astprtfl_id]] NullableUK: []
>>>>>>  *core.PhysicalIndexLookUpReader Column: [test.etf_fndta_sale_bsn_mdl_tbl.row_id,test.etf_fndta_sale_bsn_mdl_tbl.temp_id,test.etf_fndta_sale_bsn_mdl_tbl.dtsr_id,test.etf_fndta_sale_bsn_mdl_tbl.vchr_tpcd,test.etf_fndta_sale_bsn_mdl_tbl.ts_ldgr_bsn_tpcd,test.etf_fndta_sale_bsn_mdl_tbl.ts_ldgr_bsn_tp_nm,test.etf_fndta_sale_bsn_mdl_tbl.ldgrdatabsntp_sdvn_cd,test.etf_fndta_sale_bsn_mdl_tbl.grpg_sn,test.etf_fndta_sale_bsn_mdl_tbl.astprtfl_id,test.etf_fndta_sale_bsn_mdl_tbl.astprtfl_cd,test.etf_fndta_sale_bsn_mdl_tbl.astprtfl_nm,test.etf_fndta_sale_bsn_mdl_tbl.scr_id,test.etf_fndta_sale_bsn_mdl_tbl.scr_nm,test.etf_fndta_sale_bsn_mdl_tbl.scr_cd,test.etf_fndta_sale_bsn_mdl_tbl.mkt_cd,test.etf_fndta_sale_bsn_mdl_tbl.scr_acc_id,test.etf_fndta_sale_bsn_mdl_tbl.scrtacno,test.etf_fndta_sale_bsn_mdl_tbl.mkdam,test.etf_fndta_sale_bsn_mdl_tbl.mdl_num,test.etf_fndta_sale_bsn_mdl_tbl.acg_dt,test.etf_fndta_sale_bsn_mdl_tbl.mdl_dt,test.etf_fndta_sale_bsn_mdl_tbl.cfm_dt,test.etf_fndta_sale_bsn_mdl_tbl.scl_cd,test.etf_fndta_sale_bsn_mdl_tbl.cash_rplc_amt,test.etf_fndta_sale_bsn_mdl_tbl.crsmkt_cash_rplc_amt,test.etf_fndta_sale_bsn_mdl_tbl.can_ret_cash_rplc_amt,test.etf_fndta_sale_bsn_mdl_tbl.bal_dt,test.etf_fndta_sale_bsn_mdl_tbl.arcptl_sbj_bal,test.etf_fndta_sale_bsn_mdl_tbl.arcptl_adj_sbj_bal,test.etf_fndta_sale_bsn_mdl_tbl.rlzpl_elpy_amt,test.etf_fndta_sale_bsn_mdl_tbl.urlz_plepy_amt,test.etf_fndta_sale_bsn_mdl_tbl.cfm_dys,test.etf_fndta_sale_bsn_mdl_tbl.fod_unit_netval,test.etf_fndta_sale_bsn_mdl_tbl.unit_cash_difamt,test.etf_fndta_sale_bsn_mdl_tbl.fanv,test.etf_fndta_sale_bsn_mdl_tbl.prchrdmp_ind,test.etf_fndta_sale_bsn_mdl_tbl.pcsg_btno_id,test.etf_fndta_sale_bsn_mdl_tbl.crsmktcanrcasrplc_amt,test.etf_fndta_sale_bsn_mdl_tbl.lot_adjin,test.etf_fndta_sale_bsn_mdl_tbl.valt_dt,test.etf_fndta_sale_bsn_mdl_tbl.vlttb_tpcd,test.etf_fndta_sale_bsn_mdl_tbl.rdmptncrroscvavi_mdcd,test.etf_fndta_sale_bsn_mdl_tbl.etf_sbrb_cost_cfrmmod_cd,test.etf_fndta_sale_bsn_mdl_tbl.hk_stk_cash_rplc_amt,test.etf_fndta_sale_bsn_mdl_tbl.hkmktcanrtcashrplcamt] PKOrUK: [[test.etf_fndta_sale_bsn_mdl_tbl.row_id]] NullableUK: []  | err  <nil>
>>>>>>>>  *core.PhysicalIndexScan Column: [test.etf_fndta_sale_bsn_mdl_tbl.pcsg_btno_id,test.etf_fndta_sale_bsn_mdl_tbl.acg_dt,test.etf_fndta_sale_bsn_mdl_tbl.vchr_tpcd,test.etf_fndta_sale_bsn_mdl_tbl.row_id] PKOrUK: [] NullableUK: []  | err  <nil>
>>>>>>>>  *core.PhysicalSelection Column: [test.etf_fndta_sale_bsn_mdl_tbl.row_id,test.etf_fndta_sale_bsn_mdl_tbl.temp_id,test.etf_fndta_sale_bsn_mdl_tbl.dtsr_id,test.etf_fndta_sale_bsn_mdl_tbl.vchr_tpcd,test.etf_fndta_sale_bsn_mdl_tbl.ts_ldgr_bsn_tpcd,test.etf_fndta_sale_bsn_mdl_tbl.ts_ldgr_bsn_tp_nm,test.etf_fndta_sale_bsn_mdl_tbl.ldgrdatabsntp_sdvn_cd,test.etf_fndta_sale_bsn_mdl_tbl.grpg_sn,test.etf_fndta_sale_bsn_mdl_tbl.astprtfl_id,test.etf_fndta_sale_bsn_mdl_tbl.astprtfl_cd,test.etf_fndta_sale_bsn_mdl_tbl.astprtfl_nm,test.etf_fndta_sale_bsn_mdl_tbl.scr_id,test.etf_fndta_sale_bsn_mdl_tbl.scr_nm,test.etf_fndta_sale_bsn_mdl_tbl.scr_cd,test.etf_fndta_sale_bsn_mdl_tbl.mkt_cd,test.etf_fndta_sale_bsn_mdl_tbl.scr_acc_id,test.etf_fndta_sale_bsn_mdl_tbl.scrtacno,test.etf_fndta_sale_bsn_mdl_tbl.mkdam,test.etf_fndta_sale_bsn_mdl_tbl.mdl_num,test.etf_fndta_sale_bsn_mdl_tbl.acg_dt,test.etf_fndta_sale_bsn_mdl_tbl.mdl_dt,test.etf_fndta_sale_bsn_mdl_tbl.cfm_dt,test.etf_fndta_sale_bsn_mdl_tbl.scl_cd,test.etf_fndta_sale_bsn_mdl_tbl.cash_rplc_amt,test.etf_fndta_sale_bsn_mdl_tbl.crsmkt_cash_rplc_amt,test.etf_fndta_sale_bsn_mdl_tbl.can_ret_cash_rplc_amt,test.etf_fndta_sale_bsn_mdl_tbl.bal_dt,test.etf_fndta_sale_bsn_mdl_tbl.arcptl_sbj_bal,test.etf_fndta_sale_bsn_mdl_tbl.arcptl_adj_sbj_bal,test.etf_fndta_sale_bsn_mdl_tbl.rlzpl_elpy_amt,test.etf_fndta_sale_bsn_mdl_tbl.urlz_plepy_amt,test.etf_fndta_sale_bsn_mdl_tbl.cfm_dys,test.etf_fndta_sale_bsn_mdl_tbl.fod_unit_netval,test.etf_fndta_sale_bsn_mdl_tbl.unit_cash_difamt,test.etf_fndta_sale_bsn_mdl_tbl.fanv,test.etf_fndta_sale_bsn_mdl_tbl.prchrdmp_ind,test.etf_fndta_sale_bsn_mdl_tbl.pcsg_btno_id,test.etf_fndta_sale_bsn_mdl_tbl.crsmktcanrcasrplc_amt,test.etf_fndta_sale_bsn_mdl_tbl.lot_adjin,test.etf_fndta_sale_bsn_mdl_tbl.valt_dt,test.etf_fndta_sale_bsn_mdl_tbl.vlttb_tpcd,test.etf_fndta_sale_bsn_mdl_tbl.rdmptncrroscvavi_mdcd,test.etf_fndta_sale_bsn_mdl_tbl.etf_sbrb_cost_cfrmmod_cd,test.etf_fndta_sale_bsn_mdl_tbl.hk_stk_cash_rplc_amt,test.etf_fndta_sale_bsn_mdl_tbl.hkmktcanrtcashrplcamt] PKOrUK: [[test.etf_fndta_sale_bsn_mdl_tbl.row_id]] NullableUK: []  | err  <nil>
>>>>>>>>>>  *core.PhysicalTableScan Column: [test.etf_fndta_sale_bsn_mdl_tbl.row_id,test.etf_fndta_sale_bsn_mdl_tbl.temp_id,test.etf_fndta_sale_bsn_mdl_tbl.dtsr_id,test.etf_fndta_sale_bsn_mdl_tbl.vchr_tpcd,test.etf_fndta_sale_bsn_mdl_tbl.ts_ldgr_bsn_tpcd,test.etf_fndta_sale_bsn_mdl_tbl.ts_ldgr_bsn_tp_nm,test.etf_fndta_sale_bsn_mdl_tbl.ldgrdatabsntp_sdvn_cd,test.etf_fndta_sale_bsn_mdl_tbl.grpg_sn,test.etf_fndta_sale_bsn_mdl_tbl.astprtfl_id,test.etf_fndta_sale_bsn_mdl_tbl.astprtfl_cd,test.etf_fndta_sale_bsn_mdl_tbl.astprtfl_nm,test.etf_fndta_sale_bsn_mdl_tbl.scr_id,test.etf_fndta_sale_bsn_mdl_tbl.scr_nm,test.etf_fndta_sale_bsn_mdl_tbl.scr_cd,test.etf_fndta_sale_bsn_mdl_tbl.mkt_cd,test.etf_fndta_sale_bsn_mdl_tbl.scr_acc_id,test.etf_fndta_sale_bsn_mdl_tbl.scrtacno,test.etf_fndta_sale_bsn_mdl_tbl.mkdam,test.etf_fndta_sale_bsn_mdl_tbl.mdl_num,test.etf_fndta_sale_bsn_mdl_tbl.acg_dt,test.etf_fndta_sale_bsn_mdl_tbl.mdl_dt,test.etf_fndta_sale_bsn_mdl_tbl.cfm_dt,test.etf_fndta_sale_bsn_mdl_tbl.scl_cd,test.etf_fndta_sale_bsn_mdl_tbl.cash_rplc_amt,test.etf_fndta_sale_bsn_mdl_tbl.crsmkt_cash_rplc_amt,test.etf_fndta_sale_bsn_mdl_tbl.can_ret_cash_rplc_amt,test.etf_fndta_sale_bsn_mdl_tbl.bal_dt,test.etf_fndta_sale_bsn_mdl_tbl.arcptl_sbj_bal,test.etf_fndta_sale_bsn_mdl_tbl.arcptl_adj_sbj_bal,test.etf_fndta_sale_bsn_mdl_tbl.rlzpl_elpy_amt,test.etf_fndta_sale_bsn_mdl_tbl.urlz_plepy_amt,test.etf_fndta_sale_bsn_mdl_tbl.cfm_dys,test.etf_fndta_sale_bsn_mdl_tbl.fod_unit_netval,test.etf_fndta_sale_bsn_mdl_tbl.unit_cash_difamt,test.etf_fndta_sale_bsn_mdl_tbl.fanv,test.etf_fndta_sale_bsn_mdl_tbl.prchrdmp_ind,test.etf_fndta_sale_bsn_mdl_tbl.pcsg_btno_id,test.etf_fndta_sale_bsn_mdl_tbl.crsmktcanrcasrplc_amt,test.etf_fndta_sale_bsn_mdl_tbl.lot_adjin,test.etf_fndta_sale_bsn_mdl_tbl.valt_dt,test.etf_fndta_sale_bsn_mdl_tbl.vlttb_tpcd,test.etf_fndta_sale_bsn_mdl_tbl.rdmptncrroscvavi_mdcd,test.etf_fndta_sale_bsn_mdl_tbl.etf_sbrb_cost_cfrmmod_cd,test.etf_fndta_sale_bsn_mdl_tbl.hk_stk_cash_rplc_amt,test.etf_fndta_sale_bsn_mdl_tbl.hkmktcanrtcashrplcamt] PKOrUK: [[test.etf_fndta_sale_bsn_mdl_tbl.row_id]] NullableUK: []  | err  <nil>
>>>>>>  *core.PhysicalProjection Column: [Column#92,test.etf_flr_prchrdmp_txn_dtl_tbl.astprtfl_id] PKOrUK: [[test.etf_flr_prchrdmp_txn_dtl_tbl.astprtfl_id]] NullableUK: []  | err  Can't find column Column#92 in schema Column: [Column#91,test.etf_flr_prchrdmp_txn_dtl_tbl.astprtfl_id,test.etf_flr_prchrdmp_txn_dtl_tbl.ldgrdatabsntp_sdvn_cd] PKOrUK: [[test.etf_flr_prchrdmp_txn_dtl_tbl.ldgrdatabsntp_sdvn_cd,test.etf_flr_prchrdmp_txn_dtl_tbl.astprtfl_id]] NullableUK: []
>>>>>>>>  *core.PhysicalProjection Column: [test.etf_flr_prchrdmp_txn_dtl_tbl.astprtfl_id,Column#92] PKOrUK: [[test.etf_flr_prchrdmp_txn_dtl_tbl.astprtfl_id]] NullableUK: []  | err  Can't find column Column#92 in schema Column: [Column#91,test.etf_flr_prchrdmp_txn_dtl_tbl.astprtfl_id,test.etf_flr_prchrdmp_txn_dtl_tbl.ldgrdatabsntp_sdvn_cd] PKOrUK: [[test.etf_flr_prchrdmp_txn_dtl_tbl.ldgrdatabsntp_sdvn_cd,test.etf_flr_prchrdmp_txn_dtl_tbl.astprtfl_id]] NullableUK: []
>>>>>>>>>>  *core.PhysicalHashAgg Column: [Column#91,test.etf_flr_prchrdmp_txn_dtl_tbl.astprtfl_id,test.etf_flr_prchrdmp_txn_dtl_tbl.ldgrdatabsntp_sdvn_cd] PKOrUK: [[test.etf_flr_prchrdmp_txn_dtl_tbl.ldgrdatabsntp_sdvn_cd,test.etf_flr_prchrdmp_txn_dtl_tbl.astprtfl_id]] NullableUK: []  | err  <nil>
>>>>>>>>>>>>  *core.PhysicalIndexLookUpReader Column: [Column#97,test.etf_flr_prchrdmp_txn_dtl_tbl.ldgrdatabsntp_sdvn_cd,test.etf_flr_prchrdmp_txn_dtl_tbl.astprtfl_id] PKOrUK: [] NullableUK: []  | err  <nil>
>>>>>>>>>>>>>>  *core.PhysicalSelection Column: [test.etf_flr_prchrdmp_txn_dtl_tbl.astprtfl_id,Column#93,Column#94,Column#95,test.etf_flr_prchrdmp_txn_dtl_tbl.ldgrdatabsntp_sdvn_cd,_tidb_rowid] PKOrUK: [] NullableUK: []  | err  <nil>
>>>>>>>>>>>>>>>>  *core.PhysicalIndexScan Column: [test.etf_flr_prchrdmp_txn_dtl_tbl.astprtfl_id,Column#93,Column#94,Column#95,test.etf_flr_prchrdmp_txn_dtl_tbl.ldgrdatabsntp_sdvn_cd,_tidb_rowid] PKOrUK: [] NullableUK: []  | err  <nil>
>>>>>>>>>>>>>>  *core.PhysicalHashAgg Column: [Column#97,test.etf_flr_prchrdmp_txn_dtl_tbl.ldgrdatabsntp_sdvn_cd,test.etf_flr_prchrdmp_txn_dtl_tbl.astprtfl_id] PKOrUK: [] NullableUK: []  | err  <nil>
>>>>>>>>>>>>>>>>  *core.PhysicalTableScan Column: [test.etf_flr_prchrdmp_txn_dtl_tbl.astprtfl_id,test.etf_flr_prchrdmp_txn_dtl_tbl.ldgrdatabsntp_sdvn_cd,test.etf_flr_prchrdmp_txn_dtl_tbl.mkdam] PKOrUK: [] NullableUK: []  | err  <nil>
