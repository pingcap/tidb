# TestStraightJoinHint
set tidb_cost_model_version=2;
drop table if exists t, t1, t2, t3, t4;
create table t(a int, b int, key(a));
create table t1(a int, b int, key(a));
create table t2(a int, b int, key(a));
create table t3(a int, b int, key(a));
create table t4(a int, b int, key(a));
--enable_warnings
explain format='plan_tree' select /*+ straight_join() */ * from t, t1, t2, t3 where t.a = t1.a and t1.b=t2.b;
explain format='plan_tree' select /*+ straight_join() */ * from t2, t1, t3, t where t.a = t1.a and t1.b=t2.b;
explain format='plan_tree' select /*+ straight_join() */ * from t3, t2, t1, t where t.a = t1.a and t1.b=t2.b;
explain format='plan_tree' select /*+ straight_join() */ * from t3, t1, t, t2 where t.a = t1.a and t1.b=t2.b;
explain format='plan_tree' select /*+ straight_join() */ * from t2 join t1 on t2.a=t1.a join t3 on t1.b=t3.b;
explain format='plan_tree' select /*+ straight_join() */ * from t3 join t1 on t1.b=t3.b join t2 on t2.a=t1.a;
explain format='plan_tree' select /*+ straight_join() */ * from t3 join t2 on t2.b=t3.b join t1 on t2.a=t1.a;
explain format='plan_tree' select /*+ straight_join() */ * from t2 join (t1 join t3 on t1.a=t3.a) on t2.a=1;
explain format='plan_tree' select /*+ straight_join() */ * from t2 join (t1 join t3 on t1.a=t3.a) on t2.a=t3.a;
explain format='plan_tree' select /*+ straight_join() */ * from t1 join (t2 join t3 on t2.a=t3.a) on t1.a=t3.a;
explain format='plan_tree' select /*+ straight_join() */ * from t3 join (t1 join t2 on t1.a=t2.a) on t2.a=t3.a;
explain format='plan_tree' select /*+ straight_join() */ * from t2 join t1 on t1.a=t2.a join t3 on t2.b=t3.b;
explain format='plan_tree' select /*+ straight_join() */ * from t1 join t2 on t1.a=t2.a join t3 on t2.b=t3.b;
explain format='plan_tree' select /*+ straight_join() */ * from t2 join t3 on t3.a=t2.a join t1 on t2.a=t1.a;
explain format='plan_tree' select /*+ straight_join() */ * from (t1 join t2 on t1.a=t2.a) join (t3 join t4 on t3.a=t4.a) on t2.a=t4.a;
explain format='plan_tree' select /*+ straight_join() */ * from (t1 join t2 on t1.a=t2.a) join (t3 join t4 on t3.a=t4.a) on t2.a=t3.a;
explain format='plan_tree' select /*+ straight_join() */ * from (t1 join t2 on t1.a=t2.a) join (t3 join t4 on t3.a=t4.a) on t1.a=t4.a;
explain format='plan_tree' select /*+ straight_join() */ * from (t3 join t4 on t3.a=t4.a) join (t1 join t2 on t1.a=t2.a) on t2.a=t4.a;
explain format='plan_tree' select /*+ straight_join() */ * from (t3 join t4 on t3.a=t4.a) join (t1 join t2 on t1.a=t2.a) on t2.a=t3.a;
explain format='plan_tree' select /*+ straight_join() */ * from ((select t3.a, t3.b from t, t1, t2, t3 where t.a = t1.a and t1.b=t2.b) t3 join t4 on t3.a=t4.a) join (t1 join t2 on t1.a=t2.a) on t1.a=t4.a;
explain format='plan_tree' select /*+ straight_join() */ * from (t1 join t2 on t1.a=t2.a) join ((select t3.a, t3.b from t, t1, t2, t3 where t.a = t1.a and t1.b=t2.b) t3 join t4 on t3.a=t4.a) on t2.a=t4.a;
explain format='plan_tree' select /*+ straight_join() */ * from (t1 join t2 on t1.a=t2.a) join ((select t3.a, t3.b from t1, t3, t2, t where t.a = t1.a and t1.b=t2.b) t3 join t4 on t3.a=t4.a) on t2.a=t3.a;
explain format='plan_tree' select /*+ straight_join() */ * from (t1 join t2 on t1.a=t2.a) join ((select t3.a, t3.b from t3, t2, t1, t where t.a = t1.a and t1.b=t2.b) t3 join t4 on t3.a=t4.a) on t1.a=t4.a;
explain format='plan_tree' select /*+ straight_join() */ * from ((select t3.a, t3.b from t1, t2, t, t3 where t.a = t1.a and t1.b=t2.b) t3 join t4 on t3.a=t4.a) join (t1 join t2 on t1.a=t2.a) on t2.a=t4.a;
explain format='plan_tree' select /*+ straight_join() */ * from ((select t3.a, t3.b from t2, t1, t, t3 where t.a = t1.a and t1.b=t2.b) t3 join t4 on t3.a=t4.a) join (t1 join t2 on t1.a=t2.a) on t2.a=t3.a;
explain format='plan_tree' select /*+ straight_join() */ * from ((select t3.a, t3.b from t3, t2, t1, t where t.a = t1.a and t1.b=t2.b) t3 join t4 on t3.a=t4.a) join (t1 join t2 on t1.a=t2.a) on t1.a=t4.a;
--disable_warnings

# TestNoHashJoinHint
drop table if exists t1, t2, t3, t4;
create table t1(a int, b int, key(a));
create table t2(a int, b int, key(a));
create table t3(a int, b int, key(a));
create table t4(a int, b int, key(a));
--enable_warnings
explain format='plan_tree' select /*+ no_hash_join() */ * from t1, t2;
explain format='plan_tree' select /*+ no_hash_join(t1), hash_join(t1) */ * from t1, t2;
explain format='plan_tree' select /*+ no_hash_join(t1), hash_join(t2) */ * from t1, t2;
explain format='plan_tree' select /*+ no_hash_join(t1) */ * from t1, t2;
explain format='plan_tree' select /*+ no_hash_join(t1, t2) */ * from t1, t2;
explain format='plan_tree' select /*+ no_hash_join(t1) */ * from t1, t2 where t1.a=t2.a;
explain format='plan_tree' select /*+ no_hash_join(t1, t2) */ * from t1, t2 where t1.b=t2.b;
explain format='plan_tree' select /*+ no_hash_join(t1) */ * from t1, t2 where t1.a=t2.a and t1.b=t2.b;
explain format='plan_tree' select /*+ no_hash_join(t2) */ * from t1 left join t2 on t1.b=t2.b;
explain format='plan_tree' select /*+ no_hash_join(t2) */ * from t1 left join t2 on t1.a=t2.a;
explain format='plan_tree' select /*+ no_hash_join(t2) */ * from t1 right join t2 on t1.b=t2.b;
explain format='plan_tree' select /*+ no_hash_join(t2) */ * from t1 right join t2 on t1.a=t2.a;
explain format='plan_tree' select /*+ leading(t4, t3, t2, t1), no_hash_join(t2, t3) */ * from t1, t2, t3, t4;
explain format='plan_tree' select /*+ leading(t1, t2, t3, t4), hash_join(t1, t2), no_hash_join(t3), hash_join(t4) */ * from t1, t2, t3, t4;
--disable_warnings

