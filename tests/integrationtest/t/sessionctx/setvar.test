# TestSetVarStringOrEnum
select /*+ set_var(tidb_read_consistency="strict") */ @@tidb_read_consistency;
select @@tidb_read_consistency;
set @@tidb_read_consistency=default;
select @@tidb_read_consistency;
select /*+ set_var(tidb_read_consistency="weak") */ @@tidb_read_consistency;
select @@tidb_read_consistency;
set @@tidb_read_consistency=default;
select @@tidb_read_consistency;
select /*+ set_var(tidb_isolation_read_engines="tidb,tiflash") */ @@tidb_isolation_read_engines;
select @@tidb_isolation_read_engines;
set @@tidb_isolation_read_engines=default;
select @@tidb_isolation_read_engines;
select /*+ set_var(tidb_isolation_read_engines="tikv,tidb") */ @@tidb_isolation_read_engines;
select @@tidb_isolation_read_engines;
set @@tidb_isolation_read_engines=default;
select @@tidb_isolation_read_engines;
select /*+ set_var(tidb_replica_read="follower") */ @@tidb_replica_read;
select @@tidb_replica_read;
set @@tidb_replica_read=default;
select @@tidb_replica_read;
select /*+ set_var(tidb_replica_read="prefer-leader") */ @@tidb_replica_read;
select @@tidb_replica_read;
set @@tidb_replica_read=default;
select @@tidb_replica_read;
select /*+ set_var(tidb_partition_prune_mode="static") */ @@tidb_partition_prune_mode;
select @@tidb_partition_prune_mode;
set @@tidb_partition_prune_mode=default;
select @@tidb_partition_prune_mode;
select /*+ set_var(tidb_partition_prune_mode="dynamic") */ @@tidb_partition_prune_mode;
select @@tidb_partition_prune_mode;
set @@tidb_partition_prune_mode=default;
select @@tidb_partition_prune_mode;
select /*+ set_var(mpp_version="0") */ @@mpp_version;
select @@mpp_version;
set @@mpp_version=default;
select @@mpp_version;
select /*+ set_var(mpp_version="1") */ @@mpp_version;
select @@mpp_version;
set @@mpp_version=default;
select @@mpp_version;
select /*+ set_var(tidb_opt_fix_control="44262:ON") */ @@tidb_opt_fix_control;
select @@tidb_opt_fix_control;
set @@tidb_opt_fix_control=default;
select @@tidb_opt_fix_control;
select /*+ set_var(tidb_opt_fix_control="44389:ON,44823:ON") */ @@tidb_opt_fix_control;
select @@tidb_opt_fix_control;
set @@tidb_opt_fix_control=default;
select @@tidb_opt_fix_control;
select /*+ set_var(tidb_runtime_filter_mode="OFF") */ @@tidb_runtime_filter_mode;
select @@tidb_runtime_filter_mode;
set @@tidb_runtime_filter_mode=default;
select @@tidb_runtime_filter_mode;
select /*+ set_var(tidb_runtime_filter_mode="LOCAL") */ @@tidb_runtime_filter_mode;
select @@tidb_runtime_filter_mode;
set @@tidb_runtime_filter_mode=default;
select @@tidb_runtime_filter_mode;
select /*+ set_var(sql_mode="") */ @@sql_mode;
select @@sql_mode;
set @@sql_mode=default;
select @@sql_mode;
select /*+ set_var(sql_mode="ONLY_FULL_GROUP_BY") */ @@sql_mode;
select @@sql_mode;
set @@sql_mode=default;
select @@sql_mode;

# TestSetVarHintBreakCache
CREATE TABLE t (a INT, b INT, KEY(b));
SET tidb_enable_non_prepared_plan_cache = true;
SELECT * FROM t WHERE b < 10 AND a = 1;
SELECT * FROM t WHERE b < 5 AND a = 2;
select @@last_plan_from_cache;
SELECT /*+ SET_VAR(tidb_distsql_scan_concurrency=10) */ * FROM t WHERE b < 5 AND a = 2;
select @@last_plan_from_cache;
SELECT * FROM t WHERE b < 5 AND a = 2;
select @@last_plan_from_cache;

# TestSetVarNonStringOrEnum
select /*+ set_var(tidb_opt_agg_push_down=0) */ @@tidb_opt_agg_push_down;
select @@tidb_opt_agg_push_down;
set @@tidb_opt_agg_push_down=default;
select @@tidb_opt_agg_push_down;
select /*+ set_var(tidb_opt_agg_push_down=1) */ @@tidb_opt_agg_push_down;
select @@tidb_opt_agg_push_down;
set @@tidb_opt_agg_push_down=default;
select @@tidb_opt_agg_push_down;
select /*+ set_var(tidb_opt_derive_topn=0) */ @@tidb_opt_derive_topn;
select @@tidb_opt_derive_topn;
set @@tidb_opt_derive_topn=default;
select @@tidb_opt_derive_topn;
select /*+ set_var(tidb_opt_derive_topn=1) */ @@tidb_opt_derive_topn;
select @@tidb_opt_derive_topn;
set @@tidb_opt_derive_topn=default;
select @@tidb_opt_derive_topn;
select /*+ set_var(tidb_opt_broadcast_cartesian_join=0) */ @@tidb_opt_broadcast_cartesian_join;
select @@tidb_opt_broadcast_cartesian_join;
set @@tidb_opt_broadcast_cartesian_join=default;
select @@tidb_opt_broadcast_cartesian_join;
select /*+ set_var(tidb_opt_broadcast_cartesian_join=1) */ @@tidb_opt_broadcast_cartesian_join;
select @@tidb_opt_broadcast_cartesian_join;
set @@tidb_opt_broadcast_cartesian_join=default;
select @@tidb_opt_broadcast_cartesian_join;
select /*+ set_var(tidb_opt_mpp_outer_join_fixed_build_side=0) */ @@tidb_opt_mpp_outer_join_fixed_build_side;
select @@tidb_opt_mpp_outer_join_fixed_build_side;
set @@tidb_opt_mpp_outer_join_fixed_build_side=default;
select @@tidb_opt_mpp_outer_join_fixed_build_side;
select /*+ set_var(tidb_opt_mpp_outer_join_fixed_build_side=1) */ @@tidb_opt_mpp_outer_join_fixed_build_side;
select @@tidb_opt_mpp_outer_join_fixed_build_side;
set @@tidb_opt_mpp_outer_join_fixed_build_side=default;
select @@tidb_opt_mpp_outer_join_fixed_build_side;
select /*+ set_var(tidb_opt_distinct_agg_push_down=0) */ @@tidb_opt_distinct_agg_push_down;
select @@tidb_opt_distinct_agg_push_down;
set @@tidb_opt_distinct_agg_push_down=default;
select @@tidb_opt_distinct_agg_push_down;
select /*+ set_var(tidb_opt_distinct_agg_push_down=1) */ @@tidb_opt_distinct_agg_push_down;
select @@tidb_opt_distinct_agg_push_down;
set @@tidb_opt_distinct_agg_push_down=default;
select @@tidb_opt_distinct_agg_push_down;
select /*+ set_var(tidb_opt_skew_distinct_agg=0) */ @@tidb_opt_skew_distinct_agg;
select @@tidb_opt_skew_distinct_agg;
set @@tidb_opt_skew_distinct_agg=default;
select @@tidb_opt_skew_distinct_agg;
select /*+ set_var(tidb_opt_skew_distinct_agg=1) */ @@tidb_opt_skew_distinct_agg;
select @@tidb_opt_skew_distinct_agg;
set @@tidb_opt_skew_distinct_agg=default;
select @@tidb_opt_skew_distinct_agg;
select /*+ set_var(tidb_opt_three_stage_distinct_agg=0) */ @@tidb_opt_three_stage_distinct_agg;
select @@tidb_opt_three_stage_distinct_agg;
set @@tidb_opt_three_stage_distinct_agg=default;
select @@tidb_opt_three_stage_distinct_agg;
select /*+ set_var(tidb_opt_three_stage_distinct_agg=1) */ @@tidb_opt_three_stage_distinct_agg;
select @@tidb_opt_three_stage_distinct_agg;
set @@tidb_opt_three_stage_distinct_agg=default;
select @@tidb_opt_three_stage_distinct_agg;
select /*+ set_var(tidb_broadcast_join_threshold_size=0) */ @@tidb_broadcast_join_threshold_size;
select @@tidb_broadcast_join_threshold_size;
set @@tidb_broadcast_join_threshold_size=default;
select @@tidb_broadcast_join_threshold_size;
select /*+ set_var(tidb_broadcast_join_threshold_size=1) */ @@tidb_broadcast_join_threshold_size;
select @@tidb_broadcast_join_threshold_size;
set @@tidb_broadcast_join_threshold_size=default;
select @@tidb_broadcast_join_threshold_size;
select /*+ set_var(tidb_broadcast_join_threshold_count=0) */ @@tidb_broadcast_join_threshold_count;
select @@tidb_broadcast_join_threshold_count;
set @@tidb_broadcast_join_threshold_count=default;
select @@tidb_broadcast_join_threshold_count;
select /*+ set_var(tidb_broadcast_join_threshold_count=1) */ @@tidb_broadcast_join_threshold_count;
select @@tidb_broadcast_join_threshold_count;
set @@tidb_broadcast_join_threshold_count=default;
select @@tidb_broadcast_join_threshold_count;
select /*+ set_var(tidb_prefer_broadcast_join_by_exchange_data_size=0) */ @@tidb_prefer_broadcast_join_by_exchange_data_size;
select @@tidb_prefer_broadcast_join_by_exchange_data_size;
set @@tidb_prefer_broadcast_join_by_exchange_data_size=default;
select @@tidb_prefer_broadcast_join_by_exchange_data_size;
select /*+ set_var(tidb_prefer_broadcast_join_by_exchange_data_size=1) */ @@tidb_prefer_broadcast_join_by_exchange_data_size;
select @@tidb_prefer_broadcast_join_by_exchange_data_size;
set @@tidb_prefer_broadcast_join_by_exchange_data_size=default;
select @@tidb_prefer_broadcast_join_by_exchange_data_size;
select /*+ set_var(tidb_opt_write_row_id=0) */ @@tidb_opt_write_row_id;
select @@tidb_opt_write_row_id;
set @@tidb_opt_write_row_id=default;
select @@tidb_opt_write_row_id;
select /*+ set_var(tidb_opt_write_row_id=1) */ @@tidb_opt_write_row_id;
select @@tidb_opt_write_row_id;
set @@tidb_opt_write_row_id=default;
select @@tidb_opt_write_row_id;
select /*+ set_var(tidb_optimizer_selectivity_level=0) */ @@tidb_optimizer_selectivity_level;
select @@tidb_optimizer_selectivity_level;
set @@tidb_optimizer_selectivity_level=default;
select @@tidb_optimizer_selectivity_level;
select /*+ set_var(tidb_optimizer_selectivity_level=1) */ @@tidb_optimizer_selectivity_level;
select @@tidb_optimizer_selectivity_level;
set @@tidb_optimizer_selectivity_level=default;
select @@tidb_optimizer_selectivity_level;
select /*+ set_var(tidb_enable_new_only_full_group_by_check=0) */ @@tidb_enable_new_only_full_group_by_check;
select @@tidb_enable_new_only_full_group_by_check;
set @@tidb_enable_new_only_full_group_by_check=default;
select @@tidb_enable_new_only_full_group_by_check;
select /*+ set_var(tidb_enable_new_only_full_group_by_check=1) */ @@tidb_enable_new_only_full_group_by_check;
select @@tidb_enable_new_only_full_group_by_check;
set @@tidb_enable_new_only_full_group_by_check=default;
select @@tidb_enable_new_only_full_group_by_check;
select /*+ set_var(tidb_enable_outer_join_reorder=0) */ @@tidb_enable_outer_join_reorder;
select @@tidb_enable_outer_join_reorder;
set @@tidb_enable_outer_join_reorder=default;
select @@tidb_enable_outer_join_reorder;
select /*+ set_var(tidb_enable_outer_join_reorder=1) */ @@tidb_enable_outer_join_reorder;
select @@tidb_enable_outer_join_reorder;
set @@tidb_enable_outer_join_reorder=default;
select @@tidb_enable_outer_join_reorder;
select /*+ set_var(tidb_enable_null_aware_anti_join=0) */ @@tidb_enable_null_aware_anti_join;
select @@tidb_enable_null_aware_anti_join;
set @@tidb_enable_null_aware_anti_join=default;
select @@tidb_enable_null_aware_anti_join;
select /*+ set_var(tidb_enable_null_aware_anti_join=1) */ @@tidb_enable_null_aware_anti_join;
select @@tidb_enable_null_aware_anti_join;
set @@tidb_enable_null_aware_anti_join=default;
select @@tidb_enable_null_aware_anti_join;
# select /*+ set_var(tidb_read_staleness=0) */ @@tidb_read_staleness;
# select @@tidb_read_staleness;
# set @@tidb_read_staleness=default;
# select @@tidb_read_staleness;
# select /*+ set_var(tidb_read_staleness=-1) */ @@tidb_read_staleness;
# select @@tidb_read_staleness;
# set @@tidb_read_staleness=default;
# select @@tidb_read_staleness;
select /*+ set_var(tidb_enable_paging=0) */ @@tidb_enable_paging;
select @@tidb_enable_paging;
set @@tidb_enable_paging=default;
select @@tidb_enable_paging;
select /*+ set_var(tidb_enable_paging=1) */ @@tidb_enable_paging;
select @@tidb_enable_paging;
set @@tidb_enable_paging=default;
select @@tidb_enable_paging;
select /*+ set_var(tidb_distsql_scan_concurrency=1) */ @@tidb_distsql_scan_concurrency;
select @@tidb_distsql_scan_concurrency;
set @@tidb_distsql_scan_concurrency=default;
select @@tidb_distsql_scan_concurrency;
select /*+ set_var(tidb_distsql_scan_concurrency=2) */ @@tidb_distsql_scan_concurrency;
select @@tidb_distsql_scan_concurrency;
set @@tidb_distsql_scan_concurrency=default;
select @@tidb_distsql_scan_concurrency;
select /*+ set_var(tidb_opt_insubq_to_join_and_agg=0) */ @@tidb_opt_insubq_to_join_and_agg;
select @@tidb_opt_insubq_to_join_and_agg;
set @@tidb_opt_insubq_to_join_and_agg=default;
select @@tidb_opt_insubq_to_join_and_agg;
select /*+ set_var(tidb_opt_insubq_to_join_and_agg=1) */ @@tidb_opt_insubq_to_join_and_agg;
select @@tidb_opt_insubq_to_join_and_agg;
set @@tidb_opt_insubq_to_join_and_agg=default;
select @@tidb_opt_insubq_to_join_and_agg;
select /*+ set_var(tidb_opt_prefer_range_scan=0) */ @@tidb_opt_prefer_range_scan;
select @@tidb_opt_prefer_range_scan;
set @@tidb_opt_prefer_range_scan=default;
select @@tidb_opt_prefer_range_scan;
select /*+ set_var(tidb_opt_prefer_range_scan=1) */ @@tidb_opt_prefer_range_scan;
select @@tidb_opt_prefer_range_scan;
set @@tidb_opt_prefer_range_scan=default;
select @@tidb_opt_prefer_range_scan;
select /*+ set_var(tidb_opt_enable_correlation_adjustment=0) */ @@tidb_opt_enable_correlation_adjustment;
select @@tidb_opt_enable_correlation_adjustment;
set @@tidb_opt_enable_correlation_adjustment=default;
select @@tidb_opt_enable_correlation_adjustment;
select /*+ set_var(tidb_opt_enable_correlation_adjustment=1) */ @@tidb_opt_enable_correlation_adjustment;
select @@tidb_opt_enable_correlation_adjustment;
set @@tidb_opt_enable_correlation_adjustment=default;
select @@tidb_opt_enable_correlation_adjustment;
select /*+ set_var(tidb_opt_limit_push_down_threshold=0) */ @@tidb_opt_limit_push_down_threshold;
select @@tidb_opt_limit_push_down_threshold;
set @@tidb_opt_limit_push_down_threshold=default;
select @@tidb_opt_limit_push_down_threshold;
select /*+ set_var(tidb_opt_limit_push_down_threshold=1) */ @@tidb_opt_limit_push_down_threshold;
select @@tidb_opt_limit_push_down_threshold;
set @@tidb_opt_limit_push_down_threshold=default;
select @@tidb_opt_limit_push_down_threshold;
select /*+ set_var(tidb_opt_correlation_threshold=0) */ @@tidb_opt_correlation_threshold;
select @@tidb_opt_correlation_threshold;
set @@tidb_opt_correlation_threshold=default;
select @@tidb_opt_correlation_threshold;
select /*+ set_var(tidb_opt_correlation_threshold=1) */ @@tidb_opt_correlation_threshold;
select @@tidb_opt_correlation_threshold;
set @@tidb_opt_correlation_threshold=default;
select @@tidb_opt_correlation_threshold;
select /*+ set_var(tidb_opt_correlation_exp_factor=0) */ @@tidb_opt_correlation_exp_factor;
select @@tidb_opt_correlation_exp_factor;
set @@tidb_opt_correlation_exp_factor=default;
select @@tidb_opt_correlation_exp_factor;
select /*+ set_var(tidb_opt_correlation_exp_factor=1) */ @@tidb_opt_correlation_exp_factor;
select @@tidb_opt_correlation_exp_factor;
set @@tidb_opt_correlation_exp_factor=default;
select @@tidb_opt_correlation_exp_factor;
select /*+ set_var(tidb_opt_cpu_factor=0) */ @@tidb_opt_cpu_factor;
select @@tidb_opt_cpu_factor;
set @@tidb_opt_cpu_factor=default;
select @@tidb_opt_cpu_factor;
select /*+ set_var(tidb_opt_cpu_factor=1) */ @@tidb_opt_cpu_factor;
select @@tidb_opt_cpu_factor;
set @@tidb_opt_cpu_factor=default;
select @@tidb_opt_cpu_factor;
select /*+ set_var(tidb_opt_copcpu_factor=0) */ @@tidb_opt_copcpu_factor;
select @@tidb_opt_copcpu_factor;
set @@tidb_opt_copcpu_factor=default;
select @@tidb_opt_copcpu_factor;
select /*+ set_var(tidb_opt_copcpu_factor=1) */ @@tidb_opt_copcpu_factor;
select @@tidb_opt_copcpu_factor;
set @@tidb_opt_copcpu_factor=default;
select @@tidb_opt_copcpu_factor;
select /*+ set_var(tidb_opt_tiflash_concurrency_factor=1) */ @@tidb_opt_tiflash_concurrency_factor;
select @@tidb_opt_tiflash_concurrency_factor;
set @@tidb_opt_tiflash_concurrency_factor=default;
select @@tidb_opt_tiflash_concurrency_factor;
select /*+ set_var(tidb_opt_tiflash_concurrency_factor=2) */ @@tidb_opt_tiflash_concurrency_factor;
select @@tidb_opt_tiflash_concurrency_factor;
set @@tidb_opt_tiflash_concurrency_factor=default;
select @@tidb_opt_tiflash_concurrency_factor;
select /*+ set_var(tidb_opt_network_factor=0) */ @@tidb_opt_network_factor;
select @@tidb_opt_network_factor;
set @@tidb_opt_network_factor=default;
select @@tidb_opt_network_factor;
select /*+ set_var(tidb_opt_network_factor=1) */ @@tidb_opt_network_factor;
select @@tidb_opt_network_factor;
set @@tidb_opt_network_factor=default;
select @@tidb_opt_network_factor;
select /*+ set_var(tidb_opt_scan_factor=0) */ @@tidb_opt_scan_factor;
select @@tidb_opt_scan_factor;
set @@tidb_opt_scan_factor=default;
select @@tidb_opt_scan_factor;
select /*+ set_var(tidb_opt_scan_factor=1) */ @@tidb_opt_scan_factor;
select @@tidb_opt_scan_factor;
set @@tidb_opt_scan_factor=default;
select @@tidb_opt_scan_factor;
select /*+ set_var(tidb_opt_desc_factor=0) */ @@tidb_opt_desc_factor;
select @@tidb_opt_desc_factor;
set @@tidb_opt_desc_factor=default;
select @@tidb_opt_desc_factor;
select /*+ set_var(tidb_opt_desc_factor=1) */ @@tidb_opt_desc_factor;
select @@tidb_opt_desc_factor;
set @@tidb_opt_desc_factor=default;
select @@tidb_opt_desc_factor;
select /*+ set_var(tidb_opt_seek_factor=0) */ @@tidb_opt_seek_factor;
select @@tidb_opt_seek_factor;
set @@tidb_opt_seek_factor=default;
select @@tidb_opt_seek_factor;
select /*+ set_var(tidb_opt_seek_factor=1) */ @@tidb_opt_seek_factor;
select @@tidb_opt_seek_factor;
set @@tidb_opt_seek_factor=default;
select @@tidb_opt_seek_factor;
select /*+ set_var(tidb_opt_memory_factor=0) */ @@tidb_opt_memory_factor;
select @@tidb_opt_memory_factor;
set @@tidb_opt_memory_factor=default;
select @@tidb_opt_memory_factor;
select /*+ set_var(tidb_opt_memory_factor=1) */ @@tidb_opt_memory_factor;
select @@tidb_opt_memory_factor;
set @@tidb_opt_memory_factor=default;
select @@tidb_opt_memory_factor;
select /*+ set_var(tidb_opt_disk_factor=0) */ @@tidb_opt_disk_factor;
select @@tidb_opt_disk_factor;
set @@tidb_opt_disk_factor=default;
select @@tidb_opt_disk_factor;
select /*+ set_var(tidb_opt_disk_factor=1) */ @@tidb_opt_disk_factor;
select @@tidb_opt_disk_factor;
set @@tidb_opt_disk_factor=default;
select @@tidb_opt_disk_factor;
select /*+ set_var(tidb_opt_concurrency_factor=1) */ @@tidb_opt_concurrency_factor;
select @@tidb_opt_concurrency_factor;
set @@tidb_opt_concurrency_factor=default;
select @@tidb_opt_concurrency_factor;
select /*+ set_var(tidb_opt_concurrency_factor=2) */ @@tidb_opt_concurrency_factor;
select @@tidb_opt_concurrency_factor;
set @@tidb_opt_concurrency_factor=default;
select @@tidb_opt_concurrency_factor;
select /*+ set_var(tidb_opt_force_inline_cte=0) */ @@tidb_opt_force_inline_cte;
select @@tidb_opt_force_inline_cte;
set @@tidb_opt_force_inline_cte=default;
select @@tidb_opt_force_inline_cte;
select /*+ set_var(tidb_opt_force_inline_cte=1) */ @@tidb_opt_force_inline_cte;
select @@tidb_opt_force_inline_cte;
set @@tidb_opt_force_inline_cte=default;
select @@tidb_opt_force_inline_cte;
select /*+ set_var(tidb_index_join_batch_size=1) */ @@tidb_index_join_batch_size;
select @@tidb_index_join_batch_size;
set @@tidb_index_join_batch_size=default;
select @@tidb_index_join_batch_size;
select /*+ set_var(tidb_index_join_batch_size=2) */ @@tidb_index_join_batch_size;
select @@tidb_index_join_batch_size;
set @@tidb_index_join_batch_size=default;
select @@tidb_index_join_batch_size;
select /*+ set_var(tidb_index_lookup_size=1) */ @@tidb_index_lookup_size;
select @@tidb_index_lookup_size;
set @@tidb_index_lookup_size=default;
select @@tidb_index_lookup_size;
select /*+ set_var(tidb_index_lookup_size=2) */ @@tidb_index_lookup_size;
select @@tidb_index_lookup_size;
set @@tidb_index_lookup_size=default;
select @@tidb_index_lookup_size;
select /*+ set_var(tidb_index_serial_scan_concurrency=1) */ @@tidb_index_serial_scan_concurrency;
select @@tidb_index_serial_scan_concurrency;
set @@tidb_index_serial_scan_concurrency=default;
select @@tidb_index_serial_scan_concurrency;
select /*+ set_var(tidb_index_serial_scan_concurrency=2) */ @@tidb_index_serial_scan_concurrency;
select @@tidb_index_serial_scan_concurrency;
set @@tidb_index_serial_scan_concurrency=default;
select @@tidb_index_serial_scan_concurrency;
select /*+ set_var(tidb_allow_batch_cop=0) */ @@tidb_allow_batch_cop;
select @@tidb_allow_batch_cop;
set @@tidb_allow_batch_cop=default;
select @@tidb_allow_batch_cop;
select /*+ set_var(tidb_allow_batch_cop=1) */ @@tidb_allow_batch_cop;
select @@tidb_allow_batch_cop;
set @@tidb_allow_batch_cop=default;
select @@tidb_allow_batch_cop;
select /*+ set_var(tidb_allow_mpp=0) */ @@tidb_allow_mpp;
select @@tidb_allow_mpp;
set @@tidb_allow_mpp=default;
select @@tidb_allow_mpp;
select /*+ set_var(tidb_allow_mpp=1) */ @@tidb_allow_mpp;
select @@tidb_allow_mpp;
set @@tidb_allow_mpp=default;
select @@tidb_allow_mpp;
select /*+ set_var(tidb_enforce_mpp=0) */ @@tidb_enforce_mpp;
select @@tidb_enforce_mpp;
set @@tidb_enforce_mpp=default;
select @@tidb_enforce_mpp;
select /*+ set_var(tidb_enforce_mpp=1) */ @@tidb_enforce_mpp;
select @@tidb_enforce_mpp;
set @@tidb_enforce_mpp=default;
select @@tidb_enforce_mpp;
select /*+ set_var(tidb_max_bytes_before_tiflash_external_join=0) */ @@tidb_max_bytes_before_tiflash_external_join;
select @@tidb_max_bytes_before_tiflash_external_join;
set @@tidb_max_bytes_before_tiflash_external_join=default;
select @@tidb_max_bytes_before_tiflash_external_join;
select /*+ set_var(tidb_max_bytes_before_tiflash_external_join=1) */ @@tidb_max_bytes_before_tiflash_external_join;
select @@tidb_max_bytes_before_tiflash_external_join;
set @@tidb_max_bytes_before_tiflash_external_join=default;
select @@tidb_max_bytes_before_tiflash_external_join;
select /*+ set_var(tidb_max_bytes_before_tiflash_external_group_by=0) */ @@tidb_max_bytes_before_tiflash_external_group_by;
select @@tidb_max_bytes_before_tiflash_external_group_by;
set @@tidb_max_bytes_before_tiflash_external_group_by=default;
select @@tidb_max_bytes_before_tiflash_external_group_by;
select /*+ set_var(tidb_max_bytes_before_tiflash_external_group_by=1) */ @@tidb_max_bytes_before_tiflash_external_group_by;
select @@tidb_max_bytes_before_tiflash_external_group_by;
set @@tidb_max_bytes_before_tiflash_external_group_by=default;
select @@tidb_max_bytes_before_tiflash_external_group_by;
select /*+ set_var(tidb_max_bytes_before_tiflash_external_sort=0) */ @@tidb_max_bytes_before_tiflash_external_sort;
select @@tidb_max_bytes_before_tiflash_external_sort;
set @@tidb_max_bytes_before_tiflash_external_sort=default;
select @@tidb_max_bytes_before_tiflash_external_sort;
select /*+ set_var(tidb_max_bytes_before_tiflash_external_sort=1) */ @@tidb_max_bytes_before_tiflash_external_sort;
select @@tidb_max_bytes_before_tiflash_external_sort;
set @@tidb_max_bytes_before_tiflash_external_sort=default;
select @@tidb_max_bytes_before_tiflash_external_sort;
select /*+ set_var(tidb_min_paging_size=1) */ @@tidb_min_paging_size;
select @@tidb_min_paging_size;
set @@tidb_min_paging_size=default;
select @@tidb_min_paging_size;
select /*+ set_var(tidb_min_paging_size=2) */ @@tidb_min_paging_size;
select @@tidb_min_paging_size;
set @@tidb_min_paging_size=default;
select @@tidb_min_paging_size;
select /*+ set_var(tidb_max_paging_size=10) */ @@tidb_max_paging_size;
select @@tidb_max_paging_size;
set @@tidb_max_paging_size=default;
select @@tidb_max_paging_size;
select /*+ set_var(tidb_max_paging_size=20) */ @@tidb_max_paging_size;
select @@tidb_max_paging_size;
set @@tidb_max_paging_size=default;
select @@tidb_max_paging_size;
select /*+ set_var(tidb_enable_cascades_planner=0) */ @@tidb_enable_cascades_planner;
select @@tidb_enable_cascades_planner;
set @@tidb_enable_cascades_planner=default;
select @@tidb_enable_cascades_planner;
select /*+ set_var(tidb_enable_cascades_planner=1) */ @@tidb_enable_cascades_planner;
select @@tidb_enable_cascades_planner;
set @@tidb_enable_cascades_planner=default;
select @@tidb_enable_cascades_planner;
select /*+ set_var(tidb_merge_join_concurrency=1) */ @@tidb_merge_join_concurrency;
select @@tidb_merge_join_concurrency;
set @@tidb_merge_join_concurrency=default;
select @@tidb_merge_join_concurrency;
select /*+ set_var(tidb_merge_join_concurrency=2) */ @@tidb_merge_join_concurrency;
select @@tidb_merge_join_concurrency;
set @@tidb_merge_join_concurrency=default;
select @@tidb_merge_join_concurrency;
select /*+ set_var(tidb_index_merge_intersection_concurrency=1) */ @@tidb_index_merge_intersection_concurrency;
select @@tidb_index_merge_intersection_concurrency;
set @@tidb_index_merge_intersection_concurrency=default;
select @@tidb_index_merge_intersection_concurrency;
select /*+ set_var(tidb_index_merge_intersection_concurrency=2) */ @@tidb_index_merge_intersection_concurrency;
select @@tidb_index_merge_intersection_concurrency;
set @@tidb_index_merge_intersection_concurrency=default;
select @@tidb_index_merge_intersection_concurrency;
select /*+ set_var(tidb_opt_projection_push_down=0) */ @@tidb_opt_projection_push_down;
select @@tidb_opt_projection_push_down;
set @@tidb_opt_projection_push_down=default;
select @@tidb_opt_projection_push_down;
select /*+ set_var(tidb_opt_projection_push_down=1) */ @@tidb_opt_projection_push_down;
select @@tidb_opt_projection_push_down;
set @@tidb_opt_projection_push_down=default;
select @@tidb_opt_projection_push_down;
select /*+ set_var(tidb_enable_vectorized_expression=0) */ @@tidb_enable_vectorized_expression;
select @@tidb_enable_vectorized_expression;
set @@tidb_enable_vectorized_expression=default;
select @@tidb_enable_vectorized_expression;
select /*+ set_var(tidb_enable_vectorized_expression=1) */ @@tidb_enable_vectorized_expression;
select @@tidb_enable_vectorized_expression;
set @@tidb_enable_vectorized_expression=default;
select @@tidb_enable_vectorized_expression;
select /*+ set_var(tidb_opt_join_reorder_threshold=0) */ @@tidb_opt_join_reorder_threshold;
select @@tidb_opt_join_reorder_threshold;
set @@tidb_opt_join_reorder_threshold=default;
select @@tidb_opt_join_reorder_threshold;
select /*+ set_var(tidb_opt_join_reorder_threshold=1) */ @@tidb_opt_join_reorder_threshold;
select @@tidb_opt_join_reorder_threshold;
set @@tidb_opt_join_reorder_threshold=default;
select @@tidb_opt_join_reorder_threshold;
select /*+ set_var(tidb_enable_index_merge=0) */ @@tidb_enable_index_merge;
select @@tidb_enable_index_merge;
set @@tidb_enable_index_merge=default;
select @@tidb_enable_index_merge;
select /*+ set_var(tidb_enable_index_merge=1) */ @@tidb_enable_index_merge;
select @@tidb_enable_index_merge;
set @@tidb_enable_index_merge=default;
select @@tidb_enable_index_merge;
select /*+ set_var(tidb_enable_extended_stats=0) */ @@tidb_enable_extended_stats;
select @@tidb_enable_extended_stats;
set @@tidb_enable_extended_stats=default;
select @@tidb_enable_extended_stats;
select /*+ set_var(tidb_enable_extended_stats=1) */ @@tidb_enable_extended_stats;
select @@tidb_enable_extended_stats;
set @@tidb_enable_extended_stats=default;
select @@tidb_enable_extended_stats;
select /*+ set_var(tidb_executor_concurrency=1) */ @@tidb_executor_concurrency;
select @@tidb_executor_concurrency;
set @@tidb_executor_concurrency=default;
select @@tidb_executor_concurrency;
select /*+ set_var(tidb_executor_concurrency=2) */ @@tidb_executor_concurrency;
select @@tidb_executor_concurrency;
set @@tidb_executor_concurrency=default;
select @@tidb_executor_concurrency;
select /*+ set_var(tidb_enable_index_merge_join=0) */ @@tidb_enable_index_merge_join;
select @@tidb_enable_index_merge_join;
set @@tidb_enable_index_merge_join=default;
select @@tidb_enable_index_merge_join;
select /*+ set_var(tidb_enable_index_merge_join=1) */ @@tidb_enable_index_merge_join;
select @@tidb_enable_index_merge_join;
set @@tidb_enable_index_merge_join=default;
select @@tidb_enable_index_merge_join;
select /*+ set_var(tidb_enable_ordered_result_mode=0) */ @@tidb_enable_ordered_result_mode;
select @@tidb_enable_ordered_result_mode;
set @@tidb_enable_ordered_result_mode=default;
select @@tidb_enable_ordered_result_mode;
select /*+ set_var(tidb_enable_ordered_result_mode=1) */ @@tidb_enable_ordered_result_mode;
select @@tidb_enable_ordered_result_mode;
set @@tidb_enable_ordered_result_mode=default;
select @@tidb_enable_ordered_result_mode;
select /*+ set_var(tidb_enable_pseudo_for_outdated_stats=0) */ @@tidb_enable_pseudo_for_outdated_stats;
select @@tidb_enable_pseudo_for_outdated_stats;
set @@tidb_enable_pseudo_for_outdated_stats=default;
select @@tidb_enable_pseudo_for_outdated_stats;
select /*+ set_var(tidb_enable_pseudo_for_outdated_stats=1) */ @@tidb_enable_pseudo_for_outdated_stats;
select @@tidb_enable_pseudo_for_outdated_stats;
set @@tidb_enable_pseudo_for_outdated_stats=default;
select @@tidb_enable_pseudo_for_outdated_stats;
select /*+ set_var(tidb_stats_load_sync_wait=0) */ @@tidb_stats_load_sync_wait;
select @@tidb_stats_load_sync_wait;
set @@tidb_stats_load_sync_wait=default;
select @@tidb_stats_load_sync_wait;
select /*+ set_var(tidb_stats_load_sync_wait=1) */ @@tidb_stats_load_sync_wait;
select @@tidb_stats_load_sync_wait;
set @@tidb_stats_load_sync_wait=default;
select @@tidb_stats_load_sync_wait;
select /*+ set_var(tidb_cost_model_version=1) */ @@tidb_cost_model_version;
select @@tidb_cost_model_version;
set @@tidb_cost_model_version=default;
select @@tidb_cost_model_version;
select /*+ set_var(tidb_cost_model_version=2) */ @@tidb_cost_model_version;
select @@tidb_cost_model_version;
set @@tidb_cost_model_version=default;
select @@tidb_cost_model_version;
select /*+ set_var(tidb_index_join_double_read_penalty_cost_rate=0) */ @@tidb_index_join_double_read_penalty_cost_rate;
select @@tidb_index_join_double_read_penalty_cost_rate;
set @@tidb_index_join_double_read_penalty_cost_rate=default;
select @@tidb_index_join_double_read_penalty_cost_rate;
select /*+ set_var(tidb_index_join_double_read_penalty_cost_rate=1) */ @@tidb_index_join_double_read_penalty_cost_rate;
select @@tidb_index_join_double_read_penalty_cost_rate;
set @@tidb_index_join_double_read_penalty_cost_rate=default;
select @@tidb_index_join_double_read_penalty_cost_rate;
select /*+ set_var(tidb_default_string_match_selectivity=0) */ @@tidb_default_string_match_selectivity;
select @@tidb_default_string_match_selectivity;
set @@tidb_default_string_match_selectivity=default;
select @@tidb_default_string_match_selectivity;
select /*+ set_var(tidb_default_string_match_selectivity=1) */ @@tidb_default_string_match_selectivity;
select @@tidb_default_string_match_selectivity;
set @@tidb_default_string_match_selectivity=default;
select @@tidb_default_string_match_selectivity;
select /*+ set_var(tidb_enable_prepared_plan_cache=0) */ @@tidb_enable_prepared_plan_cache;
select @@tidb_enable_prepared_plan_cache;
set @@tidb_enable_prepared_plan_cache=default;
select @@tidb_enable_prepared_plan_cache;
select /*+ set_var(tidb_enable_prepared_plan_cache=1) */ @@tidb_enable_prepared_plan_cache;
select @@tidb_enable_prepared_plan_cache;
set @@tidb_enable_prepared_plan_cache=default;
select @@tidb_enable_prepared_plan_cache;
select /*+ set_var(tidb_enable_non_prepared_plan_cache=0) */ @@tidb_enable_non_prepared_plan_cache;
select @@tidb_enable_non_prepared_plan_cache;
set @@tidb_enable_non_prepared_plan_cache=default;
select @@tidb_enable_non_prepared_plan_cache;
select /*+ set_var(tidb_enable_non_prepared_plan_cache=1) */ @@tidb_enable_non_prepared_plan_cache;
select @@tidb_enable_non_prepared_plan_cache;
set @@tidb_enable_non_prepared_plan_cache=default;
select @@tidb_enable_non_prepared_plan_cache;
select /*+ set_var(tidb_plan_cache_max_plan_size=0) */ @@tidb_plan_cache_max_plan_size;
select @@tidb_plan_cache_max_plan_size;
set @@tidb_plan_cache_max_plan_size=default;
select @@tidb_plan_cache_max_plan_size;
select /*+ set_var(tidb_plan_cache_max_plan_size=1) */ @@tidb_plan_cache_max_plan_size;
select @@tidb_plan_cache_max_plan_size;
set @@tidb_plan_cache_max_plan_size=default;
select @@tidb_plan_cache_max_plan_size;
select /*+ set_var(tidb_opt_range_max_size=0) */ @@tidb_opt_range_max_size;
select @@tidb_opt_range_max_size;
set @@tidb_opt_range_max_size=default;
select @@tidb_opt_range_max_size;
select /*+ set_var(tidb_opt_range_max_size=1) */ @@tidb_opt_range_max_size;
select @@tidb_opt_range_max_size;
set @@tidb_opt_range_max_size=default;
select @@tidb_opt_range_max_size;
select /*+ set_var(tidb_opt_advanced_join_hint=0) */ @@tidb_opt_advanced_join_hint;
select @@tidb_opt_advanced_join_hint;
set @@tidb_opt_advanced_join_hint=default;
select @@tidb_opt_advanced_join_hint;
select /*+ set_var(tidb_opt_advanced_join_hint=1) */ @@tidb_opt_advanced_join_hint;
select @@tidb_opt_advanced_join_hint;
set @@tidb_opt_advanced_join_hint=default;
select @@tidb_opt_advanced_join_hint;
select /*+ set_var(tidb_opt_prefix_index_single_scan=0) */ @@tidb_opt_prefix_index_single_scan;
select @@tidb_opt_prefix_index_single_scan;
set @@tidb_opt_prefix_index_single_scan=default;
select @@tidb_opt_prefix_index_single_scan;
select /*+ set_var(tidb_opt_prefix_index_single_scan=1) */ @@tidb_opt_prefix_index_single_scan;
select @@tidb_opt_prefix_index_single_scan;
set @@tidb_opt_prefix_index_single_scan=default;
select @@tidb_opt_prefix_index_single_scan;
select /*+ set_var(tidb_store_batch_size=1) */ @@tidb_store_batch_size;
select @@tidb_store_batch_size;
set @@tidb_store_batch_size=default;
select @@tidb_store_batch_size;
select /*+ set_var(tidb_store_batch_size=2) */ @@tidb_store_batch_size;
select @@tidb_store_batch_size;
set @@tidb_store_batch_size=default;
select @@tidb_store_batch_size;
select /*+ set_var(tidb_enable_inl_join_inner_multi_pattern=0) */ @@tidb_enable_inl_join_inner_multi_pattern;
select @@tidb_enable_inl_join_inner_multi_pattern;
set @@tidb_enable_inl_join_inner_multi_pattern=default;
select @@tidb_enable_inl_join_inner_multi_pattern;
select /*+ set_var(tidb_enable_inl_join_inner_multi_pattern=1) */ @@tidb_enable_inl_join_inner_multi_pattern;
select @@tidb_enable_inl_join_inner_multi_pattern;
set @@tidb_enable_inl_join_inner_multi_pattern=default;
select @@tidb_enable_inl_join_inner_multi_pattern;
select /*+ set_var(tidb_opt_enable_late_materialization=0) */ @@tidb_opt_enable_late_materialization;
select @@tidb_opt_enable_late_materialization;
set @@tidb_opt_enable_late_materialization=default;
select @@tidb_opt_enable_late_materialization;
select /*+ set_var(tidb_opt_enable_late_materialization=1) */ @@tidb_opt_enable_late_materialization;
select @@tidb_opt_enable_late_materialization;
set @@tidb_opt_enable_late_materialization=default;
select @@tidb_opt_enable_late_materialization;
select /*+ set_var(tidb_opt_ordering_index_selectivity_threshold=0) */ @@tidb_opt_ordering_index_selectivity_threshold;
select @@tidb_opt_ordering_index_selectivity_threshold;
set @@tidb_opt_ordering_index_selectivity_threshold=default;
select @@tidb_opt_ordering_index_selectivity_threshold;
select /*+ set_var(tidb_opt_ordering_index_selectivity_threshold=1) */ @@tidb_opt_ordering_index_selectivity_threshold;
select @@tidb_opt_ordering_index_selectivity_threshold;
set @@tidb_opt_ordering_index_selectivity_threshold=default;
select @@tidb_opt_ordering_index_selectivity_threshold;
select /*+ set_var(tidb_opt_ordering_index_selectivity_ratio=-1) */ @@tidb_opt_ordering_index_selectivity_ratio;
select @@tidb_opt_ordering_index_selectivity_ratio;
set @@tidb_opt_ordering_index_selectivity_ratio=default;
select @@tidb_opt_ordering_index_selectivity_ratio;
select /*+ set_var(tidb_opt_ordering_index_selectivity_ratio=1) */ @@tidb_opt_ordering_index_selectivity_ratio;
select @@tidb_opt_ordering_index_selectivity_ratio;
set @@tidb_opt_ordering_index_selectivity_ratio=default;
select @@tidb_opt_ordering_index_selectivity_ratio;
select /*+ set_var(tidb_opt_enable_mpp_shared_cte_execution=0) */ @@tidb_opt_enable_mpp_shared_cte_execution;
select @@tidb_opt_enable_mpp_shared_cte_execution;
set @@tidb_opt_enable_mpp_shared_cte_execution=default;
select @@tidb_opt_enable_mpp_shared_cte_execution;
select /*+ set_var(tidb_opt_enable_mpp_shared_cte_execution=1) */ @@tidb_opt_enable_mpp_shared_cte_execution;
select @@tidb_opt_enable_mpp_shared_cte_execution;
set @@tidb_opt_enable_mpp_shared_cte_execution=default;
select @@tidb_opt_enable_mpp_shared_cte_execution;
select @@max_execution_time;
set @@max_execution_time=1000;
select @@max_execution_time;
select /*+ set_var(max_execution_time=100) */ @@max_execution_time;
# The value is the changed value 1000, not the default value 0.
select @@max_execution_time;
select @@tidb_max_chunk_size;
select /*+ set_var(tidb_max_chunk_size=32) */ @@tidb_max_chunk_size;
select @@tidb_max_chunk_size;
select @@tidb_init_chunk_size;
select /*+ set_var(tidb_init_chunk_size=3) */ @@tidb_init_chunk_size;
select @@tidb_init_chunk_size;
select /*+ set_var(tidb_opt_use_invisible_indexes=on) */ @@tidb_opt_use_invisible_indexes;
select @@tidb_opt_use_invisible_indexes;
select /*+ set_var(tidb_opt_use_invisible_indexes=off) */ @@tidb_opt_use_invisible_indexes;
select @@tidb_opt_use_invisible_indexes;

set @@global.max_execution_time=1000;
connect (conn1,localhost,root,,sessionctx__setvar);
connection conn1;
select @@max_execution_time;
# The value is the global value 1000, not the default value 0.
select /*+ set_var(max_execution_time=100) */ @@max_execution_time;
select @@max_execution_time;
set @@max_execution_time=2000;
select @@max_execution_time;
select /*+ set_var(max_execution_time=100) */ @@max_execution_time;
# The value is the changed value 2000, not the default value 0 or the global value 1000.
select @@max_execution_time;
set @@global.max_execution_time=default;
disconnect conn1;
