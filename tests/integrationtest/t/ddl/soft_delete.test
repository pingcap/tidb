drop database if exists test_sd;
create database test_sd softdelete = RETENTION 7 DAY;
show create database test_sd;
drop database test_sd;
create database test_sd softdelete retention 7 DAY softdelete_job_enable = 'ON' softdelete_job_interval = '1h';
show create database test_sd;

alter database test_sd softdelete = 'OFF';
show create database test_sd;
-- error 8200
alter database test_sd softdelete_job_interval = '3h';
alter database test_sd softdelete retention 8 DAY softdelete_job_interval = '3h';
show create database test_sd;

drop database test_sd;
create database test_sd;
use test_sd;

# Create table
create table t1 (id int primary key, name varchar(50)) softdelete = retention 7 day;
show create table t1;
create table t2 (id int primary key, name varchar(50)) softdelete retention 7 hour;
show create table t2;
create table t3 (id int primary key, name varchar(50)) softdelete retention 4 hour softdelete_job_interval = '2h' softdelete_job_enable = 'ON';
show create table t3;
alter database test_sd softdelete retention 7 hour;
create table t4 (id int primary key, name varchar(50));
show create table t4;
alter database test_sd softdelete = 'off';
create table t5 (id int primary key, name varchar(50)) /*T![active_active] ACTIVE_ACTIVE='ON' */ /*T![softdelete] SOFTDELETE=RETENTION 7 DAY */ /*T![softdelete] SOFTDELETE_JOB_ENABLE='ON' */ /*T![softdelete] SOFTDELETE_JOB_INTERVAL='24h' */;
show create table t5;

-- error 8200
create table t6 (id int primary key, name varchar(50)) softdelete_job_interval = '2h' softdelete_job_enable = 'ON' softdelete = 'OFF';
-- error 8200
create table t6 (id int primary key, name varchar(50)) softdelete_job_interval = '2h' softdelete_job_enable = 'ON';

# Alter table
alter table t4 softdelete retention 30 DAY;
show create table t4;
alter table t4 softdelete_job_enable = 'OFF' softdelete_job_interval = '9h';
show create table t4;
alter table t4 softdelete = 'OFF';
show create table t4;

# Invalid value 
-- error 1064
alter database test_sd softdelete = 'INVALID';

-- error 1064
create table t5 (id int) softdelete = 'YES';

-- error 1064
alter table t1 softdelete_job_enable = 'MAYBE';

-- error 1064
create table t6 (id int) softdelete = retention 'invalid_duration' DAY;

drop database test_sd;
