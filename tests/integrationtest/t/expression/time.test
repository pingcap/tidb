# TestDaynameArithmetic
select dayname("1962-03-01")+0;
select dayname("1962-03-02")+0;
select dayname("1962-03-03")+0;
select dayname("1962-03-04")+0;
select dayname("1962-03-05")+0;
select dayname("1962-03-06")+0;
select dayname("1962-03-07")+0;
select dayname("1962-03-08")+0;
select dayname("1962-03-01")+1;
select dayname("1962-03-01")+2;
select dayname("1962-03-01")+3;
select dayname("1962-03-01")+4;
select dayname("1962-03-01")+5;
select dayname("1962-03-01")+6;
select dayname("1962-03-01")+7;
select dayname("1962-03-01")+2333;
select dayname("1962-03-01")+2.333;
select dayname("1962-03-01")>2;
select dayname("1962-03-01")<2;
select dayname("1962-03-01")=3;
select dayname("1962-03-01")!=3;
select dayname("1962-03-01")<4;
select dayname("1962-03-01")>4;
select !dayname("1962-03-01");
select dayname("1962-03-01")&1;
select dayname("1962-03-01")&3;
select dayname("1962-03-01")&7;
select dayname("1962-03-01")|1;
select dayname("1962-03-01")|3;
select dayname("1962-03-01")|7;
select dayname("1962-03-01")^1;
select dayname("1962-03-01")^3;
select dayname("1962-03-01")^7;

# TestTimestampDatumEncode
drop table if exists t;
create table t (a bigint primary key, b timestamp);
insert into t values (1, "2019-04-29 11:56:12");
explain format = 'brief' select * from t where b = (select max(b) from t);
select * from t where b = (select max(b) from t);

# TestDateTimeAddReal
SELECT "1900-01-01 00:00:00" + INTERVAL 1.123456789e3 SECOND;
SELECT 19000101000000 + INTERVAL 1.123456789e3 SECOND;
select date("1900-01-01") + interval 1.123456789e3 second;
SELECT "1900-01-01 00:18:43.456789" - INTERVAL 1.123456789e3 SECOND;
SELECT 19000101001843.456789 - INTERVAL 1.123456789e3 SECOND;
SELECT 19000101000000.0005 + INTERVAL 0.0005 SECOND;
select date("1900-01-01") - interval 1.123456789e3 second;
select 19000101000000 - interval 1.123456789e3 second;

# TestDecimalConvertToTime
# for issue #9770
drop table if exists t;
create table t(a datetime(6), b timestamp);
insert t values (20010101100000.123456, 20110707101112.123456);
select * from t;

# TestDateAddForNonExistingTimestamp
set time_zone = 'CET';
drop table if exists t;
create table t(ts timestamp);
set time_zone = 'UTC';
insert into t values('2022-03-27 00:30:00');
insert into t values('2022-10-30 00:30:00');
insert into t values('2022-10-30 01:30:00');
set time_zone = 'Europe/Amsterdam';
-- error 1292
insert into t values('2022-03-27 02:30:00');
select date_add(ts, interval 1 hour) from t order by ts;
set time_zone = default;

# TestTimestampAddWithFractionalSecond
drop table if exists t;
create table t(a date);
insert into t values ('2021-08-20');
select timestampadd(microsecond, 1, a) from t;
select timestampadd(second, 6/4, a) from t;
select timestampadd(second, 9.9999e2, a) from t;
select timestampadd(second, 1, '2021-08-20 00:00:01.0001');
select timestampadd(minute, 1.5, '2021-08-20 00:00:00');
select timestampadd(minute, 1.5, '2021-08-20 00:00:00.0001');
SELECT timestampadd(year,1.212208e+308,'1995-01-05 06:32:20.859724') as result;
show warnings;
