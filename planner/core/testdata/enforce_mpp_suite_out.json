[
  {
    "Name": "TestEnforceMPP",
    "Cases": null
  },
  {
    "Name": "TestEnforceMPPWarning1",
    "Cases": null
  },
  {
    "Name": "TestEnforceMPPWarning2",
    "Cases": null
  },
  {
    "Name": "TestEnforceMPPWarning3",
    "Cases": null
  },
  {
    "Name": "TestEnforceMPPWarning4",
    "Cases": [
      {
        "SQL": "set @@tidb_allow_mpp=1;set @@tidb_enforce_mpp=1; -- test joins",
        "Plan": null,
        "Warn": null
      },
      {
        "SQL": "EXPLAIN SELECT /*+ MERGE_JOIN(t,s) */ * from t join s using(a); -- 1. hint use INL_JOIN",
        "Plan": [
          "MergeJoin_8 12500.00 root  inner join, left key:test.t.a, right key:test.s.a",
          "├─TableReader_19(Build) 10000.00 root  data:TableFullScan_18",
          "│ └─TableFullScan_18 10000.00 cop[tiflash] table:s keep order:true, stats:pseudo",
          "└─TableReader_15(Probe) 10000.00 root  data:TableFullScan_14",
          "  └─TableFullScan_14 10000.00 cop[tiflash] table:t keep order:true, stats:pseudo"
        ],
        "Warn": [
          "MPP mode may be blocked because you have used hint to specify a join algorithm which is not supported now."
        ]
      },
      {
        "SQL": "EXPLAIN SELECT /*+ INL_JOIN(t,s) */ * from t, s where t.a=s.a; -- 1. hint use INL_JOIN",
        "Plan": [
          "IndexJoin_16 12500.00 root  inner join, inner:TableReader_13, outer key:test.t.a, inner key:test.s.a, equal cond:eq(test.t.a, test.s.a)",
          "├─TableReader_33(Build) 10000.00 root  data:TableFullScan_32",
          "│ └─TableFullScan_32 10000.00 cop[tiflash] table:t keep order:false, stats:pseudo",
          "└─TableReader_13(Probe) 1.00 root  data:TableRangeScan_12",
          "  └─TableRangeScan_12 1.00 cop[tikv] table:s range: decided by [test.t.a], keep order:false, stats:pseudo"
        ],
        "Warn": [
          "MPP mode may be blocked because you have used hint to specify a join algorithm which is not supported now."
        ]
      },
      {
        "SQL": "EXPLAIN SELECT /*+ INL_HASH_JOIN(t,s) */ * from t join s using(a); -- 1. hint use INL_JOIN",
        "Plan": [
          "IndexHashJoin_17 12500.00 root  inner join, inner:TableReader_12, outer key:test.t.a, inner key:test.s.a, equal cond:eq(test.t.a, test.s.a)",
          "├─TableReader_32(Build) 10000.00 root  data:TableFullScan_31",
          "│ └─TableFullScan_31 10000.00 cop[tiflash] table:t keep order:false, stats:pseudo",
          "└─TableReader_12(Probe) 1.00 root  data:TableRangeScan_11",
          "  └─TableRangeScan_11 1.00 cop[tikv] table:s range: decided by [test.t.a], keep order:false, stats:pseudo"
        ],
        "Warn": [
          "MPP mode may be blocked because you have used hint to specify a join algorithm which is not supported now."
        ]
      },
      {
        "SQL": "EXPLAIN SELECT /*+ HASH_JOIN(t,s) */ * from t join s using(a); -- 1. hint use INL_JOIN",
        "Plan": [
          "HashJoin_29 12500.00 root  inner join, equal:[eq(test.t.a, test.s.a)]",
          "├─TableReader_38(Build) 10000.00 root  data:TableFullScan_37",
          "│ └─TableFullScan_37 10000.00 cop[tiflash] table:s keep order:false, stats:pseudo",
          "└─TableReader_34(Probe) 10000.00 root  data:TableFullScan_33",
          "  └─TableFullScan_33 10000.00 cop[tiflash] table:t keep order:false, stats:pseudo"
        ],
        "Warn": [
          "MPP mode may be blocked because you have used hint to specify a join algorithm which is not supported now."
        ]
      }
    ]
  }
]
