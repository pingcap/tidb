[
  {
    "Name": "TestEnforceMPP",
    "Cases": [
      {
        "SQL": "",
        "Plan": null,
        "Warn": null
      },
      {
        "SQL": "explain format='verbose' select count(*) from t where a=1",
        "Plan": [
          "StreamAgg_24 1.00 485.00 root  funcs:count(Column#6)->Column#4",
          "└─IndexReader_25 1.00 32.88 root  index:StreamAgg_9",
          "  └─StreamAgg_9 1.00 35.88 cop[tikv]  funcs:count(1)->Column#6",
          "    └─IndexRangeScan_23 10.00 455.00 cop[tikv] table:t, index:idx(a) range:[1,1], keep order:false, stats:pseudo"
        ],
        "Warn": null
      },
      {
        "SQL": "explain format='verbose' select /*+ read_from_storage(tikv[t]) */ count(*) from t where a=1",
        "Plan": [
          "StreamAgg_17 1.00 485.00 root  funcs:count(Column#6)->Column#4",
          "└─IndexReader_18 1.00 32.88 root  index:StreamAgg_9",
          "  └─StreamAgg_9 1.00 35.88 cop[tikv]  funcs:count(1)->Column#6",
          "    └─IndexRangeScan_16 10.00 455.00 cop[tikv] table:t, index:idx(a) range:[1,1], keep order:false, stats:pseudo"
        ],
        "Warn": null
      },
      {
        "SQL": "explain format='verbose' select /*+ read_from_storage(tiflash[t]) */ count(*) from t where a=1",
        "Plan": [
          "StreamAgg_20 1.00 285050.00 root  funcs:count(Column#6)->Column#4",
          "└─TableReader_21 1.00 19003.88 root  data:StreamAgg_9",
          "  └─StreamAgg_9 1.00 19006.88 batchCop[tiflash]  funcs:count(1)->Column#6",
          "    └─Selection_19 10.00 285020.00 batchCop[tiflash]  eq(test.t.a, 1)",
          "      └─TableFullScan_18 10000.00 255020.00 batchCop[tiflash] table:t keep order:false, stats:pseudo"
        ],
        "Warn": null
      },
      {
        "SQL": "",
        "Plan": null,
        "Warn": null
      },
      {
        "SQL": "",
        "Plan": null,
        "Warn": null
      },
      {
        "SQL": "explain format='verbose' select count(*) from t where a=1",
        "Plan": [
          "StreamAgg_30 1.00 485.00 root  funcs:count(Column#7)->Column#4",
          "└─IndexReader_31 1.00 32.88 root  index:StreamAgg_10",
          "  └─StreamAgg_10 1.00 35.88 cop[tikv]  funcs:count(1)->Column#7",
          "    └─IndexRangeScan_29 10.00 455.00 cop[tikv] table:t, index:idx(a) range:[1,1], keep order:false, stats:pseudo"
        ],
        "Warn": null
      },
      {
        "SQL": "explain format='verbose' select /*+ read_from_storage(tikv[t]) */ count(*) from t where a=1",
        "Plan": [
          "StreamAgg_18 1.00 485.00 root  funcs:count(Column#6)->Column#4",
          "└─IndexReader_19 1.00 32.88 root  index:StreamAgg_10",
          "  └─StreamAgg_10 1.00 35.88 cop[tikv]  funcs:count(1)->Column#6",
          "    └─IndexRangeScan_17 10.00 455.00 cop[tikv] table:t, index:idx(a) range:[1,1], keep order:false, stats:pseudo"
        ],
        "Warn": null
      },
      {
        "SQL": "explain format='verbose' select /*+ read_from_storage(tiflash[t]) */ count(*) from t where a=1",
        "Plan": [
          "HashAgg_21 1.00 11910.73 root  funcs:count(Column#6)->Column#4",
          "└─TableReader_23 1.00 11877.13 root  data:ExchangeSender_22",
          "  └─ExchangeSender_22 1.00 285050.00 batchCop[tiflash]  ExchangeType: PassThrough",
          "    └─HashAgg_9 1.00 285050.00 batchCop[tiflash]  funcs:count(1)->Column#6",
          "      └─Selection_20 10.00 285020.00 batchCop[tiflash]  eq(test.t.a, 1)",
          "        └─TableFullScan_19 10000.00 255020.00 batchCop[tiflash] table:t keep order:false, stats:pseudo"
        ],
        "Warn": null
      },
      {
        "SQL": "",
        "Plan": null,
        "Warn": null
      },
      {
        "SQL": "explain format='verbose' select count(*) from t where a=1",
        "Plan": [
          "HashAgg_24 1.00 33.89 root  funcs:count(Column#6)->Column#4",
          "└─TableReader_26 1.00 0.29 root  data:ExchangeSender_25",
          "  └─ExchangeSender_25 1.00 285050.00 batchCop[tiflash]  ExchangeType: PassThrough",
          "    └─HashAgg_9 1.00 285050.00 batchCop[tiflash]  funcs:count(1)->Column#6",
          "      └─Selection_23 10.00 285020.00 batchCop[tiflash]  eq(test.t.a, 1)",
          "        └─TableFullScan_22 10000.00 255020.00 batchCop[tiflash] table:t keep order:false, stats:pseudo"
        ],
        "Warn": null
      },
      {
        "SQL": "explain format='verbose' select /*+ read_from_storage(tikv[t]) */ count(*) from t where a=1",
        "Plan": [
          "StreamAgg_18 1.00 485.00 root  funcs:count(Column#6)->Column#4",
          "└─IndexReader_19 1.00 32.88 root  index:StreamAgg_10",
          "  └─StreamAgg_10 1.00 35.88 cop[tikv]  funcs:count(1)->Column#6",
          "    └─IndexRangeScan_17 10.00 455.00 cop[tikv] table:t, index:idx(a) range:[1,1], keep order:false, stats:pseudo"
        ],
        "Warn": null
      },
      {
        "SQL": "explain format='verbose' select /*+ read_from_storage(tiflash[t]) */ count(*) from t where a=1",
        "Plan": [
          "HashAgg_21 1.00 33.89 root  funcs:count(Column#6)->Column#4",
          "└─TableReader_23 1.00 0.29 root  data:ExchangeSender_22",
          "  └─ExchangeSender_22 1.00 285050.00 batchCop[tiflash]  ExchangeType: PassThrough",
          "    └─HashAgg_9 1.00 285050.00 batchCop[tiflash]  funcs:count(1)->Column#6",
          "      └─Selection_20 10.00 285020.00 batchCop[tiflash]  eq(test.t.a, 1)",
          "        └─TableFullScan_19 10000.00 255020.00 batchCop[tiflash] table:t keep order:false, stats:pseudo"
        ],
        "Warn": null
      },
      {
        "SQL": "",
        "Plan": null,
        "Warn": null
      },
      {
        "SQL": "explain format='verbose' select count(*) from t where a=1",
        "Plan": [
          "HashAgg_24 1.00 33.60 root  funcs:count(Column#6)->Column#4",
          "└─TableReader_26 1.00 0.00 root  data:ExchangeSender_25",
          "  └─ExchangeSender_25 1.00 285050.00 batchCop[tiflash]  ExchangeType: PassThrough",
          "    └─HashAgg_9 1.00 285050.00 batchCop[tiflash]  funcs:count(1)->Column#6",
          "      └─Selection_23 10.00 285020.00 batchCop[tiflash]  eq(test.t.a, 1)",
          "        └─TableFullScan_22 10000.00 255020.00 batchCop[tiflash] table:t keep order:false, stats:pseudo"
        ],
        "Warn": null
      },
      {
        "SQL": "explain format='verbose' select /*+ read_from_storage(tikv[t]) */ count(*) from t where a=1",
        "Plan": [
          "StreamAgg_18 1.00 485.00 root  funcs:count(Column#6)->Column#4",
          "└─IndexReader_19 1.00 32.88 root  index:StreamAgg_10",
          "  └─StreamAgg_10 1.00 35.88 cop[tikv]  funcs:count(1)->Column#6",
          "    └─IndexRangeScan_17 10.00 455.00 cop[tikv] table:t, index:idx(a) range:[1,1], keep order:false, stats:pseudo"
        ],
        "Warn": [
          "MPP mode may be blocked because you have set a hint to read table `t` from TiKV."
        ]
      },
      {
        "SQL": "explain format='verbose' select /*+ read_from_storage(tiflash[t]) */ count(*) from t where a=1",
        "Plan": [
          "HashAgg_21 1.00 33.60 root  funcs:count(Column#6)->Column#4",
          "└─TableReader_23 1.00 0.00 root  data:ExchangeSender_22",
          "  └─ExchangeSender_22 1.00 285050.00 batchCop[tiflash]  ExchangeType: PassThrough",
          "    └─HashAgg_9 1.00 285050.00 batchCop[tiflash]  funcs:count(1)->Column#6",
          "      └─Selection_20 10.00 285020.00 batchCop[tiflash]  eq(test.t.a, 1)",
          "        └─TableFullScan_19 10000.00 255020.00 batchCop[tiflash] table:t keep order:false, stats:pseudo"
        ],
        "Warn": null
      }
    ]
  }
]
