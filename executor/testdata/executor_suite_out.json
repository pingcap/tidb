[
  {
    "Name": "TestSetOperation",
    "Cases": [
      {
        "SQL": "select * from t3 union select * from t1",
        "Plan": [
          "HashAgg_11 16000.00 root  group by:Column#5, funcs:firstrow(Column#5)->Column#5",
          "└─Union_12 20000.00 root  ",
          "  ├─TableReader_15 10000.00 root  data:TableFullScan_14",
          "  │ └─TableFullScan_14 10000.00 cop[tikv] table:t3 keep order:false, stats:pseudo",
          "  └─TableReader_18 10000.00 root  data:TableFullScan_17",
          "    └─TableFullScan_17 10000.00 cop[tikv] table:t1 keep order:false, stats:pseudo"
        ],
        "Res": [
          "1",
          "2",
          "3",
          "<nil>"
        ]
      },
      {
        "SQL": "select * from t2 union all select * from t1",
        "Plan": [
          "Union_8 20000.00 root  ",
          "├─TableReader_11 10000.00 root  data:TableFullScan_10",
          "│ └─TableFullScan_10 10000.00 cop[tikv] table:t2 keep order:false, stats:pseudo",
          "└─TableReader_14 10000.00 root  data:TableFullScan_13",
          "  └─TableFullScan_13 10000.00 cop[tikv] table:t1 keep order:false, stats:pseudo"
        ],
        "Res": [
          "1",
          "1",
          "1",
          "2",
          "2",
          "3",
          "<nil>",
          "<nil>",
          "<nil>"
        ]
      },
      {
        "SQL": "select * from t1 except select * from t3",
        "Plan": [
          "HashAgg_9 6400.00 root  group by:test.t1.a, funcs:firstrow(test.t1.a)->test.t1.a",
          "└─HashJoin_10 8000.00 root  anti semi join, equal:[nulleq(test.t1.a, test.t3.a)]",
          "  ├─TableReader_14(Build) 10000.00 root  data:TableFullScan_13",
          "  │ └─TableFullScan_13 10000.00 cop[tikv] table:t3 keep order:false, stats:pseudo",
          "  └─TableReader_12(Probe) 10000.00 root  data:TableFullScan_11",
          "    └─TableFullScan_11 10000.00 cop[tikv] table:t1 keep order:false, stats:pseudo"
        ],
        "Res": [
          "1",
          "<nil>"
        ]
      },
      {
        "SQL": "select * from t1 intersect select * from t2",
        "Plan": [
          "HashAgg_9 6400.00 root  group by:test.t1.a, funcs:firstrow(test.t1.a)->test.t1.a",
          "└─HashJoin_10 8000.00 root  semi join, equal:[nulleq(test.t1.a, test.t2.a)]",
          "  ├─TableReader_14(Build) 10000.00 root  data:TableFullScan_13",
          "  │ └─TableFullScan_13 10000.00 cop[tikv] table:t2 keep order:false, stats:pseudo",
          "  └─TableReader_12(Probe) 10000.00 root  data:TableFullScan_11",
          "    └─TableFullScan_11 10000.00 cop[tikv] table:t1 keep order:false, stats:pseudo"
        ],
        "Res": [
          "1",
          "2",
          "<nil>"
        ]
      },
      {
        "SQL": "select * from t1 union all select * from t2 union all select * from t3",
        "Plan": [
          "Union_11 30000.00 root  ",
          "├─TableReader_14 10000.00 root  data:TableFullScan_13",
          "│ └─TableFullScan_13 10000.00 cop[tikv] table:t1 keep order:false, stats:pseudo",
          "├─TableReader_17 10000.00 root  data:TableFullScan_16",
          "│ └─TableFullScan_16 10000.00 cop[tikv] table:t2 keep order:false, stats:pseudo",
          "└─TableReader_20 10000.00 root  data:TableFullScan_19",
          "  └─TableFullScan_19 10000.00 cop[tikv] table:t3 keep order:false, stats:pseudo"
        ],
        "Res": [
          "1",
          "1",
          "1",
          "2",
          "2",
          "2",
          "3",
          "3",
          "<nil>",
          "<nil>",
          "<nil>"
        ]
      },
      {
        "SQL": "select * from t1 union all select * from t2 except select * from t3",
        "Plan": [
          "HashAgg_14 12800.00 root  group by:Column#7, funcs:firstrow(Column#7)->Column#7",
          "└─HashJoin_15 16000.00 root  anti semi join, equal:[nulleq(Column#7, test.t3.a)]",
          "  ├─TableReader_24(Build) 10000.00 root  data:TableFullScan_23",
          "  │ └─TableFullScan_23 10000.00 cop[tikv] table:t3 keep order:false, stats:pseudo",
          "  └─Union_16(Probe) 20000.00 root  ",
          "    ├─TableReader_19 10000.00 root  data:TableFullScan_18",
          "    │ └─TableFullScan_18 10000.00 cop[tikv] table:t1 keep order:false, stats:pseudo",
          "    └─TableReader_22 10000.00 root  data:TableFullScan_21",
          "      └─TableFullScan_21 10000.00 cop[tikv] table:t2 keep order:false, stats:pseudo"
        ],
        "Res": [
          "1",
          "<nil>"
        ]
      },
      {
        "SQL": "select * from t1 intersect select * from t2 intersect select * from t1",
        "Plan": [
          "HashJoin_13 5120.00 root  semi join, equal:[nulleq(test.t1.a, test.t1.a)]",
          "├─TableReader_23(Build) 10000.00 root  data:TableFullScan_22",
          "│ └─TableFullScan_22 10000.00 cop[tikv] table:t1 keep order:false, stats:pseudo",
          "└─HashAgg_16(Probe) 6400.00 root  group by:test.t1.a, funcs:firstrow(test.t1.a)->test.t1.a",
          "  └─HashJoin_17 8000.00 root  semi join, equal:[nulleq(test.t1.a, test.t2.a)]",
          "    ├─TableReader_21(Build) 10000.00 root  data:TableFullScan_20",
          "    │ └─TableFullScan_20 10000.00 cop[tikv] table:t2 keep order:false, stats:pseudo",
          "    └─TableReader_19(Probe) 10000.00 root  data:TableFullScan_18",
          "      └─TableFullScan_18 10000.00 cop[tikv] table:t1 keep order:false, stats:pseudo"
        ],
        "Res": [
          "1",
          "2",
          "<nil>"
        ]
      },
      {
        "SQL": "select * from t1 union all select * from t2 intersect select * from t3",
        "Plan": [
          "Union_12 16400.00 root  ",
          "├─TableReader_15 10000.00 root  data:TableFullScan_14",
          "│ └─TableFullScan_14 10000.00 cop[tikv] table:t1 keep order:false, stats:pseudo",
          "└─HashAgg_19 6400.00 root  group by:test.t2.a, funcs:firstrow(test.t2.a)->test.t2.a",
          "  └─HashJoin_20 8000.00 root  semi join, equal:[nulleq(test.t2.a, test.t3.a)]",
          "    ├─TableReader_24(Build) 10000.00 root  data:TableFullScan_23",
          "    │ └─TableFullScan_23 10000.00 cop[tikv] table:t3 keep order:false, stats:pseudo",
          "    └─TableReader_22(Probe) 10000.00 root  data:TableFullScan_21",
          "      └─TableFullScan_21 10000.00 cop[tikv] table:t2 keep order:false, stats:pseudo"
        ],
        "Res": [
          "1",
          "1",
          "2",
          "2",
          "3",
          "<nil>"
        ]
      },
      {
        "SQL": "select * from t1 except select * from t2 intersect select * from t3",
        "Plan": [
          "HashAgg_13 6400.00 root  group by:test.t1.a, funcs:firstrow(test.t1.a)->test.t1.a",
          "└─HashJoin_14 8000.00 root  anti semi join, equal:[nulleq(test.t1.a, test.t2.a)]",
          "  ├─HashAgg_19(Build) 6400.00 root  group by:test.t2.a, funcs:firstrow(test.t2.a)->test.t2.a",
          "  │ └─HashJoin_20 8000.00 root  semi join, equal:[nulleq(test.t2.a, test.t3.a)]",
          "  │   ├─TableReader_24(Build) 10000.00 root  data:TableFullScan_23",
          "  │   │ └─TableFullScan_23 10000.00 cop[tikv] table:t3 keep order:false, stats:pseudo",
          "  │   └─TableReader_22(Probe) 10000.00 root  data:TableFullScan_21",
          "  │     └─TableFullScan_21 10000.00 cop[tikv] table:t2 keep order:false, stats:pseudo",
          "  └─TableReader_16(Probe) 10000.00 root  data:TableFullScan_15",
          "    └─TableFullScan_15 10000.00 cop[tikv] table:t1 keep order:false, stats:pseudo"
        ],
        "Res": [
          "1",
          "3",
          "<nil>"
        ]
      }
    ]
  }
]
