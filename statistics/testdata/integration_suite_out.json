[
  {
    "Name": "TestExpBackoffEstimation",
    "Cases": [
      [
        "IndexReader_6 5.00 root  index:IndexRangeScan_5",
        "└─IndexRangeScan_5 5.00 cop[tikv] table:exp_backoff, index:idx(a, b, c, d) range:[1,1], keep order:false"
      ],
      [
        "TableReader_7 3.00 root  data:Selection_6",
        "└─Selection_6 3.00 cop[tikv]  eq(test.exp_backoff.b, 1)",
        "  └─TableFullScan_5 5.00 cop[tikv] table:exp_backoff keep order:false"
      ],
      [
        "TableReader_7 2.00 root  data:Selection_6",
        "└─Selection_6 2.00 cop[tikv]  eq(test.exp_backoff.c, 1)",
        "  └─TableFullScan_5 5.00 cop[tikv] table:exp_backoff keep order:false"
      ],
      [
        "TableReader_7 3.00 root  data:Selection_6",
        "└─Selection_6 3.00 cop[tikv]  ge(test.exp_backoff.d, 3), le(test.exp_backoff.d, 5)",
        "  └─TableFullScan_5 5.00 cop[tikv] table:exp_backoff keep order:false"
      ],
      [
        "IndexReader_6 1.36 root  index:IndexRangeScan_5",
        "└─IndexRangeScan_5 1.36 cop[tikv] table:exp_backoff, index:idx(a, b, c, d) range:[1 1 1 3,1 1 1 5], keep order:false"
      ],
      [
        "IndexReader_6 0.00 root  index:IndexRangeScan_5",
        "└─IndexRangeScan_5 0.00 cop[tikv] table:exp_backoff, index:idx(a, b, c, d) range:[1 1 1 3,1 1 1 5], keep order:false"
      ]
    ]
  },
  {
    "Name": "TestNULLOnFullSampling",
    "Cases": [
      [
        "test t  a 0 1 3",
        "test t  a 0 2 2",
        "test t  idx 1 1 3",
        "test t  idx 1 2 2"
      ],
      [
        "test t  a 0 0 1 1 3 3 0",
        "test t  a 0 1 2 1 4 4 0",
        "test t  idx 1 0 1 1 3 3 0",
        "test t  idx 1 1 2 1 4 4 0"
      ]
    ]
  },
  {
    "Name": "TestDefaultSelectivityForStrMatch",
    "Cases": [
      {
        "SQL": "set @@tidb_default_string_match_selectivity = 0.8",
        "Result": null
      },
      {
        "SQL": "explain select * from t where a + 10 > 100",
        "Result": [
          "TableReader_7 8000.00 root  data:Selection_6",
          "└─Selection_6 8000.00 cop[tikv]  gt(plus(test.t.a, 10), 100)",
          "  └─TableFullScan_5 10000.00 cop[tikv] table:t keep order:false, stats:pseudo"
        ]
      },
      {
        "SQL": "explain select * from t where b like '%test%'",
        "Result": [
          "TableReader_7 8000.00 root  data:Selection_6",
          "└─Selection_6 8000.00 cop[tikv]  like(test.t.b, \"%test%\", 92)",
          "  └─TableFullScan_5 10000.00 cop[tikv] table:t keep order:false, stats:pseudo"
        ]
      },
      {
        "SQL": "explain select * from t where b not like '%test%'",
        "Result": [
          "TableReader_7 2000.00 root  data:Selection_6",
          "└─Selection_6 2000.00 cop[tikv]  not(like(test.t.b, \"%test%\", 92))",
          "  └─TableFullScan_5 10000.00 cop[tikv] table:t keep order:false, stats:pseudo"
        ]
      },
      {
        "SQL": "explain select * from t where b regexp '.*test.*'",
        "Result": [
          "Selection_7 8000.00 root  regexp(test.t.b, \".*test.*\")",
          "└─TableReader_6 10000.00 root  data:TableFullScan_5",
          "  └─TableFullScan_5 10000.00 cop[tikv] table:t keep order:false, stats:pseudo"
        ]
      },
      {
        "SQL": "explain select * from t where b not regexp '.*test.*'",
        "Result": [
          "Selection_7 2000.00 root  not(istrue_with_null(regexp(test.t.b, \".*test.*\")))",
          "└─TableReader_6 10000.00 root  data:TableFullScan_5",
          "  └─TableFullScan_5 10000.00 cop[tikv] table:t keep order:false, stats:pseudo"
        ]
      },
      {
        "SQL": "explain select * from t where b like '%test%' and a + 10 > 100",
        "Result": [
          "TableReader_7 8000.00 root  data:Selection_6",
          "└─Selection_6 8000.00 cop[tikv]  gt(plus(test.t.a, 10), 100), like(test.t.b, \"%test%\", 92)",
          "  └─TableFullScan_5 10000.00 cop[tikv] table:t keep order:false, stats:pseudo"
        ]
      },
      {
        "SQL": "explain select * from t where b not like '%test%' and a + 10 > 100",
        "Result": [
          "TableReader_7 2000.00 root  data:Selection_6",
          "└─Selection_6 2000.00 cop[tikv]  gt(plus(test.t.a, 10), 100), not(like(test.t.b, \"%test%\", 92))",
          "  └─TableFullScan_5 10000.00 cop[tikv] table:t keep order:false, stats:pseudo"
        ]
      },
      {
        "SQL": "explain select * from t where b like '%test%' or a + 10 > 100",
        "Result": [
          "TableReader_7 9600.00 root  data:Selection_6",
          "└─Selection_6 9600.00 cop[tikv]  or(like(test.t.b, \"%test%\", 92), gt(plus(test.t.a, 10), 100))",
          "  └─TableFullScan_5 10000.00 cop[tikv] table:t keep order:false, stats:pseudo"
        ]
      },
      {
        "SQL": "set @@tidb_default_string_match_selectivity = 0.9",
        "Result": null
      },
      {
        "SQL": "explain select * from t where a + 10 > 100",
        "Result": [
          "TableReader_7 8000.00 root  data:Selection_6",
          "└─Selection_6 8000.00 cop[tikv]  gt(plus(test.t.a, 10), 100)",
          "  └─TableFullScan_5 10000.00 cop[tikv] table:t keep order:false, stats:pseudo"
        ]
      },
      {
        "SQL": "explain select * from t where b like '%test%'",
        "Result": [
          "TableReader_7 9000.00 root  data:Selection_6",
          "└─Selection_6 9000.00 cop[tikv]  like(test.t.b, \"%test%\", 92)",
          "  └─TableFullScan_5 10000.00 cop[tikv] table:t keep order:false, stats:pseudo"
        ]
      },
      {
        "SQL": "explain select * from t where b not like '%test%'",
        "Result": [
          "TableReader_7 1000.00 root  data:Selection_6",
          "└─Selection_6 1000.00 cop[tikv]  not(like(test.t.b, \"%test%\", 92))",
          "  └─TableFullScan_5 10000.00 cop[tikv] table:t keep order:false, stats:pseudo"
        ]
      },
      {
        "SQL": "explain select * from t where b regexp '.*test.*'",
        "Result": [
          "Selection_7 9000.00 root  regexp(test.t.b, \".*test.*\")",
          "└─TableReader_6 10000.00 root  data:TableFullScan_5",
          "  └─TableFullScan_5 10000.00 cop[tikv] table:t keep order:false, stats:pseudo"
        ]
      },
      {
        "SQL": "explain select * from t where b not regexp '.*test.*'",
        "Result": [
          "Selection_7 1000.00 root  not(istrue_with_null(regexp(test.t.b, \".*test.*\")))",
          "└─TableReader_6 10000.00 root  data:TableFullScan_5",
          "  └─TableFullScan_5 10000.00 cop[tikv] table:t keep order:false, stats:pseudo"
        ]
      },
      {
        "SQL": "explain select * from t where b like '%test%' and a + 10 > 100",
        "Result": [
          "TableReader_7 8000.00 root  data:Selection_6",
          "└─Selection_6 8000.00 cop[tikv]  gt(plus(test.t.a, 10), 100), like(test.t.b, \"%test%\", 92)",
          "  └─TableFullScan_5 10000.00 cop[tikv] table:t keep order:false, stats:pseudo"
        ]
      },
      {
        "SQL": "explain select * from t where b not like '%test%' and a + 10 > 100",
        "Result": [
          "TableReader_7 1000.00 root  data:Selection_6",
          "└─Selection_6 1000.00 cop[tikv]  gt(plus(test.t.a, 10), 100), not(like(test.t.b, \"%test%\", 92))",
          "  └─TableFullScan_5 10000.00 cop[tikv] table:t keep order:false, stats:pseudo"
        ]
      },
      {
        "SQL": "explain select * from t where b like '%test%' or a + 10 > 100",
        "Result": [
          "TableReader_7 9800.00 root  data:Selection_6",
          "└─Selection_6 9800.00 cop[tikv]  or(like(test.t.b, \"%test%\", 92), gt(plus(test.t.a, 10), 100))",
          "  └─TableFullScan_5 10000.00 cop[tikv] table:t keep order:false, stats:pseudo"
        ]
      },
      {
        "SQL": "set @@tidb_default_string_match_selectivity = 0.1",
        "Result": null
      },
      {
        "SQL": "explain select * from t where a + 10 > 100",
        "Result": [
          "TableReader_7 8000.00 root  data:Selection_6",
          "└─Selection_6 8000.00 cop[tikv]  gt(plus(test.t.a, 10), 100)",
          "  └─TableFullScan_5 10000.00 cop[tikv] table:t keep order:false, stats:pseudo"
        ]
      },
      {
        "SQL": "explain select * from t where b like '%test%'",
        "Result": [
          "TableReader_7 1000.00 root  data:Selection_6",
          "└─Selection_6 1000.00 cop[tikv]  like(test.t.b, \"%test%\", 92)",
          "  └─TableFullScan_5 10000.00 cop[tikv] table:t keep order:false, stats:pseudo"
        ]
      },
      {
        "SQL": "explain select * from t where b not like '%test%'",
        "Result": [
          "TableReader_7 9000.00 root  data:Selection_6",
          "└─Selection_6 9000.00 cop[tikv]  not(like(test.t.b, \"%test%\", 92))",
          "  └─TableFullScan_5 10000.00 cop[tikv] table:t keep order:false, stats:pseudo"
        ]
      },
      {
        "SQL": "explain select * from t where b regexp '.*test.*'",
        "Result": [
          "Selection_7 1000.00 root  regexp(test.t.b, \".*test.*\")",
          "└─TableReader_6 10000.00 root  data:TableFullScan_5",
          "  └─TableFullScan_5 10000.00 cop[tikv] table:t keep order:false, stats:pseudo"
        ]
      },
      {
        "SQL": "explain select * from t where b not regexp '.*test.*'",
        "Result": [
          "Selection_7 9000.00 root  not(istrue_with_null(regexp(test.t.b, \".*test.*\")))",
          "└─TableReader_6 10000.00 root  data:TableFullScan_5",
          "  └─TableFullScan_5 10000.00 cop[tikv] table:t keep order:false, stats:pseudo"
        ]
      },
      {
        "SQL": "explain select * from t where b like '%test%' and a + 10 > 100",
        "Result": [
          "TableReader_7 1000.00 root  data:Selection_6",
          "└─Selection_6 1000.00 cop[tikv]  gt(plus(test.t.a, 10), 100), like(test.t.b, \"%test%\", 92)",
          "  └─TableFullScan_5 10000.00 cop[tikv] table:t keep order:false, stats:pseudo"
        ]
      },
      {
        "SQL": "explain select * from t where b not like '%test%' and a + 10 > 100",
        "Result": [
          "TableReader_7 8000.00 root  data:Selection_6",
          "└─Selection_6 8000.00 cop[tikv]  gt(plus(test.t.a, 10), 100), not(like(test.t.b, \"%test%\", 92))",
          "  └─TableFullScan_5 10000.00 cop[tikv] table:t keep order:false, stats:pseudo"
        ]
      },
      {
        "SQL": "explain select * from t where b like '%test%' or a + 10 > 100",
        "Result": [
          "TableReader_7 8200.00 root  data:Selection_6",
          "└─Selection_6 8200.00 cop[tikv]  or(like(test.t.b, \"%test%\", 92), gt(plus(test.t.a, 10), 100))",
          "  └─TableFullScan_5 10000.00 cop[tikv] table:t keep order:false, stats:pseudo"
        ]
      },
      {
        "SQL": "set @@tidb_default_string_match_selectivity = 0",
        "Result": null
      },
      {
        "SQL": "explain select * from t where a + 10 > 100",
        "Result": [
          "TableReader_7 8000.00 root  data:Selection_6",
          "└─Selection_6 8000.00 cop[tikv]  gt(plus(test.t.a, 10), 100)",
          "  └─TableFullScan_5 10000.00 cop[tikv] table:t keep order:false, stats:pseudo"
        ]
      },
      {
        "SQL": "explain select * from t where b like '%test%'",
        "Result": [
          "TableReader_7 1000.00 root  data:Selection_6",
          "└─Selection_6 1000.00 cop[tikv]  like(test.t.b, \"%test%\", 92)",
          "  └─TableFullScan_5 10000.00 cop[tikv] table:t keep order:false, stats:pseudo"
        ]
      },
      {
        "SQL": "explain select * from t where b not like '%test%'",
        "Result": [
          "TableReader_7 9000.00 root  data:Selection_6",
          "└─Selection_6 9000.00 cop[tikv]  not(like(test.t.b, \"%test%\", 92))",
          "  └─TableFullScan_5 10000.00 cop[tikv] table:t keep order:false, stats:pseudo"
        ]
      },
      {
        "SQL": "explain select * from t where b regexp '.*test.*'",
        "Result": [
          "Selection_7 1000.00 root  regexp(test.t.b, \".*test.*\")",
          "└─TableReader_6 10000.00 root  data:TableFullScan_5",
          "  └─TableFullScan_5 10000.00 cop[tikv] table:t keep order:false, stats:pseudo"
        ]
      },
      {
        "SQL": "explain select * from t where b not regexp '.*test.*'",
        "Result": [
          "Selection_7 9000.00 root  not(istrue_with_null(regexp(test.t.b, \".*test.*\")))",
          "└─TableReader_6 10000.00 root  data:TableFullScan_5",
          "  └─TableFullScan_5 10000.00 cop[tikv] table:t keep order:false, stats:pseudo"
        ]
      },
      {
        "SQL": "explain select * from t where b like '%test%' and a + 10 > 100",
        "Result": [
          "TableReader_7 1000.00 root  data:Selection_6",
          "└─Selection_6 1000.00 cop[tikv]  gt(plus(test.t.a, 10), 100), like(test.t.b, \"%test%\", 92)",
          "  └─TableFullScan_5 10000.00 cop[tikv] table:t keep order:false, stats:pseudo"
        ]
      },
      {
        "SQL": "explain select * from t where b not like '%test%' and a + 10 > 100",
        "Result": [
          "TableReader_7 8000.00 root  data:Selection_6",
          "└─Selection_6 8000.00 cop[tikv]  gt(plus(test.t.a, 10), 100), not(like(test.t.b, \"%test%\", 92))",
          "  └─TableFullScan_5 10000.00 cop[tikv] table:t keep order:false, stats:pseudo"
        ]
      },
      {
        "SQL": "explain select * from t where b like '%test%' or a + 10 > 100",
        "Result": [
          "TableReader_7 8200.00 root  data:Selection_6",
          "└─Selection_6 8200.00 cop[tikv]  or(like(test.t.b, \"%test%\", 92), gt(plus(test.t.a, 10), 100))",
          "  └─TableFullScan_5 10000.00 cop[tikv] table:t keep order:false, stats:pseudo"
        ]
      }
    ]
  }
]
