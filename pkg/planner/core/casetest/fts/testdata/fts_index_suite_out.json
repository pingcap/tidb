[
  {
    "Name": "TestTiFlashFTSIndexWhere",
    "Cases": [
      {
        "SQL": "explain format='brief' select * from t1 where fts_match_word('hello', title)",
        "Plan": [
          "TableReader 10000.00 root  MppVersion: 3, data:ExchangeSender",
          "└─ExchangeSender 10000.00 mpp[tiflash]  ExchangeType: PassThrough",
          "  └─TableFullScan 10000.00 mpp[tiflash] table:t1, index:title(title) textSearch:(hello IN test.t1.title), keep order:false, stats:pseudo"
        ],
        "Warn": null
      },
      {
        "SQL": "explain format='brief' select * from t1 where fts_match_word('hello', body)",
        "Plan": [
          "TableReader 10000.00 root  MppVersion: 3, data:ExchangeSender",
          "└─ExchangeSender 10000.00 mpp[tiflash]  ExchangeType: PassThrough",
          "  └─TableFullScan 10000.00 mpp[tiflash] table:t1, index:body(body) textSearch:(hello IN test.t1.body), keep order:false, stats:pseudo"
        ],
        "Warn": null
      },
      {
        "SQL": "explain format='brief' select * from t1 where fts_match_word('hello', title) AND id > 10",
        "Plan": [
          "TableReader 3333.33 root  MppVersion: 3, data:ExchangeSender",
          "└─ExchangeSender 3333.33 mpp[tiflash]  ExchangeType: PassThrough",
          "  └─TableRangeScan 3333.33 mpp[tiflash] table:t1, index:title(title) range:(10,+inf], textSearch:(hello IN test.t1.title), keep order:false, stats:pseudo"
        ],
        "Warn": null
      },
      {
        "SQL": "explain format='brief' select * from t1 where fts_match_word('hello', title) AND id > 10 AND LENGTH(title) > 1",
        "Plan": [
          "TableReader 2666.67 root  MppVersion: 3, data:ExchangeSender",
          "└─ExchangeSender 2666.67 mpp[tiflash]  ExchangeType: PassThrough",
          "  └─Selection 2666.67 mpp[tiflash]  gt(length(test.t1.title), 1)",
          "    └─TableRangeScan 3333.33 mpp[tiflash] table:t1, index:title(title) range:(10,+inf], textSearch:(hello IN test.t1.title), keep order:false, stats:pseudo"
        ],
        "Warn": null
      },
      {
        "SQL": "explain format='brief' select title from t1 where fts_match_word('hello', title) AND id > 10 AND LENGTH(title) > 1",
        "Plan": [
          "TableReader 2666.67 root  MppVersion: 3, data:ExchangeSender",
          "└─ExchangeSender 2666.67 mpp[tiflash]  ExchangeType: PassThrough",
          "  └─Projection 2666.67 mpp[tiflash]  test.t1.title",
          "    └─Selection 2666.67 mpp[tiflash]  gt(length(test.t1.title), 1)",
          "      └─TableRangeScan 3333.33 mpp[tiflash] table:t1, index:title(title) range:(10,+inf], textSearch:(hello IN test.t1.title), keep order:false, stats:pseudo"
        ],
        "Warn": null
      },
      {
        "SQL": "explain format='brief' select count(id) from t1 where fts_match_word('hello', title)",
        "Plan": [
          "HashAgg 1.00 root  funcs:count(Column#5)->Column#4",
          "└─TableReader 1.00 root  MppVersion: 3, data:ExchangeSender",
          "  └─ExchangeSender 1.00 mpp[tiflash]  ExchangeType: PassThrough",
          "    └─HashAgg 1.00 mpp[tiflash]  funcs:count(test.t1.id)->Column#5",
          "      └─TableFullScan 10000.00 mpp[tiflash] table:t1, index:title(title) textSearch:(hello IN test.t1.title), keep order:false, stats:pseudo"
        ],
        "Warn": null
      },
      {
        "SQL": "explain format='brief' select count(*) from t1 where fts_match_word('hello', title)",
        "Plan": [
          "HashAgg 1.00 root  funcs:count(Column#5)->Column#4",
          "└─TableReader 1.00 root  MppVersion: 3, data:ExchangeSender",
          "  └─ExchangeSender 1.00 mpp[tiflash]  ExchangeType: PassThrough",
          "    └─HashAgg 1.00 mpp[tiflash]  funcs:count(test.t1.id)->Column#5",
          "      └─TableFullScan 10000.00 mpp[tiflash] table:t1, index:title(title) textSearch:(hello IN test.t1.title), keep order:false, stats:pseudo"
        ],
        "Warn": null
      },
      {
        "SQL": "explain format='brief' select id from t1 where fts_match_word('hello', title)",
        "Plan": [
          "TableReader 10000.00 root  MppVersion: 3, data:ExchangeSender",
          "└─ExchangeSender 10000.00 mpp[tiflash]  ExchangeType: PassThrough",
          "  └─Projection 10000.00 mpp[tiflash]  test.t1.id",
          "    └─TableFullScan 10000.00 mpp[tiflash] table:t1, index:title(title) textSearch:(hello IN test.t1.title), keep order:false, stats:pseudo"
        ],
        "Warn": null
      },
      {
        "SQL": "explain format='brief' select id from t1 where fts_match_word('hello', title) AND id > 10",
        "Plan": [
          "TableReader 3333.33 root  MppVersion: 3, data:ExchangeSender",
          "└─ExchangeSender 3333.33 mpp[tiflash]  ExchangeType: PassThrough",
          "  └─Projection 3333.33 mpp[tiflash]  test.t1.id",
          "    └─TableRangeScan 3333.33 mpp[tiflash] table:t1, index:title(title) range:(10,+inf], textSearch:(hello IN test.t1.title), keep order:false, stats:pseudo"
        ],
        "Warn": null
      },
      {
        "SQL": "explain format='brief' select id from t1 where fts_match_word('hello', title) AND LENGTH(body) > 10",
        "Plan": [
          "TableReader 8000.00 root  MppVersion: 3, data:ExchangeSender",
          "└─ExchangeSender 8000.00 mpp[tiflash]  ExchangeType: PassThrough",
          "  └─Projection 8000.00 mpp[tiflash]  test.t1.id",
          "    └─Selection 8000.00 mpp[tiflash]  gt(length(test.t1.body), 10)",
          "      └─TableFullScan 10000.00 mpp[tiflash] table:t1, index:title(title) textSearch:(hello IN test.t1.title), keep order:false, stats:pseudo"
        ],
        "Warn": null
      }
    ]
  },
  {
    "Name": "TestTiCISearchExplain",
    "Cases": [
      {
        "SQL": "explain format='brief' select * from t1 where fts_match_word('hello', title)",
        "Plan": [
          "TableReader 10000.00 root  MppVersion: 3, data:ExchangeSender",
          "└─ExchangeSender 10000.00 mpp[tiflash]  ExchangeType: PassThrough",
          "  └─TableFullScan 10000.00 mpp[tiflash] table:t1 keep order:false, stats:pseudo"
        ],
        "Warn": null
      },
      {
        "SQL": "explain format='brief' select * from t1 where fts_match_word('hello', title) AND id > 10",
        "Plan": [
          "TableReader 3333.33 root  MppVersion: 3, data:ExchangeSender",
          "└─ExchangeSender 3333.33 mpp[tiflash]  ExchangeType: PassThrough",
          "  └─TableRangeScan 3333.33 mpp[tiflash] table:t1 range:(10,+inf], keep order:false, stats:pseudo"
        ],
        "Warn": null
      },
      {
        "SQL": "explain format='brief' select * from t1 where fts_match_word('hello', title) AND id > 10 AND LENGTH(title) > 1",
        "Plan": [
          "TableReader 2666.67 root  MppVersion: 3, data:ExchangeSender",
          "└─ExchangeSender 2666.67 mpp[tiflash]  ExchangeType: PassThrough",
          "  └─Selection 2666.67 mpp[tiflash]  gt(length(test.t1.title), 1)",
          "    └─TableRangeScan 3333.33 mpp[tiflash] table:t1 range:(10,+inf], pushed down filter:empty, keep order:false, stats:pseudo"
        ],
        "Warn": null
      },
      {
        "SQL": "explain format='brief' select title from t1 where fts_match_word('hello', title) AND id > 10 AND LENGTH(title) > 1",
        "Plan": [
          "TableReader 2666.67 root  MppVersion: 3, data:ExchangeSender",
          "└─ExchangeSender 2666.67 mpp[tiflash]  ExchangeType: PassThrough",
          "  └─Projection 2666.67 mpp[tiflash]  test.t1.title",
          "    └─Selection 2666.67 mpp[tiflash]  gt(length(test.t1.title), 1)",
          "      └─TableRangeScan 3333.33 mpp[tiflash] table:t1 range:(10,+inf], pushed down filter:empty, keep order:false, stats:pseudo"
        ],
        "Warn": null
      },
      {
        "SQL": "explain format='brief' select count(id) from t1 where fts_match_word('hello', title)",
        "Plan": [
          "HashAgg 1.00 root  funcs:count(Column#7)->Column#5",
          "└─TableReader 1.00 root  MppVersion: 3, data:ExchangeSender",
          "  └─ExchangeSender 1.00 mpp[tiflash]  ExchangeType: PassThrough",
          "    └─HashAgg 1.00 mpp[tiflash]  funcs:count(test.t1.id)->Column#7",
          "      └─TableFullScan 10000.00 mpp[tiflash] table:t1 keep order:false, stats:pseudo"
        ],
        "Warn": null
      },
      {
        "SQL": "explain format='brief' select count(*) from t1 where fts_match_word('hello', title)",
        "Plan": [
          "HashAgg 1.00 root  funcs:count(Column#7)->Column#5",
          "└─TableReader 1.00 root  MppVersion: 3, data:ExchangeSender",
          "  └─ExchangeSender 1.00 mpp[tiflash]  ExchangeType: PassThrough",
          "    └─HashAgg 1.00 mpp[tiflash]  funcs:count(test.t1.id)->Column#7",
          "      └─TableFullScan 10000.00 mpp[tiflash] table:t1 keep order:false, stats:pseudo"
        ],
        "Warn": null
      },
      {
        "SQL": "explain format='brief' select id from t1 where fts_match_word('hello', title)",
        "Plan": [
          "TableReader 10000.00 root  MppVersion: 3, data:ExchangeSender",
          "└─ExchangeSender 10000.00 mpp[tiflash]  ExchangeType: PassThrough",
          "  └─Projection 10000.00 mpp[tiflash]  test.t1.id",
          "    └─TableFullScan 10000.00 mpp[tiflash] table:t1 keep order:false, stats:pseudo"
        ],
        "Warn": null
      },
      {
        "SQL": "explain format='brief' select id from t1 where fts_match_word('hello', title) AND id > 10",
        "Plan": [
          "TableReader 3333.33 root  MppVersion: 3, data:ExchangeSender",
          "└─ExchangeSender 3333.33 mpp[tiflash]  ExchangeType: PassThrough",
          "  └─Projection 3333.33 mpp[tiflash]  test.t1.id",
          "    └─TableRangeScan 3333.33 mpp[tiflash] table:t1 range:(10,+inf], keep order:false, stats:pseudo"
        ],
        "Warn": null
      },
      {
        "SQL": "explain format='brief' select id from t1 where fts_match_word('hello', title) AND LENGTH(body) > 10",
        "Plan": [
          "TableReader 8000.00 root  MppVersion: 3, data:ExchangeSender",
          "└─ExchangeSender 8000.00 mpp[tiflash]  ExchangeType: PassThrough",
          "  └─Projection 8000.00 mpp[tiflash]  test.t1.id",
          "    └─Selection 8000.00 mpp[tiflash]  gt(length(test.t1.body), 10)",
          "      └─TableFullScan 10000.00 mpp[tiflash] table:t1 pushed down filter:empty, keep order:false, stats:pseudo"
        ],
        "Warn": null
      },
      {
        "SQL": "explain format='brief' select * from t1 where fts_match_word('hello', title) limit 1",
        "Plan": [
          "Limit 1.00 root  offset:0, count:1",
          "└─TableReader 1.00 root  data:Limit",
          "  └─Limit 1.00 cop[tikv]  offset:0, count:1",
          "    └─TableFullScan 1.00 cop[tikv] table:t1 keep order:false, stats:pseudo"
        ],
        "Warn": null
      },
      {
        "SQL": "explain format='brief' select /*+ inl_join(t1) */ * from t1, t2 where t2.col=t1.title",
        "Plan": [
          "HashJoin 12487.50 root  inner join, equal:[eq(test.t1.title, test.t2.col)]",
          "├─TableReader(Build) 9990.00 root  data:Selection",
          "│ └─Selection 9990.00 cop[tikv]  not(isnull(test.t2.col))",
          "│   └─TableFullScan 10000.00 cop[tikv] table:t2 keep order:false, stats:pseudo",
          "└─TableReader(Probe) 9990.00 root  MppVersion: 3, data:ExchangeSender",
          "  └─ExchangeSender 9990.00 mpp[tiflash]  ExchangeType: PassThrough",
          "    └─Selection 9990.00 mpp[tiflash]  not(isnull(test.t1.title))",
          "      └─TableFullScan 10000.00 mpp[tiflash] table:t1 pushed down filter:empty, keep order:false, stats:pseudo"
        ],
        "Warn": [
          "[planner:1815]Optimizer Hint /*+ INL_JOIN(t1) */ or /*+ TIDB_INLJ(t1) */ is inapplicable"
        ]
      }
    ]
  }
]
